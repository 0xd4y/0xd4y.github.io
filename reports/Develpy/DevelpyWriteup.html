<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c10{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Arial";font-style:normal}.c2{color:#980000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c14{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c7{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c8{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c0{color:#4a86e8;font-weight:700}.c11{color:inherit;text-decoration:inherit}.c5{height:11pt}.c12{font-size:18pt}.c6{color:#980000}.c4{font-weight:700}.c13{color:#4a86e8}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c8"><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 103.50px; height: 118.87px;"><img alt="" src="images/image8.png" style="width: 103.50px; height: 118.87px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 571.50px; height: 98.50px;"><img alt="" src="images/image28.png" style="width: 571.50px; height: 98.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>This was a nice little challenge created by </span><span class="c4">@stuxnet</span><span>. This </span><span class="c3">box had quite a unique foothold, in the sense that it was made purely for challenging your knowledge about the security of python scripting. A lot of programmers do not think about security when they make their programs, rather they think about just getting their program to perform a desired function. A large part about cybersecurity is about finding bugs in programs and exploiting them to make them do functions that they were not designed to do. Let&rsquo;s jump right in, and I will go into detail about security related to python scripting.</span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span class="c2">Reconnaissance</span></p><p class="c1"><span>As usual, I will start with an </span><span class="c4">nmap </span><span>scan:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 476.50px; height: 367.88px;"><img alt="" src="images/image19.png" style="width: 476.50px; height: 367.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">We see there are two ports open: port 22 (ssh) and port 10000 (snet-sensor-mgmt?). As can be seen from the output, nmap is not sure what service is running on port 10000, but apparently it is getting some HTTP output. Let&rsquo;s visit the webpage and see what we get:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 579.00px; height: 109.00px;"><img alt="" src="images/image26.png" style="width: 579.00px; height: 109.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span class="c2">Getting User</span></p><p class="c1"><span>We get a strange response that looks like an error in some python script. It is especially interesting that the name </span><span class="c4">&lsquo;GET&rsquo;</span><span>&nbsp;is not defined. This looks a lot like a result of a </span><span class="c4">GET</span><span>&nbsp;request.. Let&rsquo;s fire up </span><span class="c4">burpsuite</span><span class="c3">&nbsp;and verify this. Refreshing the page and intercepting our request we see the following:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 587.00px; height: 145.00px;"><img alt="" src="images/image2.png" style="width: 587.00px; height: 145.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">This is a very standard GET request. In the output we see:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 553.00px; height: 102.00px;"><img alt="" src="images/image10.png" style="width: 553.00px; height: 102.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">So it looks like this script is looking at our request method and inputting it into the script. The program most likely expects an integer as the input, so let&rsquo;s modify our request so that we can see how the script is designed to behave:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 583.00px; height: 141.00px;"><img alt="" src="images/image22.png" style="width: 583.00px; height: 141.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">And we see the following response:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 535.00px; height: 117.00px;"><img alt="" src="images/image11.png" style="width: 535.00px; height: 117.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Up to this point with the information that we have gathered about how this script works, it is likely that the script is performing some kind of evaluation on our input. One more thing I checked before I tried to input malicious code is to confirm that the script evaluates what we send. In our previous request, instead of inputting the number </span><span class="c4">4</span><span>, let&rsquo;s input </span><span class="c4">0</span><span class="c3">:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 375.00px; height: 79.00px;"><img alt="" src="images/image25.png" style="width: 375.00px; height: 79.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Now we don&rsquo;t see the strings beginning with &ldquo;</span><span class="c4">Exploiting tryhackme</span><span>&rdquo;. So let&rsquo;s change </span><span class="c4">0</span><span>&nbsp;to </span><span class="c4">0+1</span><span class="c3">&nbsp;to see if the python script is evaluating the math:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 529.00px; height: 100.00px;"><img alt="" src="images/image18.png" style="width: 529.00px; height: 100.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Notice how now there is one string beginning with &ldquo;</span><span class="c4">Exploiting tryhackme</span><span>&rdquo;. This indicates that the script calculated </span><span class="c4">0+1. </span><span>So we have confirmed that the script is using some kind of evaluating function. Let&rsquo;s input some malicious python code so that we can get a reverse shell. We can import the </span><span class="c4">os</span><span>&nbsp;module to execute system commands:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 582.00px; height: 143.00px;"><img alt="" src="images/image16.png" style="width: 582.00px; height: 143.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 371.00px; height: 76.00px;"><img alt="" src="images/image5.png" style="width: 371.00px; height: 76.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Looks like we can execute commands as the user </span><span class="c4">king</span><span class="c3">. So let&rsquo;s get a reverse shell:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 551.00px; height: 16.00px;"><img alt="" src="images/image12.png" style="width: 551.00px; height: 16.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 126.67px;"><img alt="" src="images/image14.png" style="width: 624.00px; height: 126.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 296.00px; height: 47.00px;"><img alt="" src="images/image9.png" style="width: 296.00px; height: 47.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span class="c2">Privilege Escalation to Root</span></p><p class="c1"><span>Cool! We got a shell. Let&rsquo;s see what is in </span><span class="c4">king&rsquo;s </span><span class="c3">directory:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 382.67px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 382.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>We see some interesting files, but the </span><span class="c4">root.sh</span><span>&nbsp;file especially stands out. It is one of the only files in </span><span class="c4">king&rsquo;s</span><span class="c3">&nbsp;directory that is owned by root. Looking at the contents of the bash script, we see that it only has one line:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 316.00px; height: 46.00px;"><img alt="" src="images/image20.png" style="width: 316.00px; height: 46.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>First of all, this looks like a strange thing to have in a bash script. Why not just type that command in the first place? It seems likely that there is some cronjob running this script. Second of all, python is being run without specifying it&rsquo;s full path! If there is indeed a cronjob, then it should only be running commands that are specified within a full path. Unfortunately however, we do not have write access to the </span><span class="c4">python </span><span>binary, and it is likely that root&rsquo;s path is set to its default. So, it looks like we probably can&rsquo;t do some sort of path privilege escalation. In </span><span class="c4">/etc/crontab</span><span class="c3">&nbsp;we see the following:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 555.00px; height: 69.00px;"><img alt="" src="images/image27.png" style="width: 555.00px; height: 69.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Tthere are definitely cron jobs running on this system. At this point I downloaded </span><span class="c7"><a class="c11" href="https://www.google.com/url?q=https://github.com/DominicBreuker/pspy&amp;sa=D&amp;source=editors&amp;ust=1653961217842478&amp;usg=AOvVaw3Xy4wBS6ssPN4XQD4bXbER">pspy</a></span><span class="c3">&nbsp;and saw the following interesting output when I ran it:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 22.67px;"><img alt="" src="images/image23.png" style="width: 624.00px; height: 22.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>It looks like there might be some service running on port 8080 that is only open to localhost. Running </span><span class="c4">netstat</span><span class="c3">, we can confirm this:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 101.33px;"><img alt="" src="images/image15.png" style="width: 624.00px; height: 101.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span>We can forward this port using </span><span class="c4">socat</span><span class="c3">&nbsp;so that it would be remotely accessible:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 616.00px; height: 27.00px;"><img alt="" src="images/image24.png" style="width: 616.00px; height: 27.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 610.00px; height: 247.00px;"><img alt="" src="images/image13.png" style="width: 610.00px; height: 247.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">We see this is a web server that has an upload feature.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 517.00px; height: 257.00px;"><img alt="" src="images/image6.png" style="width: 517.00px; height: 257.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Let&rsquo;s just </span><span class="c4">touch</span><span>&nbsp;a file with the extension </span><span class="c4">.py</span><span class="c3">&nbsp;and see what happens:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 429.00px; height: 215.00px;"><img alt="" src="images/image1.png" style="width: 429.00px; height: 215.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>The file was uploaded to a directory called </span><span class="c4">/media</span><span>. Remember the </span><span class="c4">root.sh</span><span>&nbsp;script which ran any file within the </span><span class="c4">/media</span><span>&nbsp;directory? We can confirm that the server ran this script by looking at </span><span class="c4">pspy</span><span class="c3">:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 20.00px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 20.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>Let&rsquo;s grab a python reverse shell from </span><span class="c7"><a class="c11" href="https://www.google.com/url?q=http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&amp;sa=D&amp;source=editors&amp;ust=1653961217844668&amp;usg=AOvVaw3T0s2eu-ixwvfoqmeVXd6_">pentest monkey</a></span><span class="c3">&nbsp;and put it in our script:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 73.33px;"><img alt="" src="images/image17.png" style="width: 624.00px; height: 73.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3">After uploading, we wait a bit for the cronjob to run again, and eventually we will get a hit back:</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 145.33px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 145.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span class="c0 c12">Bonus</span></p><p class="c1"><span class="c3">That was a lot of fun, but let&rsquo;s see how and why we were able to get a foothold on this box. We&rsquo;ll start by inspecting the script that was related to the error on the webpage: </span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 121.33px;"><img alt="" src="images/image21.png" style="width: 624.00px; height: 121.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span>The old version of python (python2) has a dangerous function called </span><span class="c4">input</span><span>&nbsp;which evaluates the input of a user. This is a security risk within the function, and it is strongly discouraged from being used. Instead, python encourages the use of </span><span class="c4">raw_input </span><span>which treats the user&rsquo;s input as a string regardless of how the user formats it (this is in contrast to the input function which does not modify the type of the input). Modifying the script to use </span><span class="c4">raw_input</span><span>&nbsp;instead of </span><span class="c4">input</span><span>&nbsp;successfully patches the python injection vulnerability. Note that </span><span class="c4">python3</span><span>&nbsp;has since modified the </span><span class="c4">input</span><span>&nbsp;function to behave like </span><span class="c4">raw_input</span><span>&nbsp;so as to patch this vulnerability.</span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span>Thank you to </span><span class="c4">@stuxnet</span><span>&nbsp;for such a fun challenge! I hope you learned a bit from my </span><span class="c6">red team</span><span class="c0">&nbsp;</span><span>analysis of the box and hopefully a bit of the </span><span class="c13">blue team </span><span>as well!</span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1 c5"><span class="c3"></span></p><p class="c1 c5"><span class="c3"></span></p></body></html>